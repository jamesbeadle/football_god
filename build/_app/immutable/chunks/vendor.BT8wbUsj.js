import{c as rn,g as ul,_ as ll,a as fl}from"./index.BHxZ2sDA.js";const Kp=!1;var Ko={},Hn={};Hn.byteLength=pl;Hn.toByteArray=yl;Hn.fromByteArray=wl;var Me=[],_e=[],dl=typeof Uint8Array<"u"?Uint8Array:Array,Us="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var $r=0,hl=Us.length;$r<hl;++$r)Me[$r]=Us[$r],_e[Us.charCodeAt($r)]=$r;_e[45]=62;_e[95]=63;function zo(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function pl(t){var e=zo(t),r=e[0],n=e[1];return(r+n)*3/4-n}function _l(t,e,r){return(e+r)*3/4-r}function yl(t){var e,r=zo(t),n=r[0],i=r[1],a=new dl(_l(t,n,i)),f=0,o=i>0?n-4:n,y;for(y=0;y<o;y+=4)e=_e[t.charCodeAt(y)]<<18|_e[t.charCodeAt(y+1)]<<12|_e[t.charCodeAt(y+2)]<<6|_e[t.charCodeAt(y+3)],a[f++]=e>>16&255,a[f++]=e>>8&255,a[f++]=e&255;return i===2&&(e=_e[t.charCodeAt(y)]<<2|_e[t.charCodeAt(y+1)]>>4,a[f++]=e&255),i===1&&(e=_e[t.charCodeAt(y)]<<10|_e[t.charCodeAt(y+1)]<<4|_e[t.charCodeAt(y+2)]>>2,a[f++]=e>>8&255,a[f++]=e&255),a}function ml(t){return Me[t>>18&63]+Me[t>>12&63]+Me[t>>6&63]+Me[t&63]}function gl(t,e,r){for(var n,i=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),i.push(ml(n));return i.join("")}function wl(t){for(var e,r=t.length,n=r%3,i=[],a=16383,f=0,o=r-n;f<o;f+=a)i.push(gl(t,f,f+a>o?o:f+a));return n===1?(e=t[r-1],i.push(Me[e>>2]+Me[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Me[e>>10]+Me[e>>4&63]+Me[e<<2&63]+"=")),i.join("")}var Kn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Kn.read=function(t,e,r,n,i){var a,f,o=i*8-n-1,y=(1<<o)-1,w=y>>1,N=-7,A=r?i-1:0,R=r?-1:1,S=t[e+A];for(A+=R,a=S&(1<<-N)-1,S>>=-N,N+=o;N>0;a=a*256+t[e+A],A+=R,N-=8);for(f=a&(1<<-N)-1,a>>=-N,N+=n;N>0;f=f*256+t[e+A],A+=R,N-=8);if(a===0)a=1-w;else{if(a===y)return f?NaN:(S?-1:1)*(1/0);f=f+Math.pow(2,n),a=a-w}return(S?-1:1)*f*Math.pow(2,a-n)};Kn.write=function(t,e,r,n,i,a){var f,o,y,w=a*8-i-1,N=(1<<w)-1,A=N>>1,R=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=n?0:a-1,b=n?1:-1,q=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,f=N):(f=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-f))<1&&(f--,y*=2),f+A>=1?e+=R/y:e+=R*Math.pow(2,1-A),e*y>=2&&(f++,y/=2),f+A>=N?(o=0,f=N):f+A>=1?(o=(e*y-1)*Math.pow(2,i),f=f+A):(o=e*Math.pow(2,A-1)*Math.pow(2,i),f=0));i>=8;t[r+S]=o&255,S+=b,o/=256,i-=8);for(f=f<<i|o,w+=i;w>0;t[r+S]=f&255,S+=b,f/=256,w-=8);t[r+S-b]|=q*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Hn,r=Kn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=j,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const _=new Uint8Array(1),l={foo:function(){return 42}};return Object.setPrototypeOf(l,Uint8Array.prototype),Object.setPrototypeOf(_,l),_.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function f(_){if(_>i)throw new RangeError('The value "'+_+'" is invalid for option "size"');const l=new Uint8Array(_);return Object.setPrototypeOf(l,o.prototype),l}function o(_,l,d){if(typeof _=="number"){if(typeof l=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return A(_)}return y(_,l,d)}o.poolSize=8192;function y(_,l,d){if(typeof _=="string")return R(_,l);if(ArrayBuffer.isView(_))return b(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(L(_,ArrayBuffer)||_&&L(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(L(_,SharedArrayBuffer)||_&&L(_.buffer,SharedArrayBuffer)))return q(_,l,d);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const O=_.valueOf&&_.valueOf();if(O!=null&&O!==_)return o.from(O,l,d);const C=M(_);if(C)return C;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return o.from(_[Symbol.toPrimitive]("string"),l,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}o.from=function(_,l,d){return y(_,l,d)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function w(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function N(_,l,d){return w(_),_<=0?f(_):l!==void 0?typeof d=="string"?f(_).fill(l,d):f(_).fill(l):f(_)}o.alloc=function(_,l,d){return N(_,l,d)};function A(_){return w(_),f(_<0?0:z(_)|0)}o.allocUnsafe=function(_){return A(_)},o.allocUnsafeSlow=function(_){return A(_)};function R(_,l){if((typeof l!="string"||l==="")&&(l="utf8"),!o.isEncoding(l))throw new TypeError("Unknown encoding: "+l);const d=V(_,l)|0;let O=f(d);const C=O.write(_,l);return C!==d&&(O=O.slice(0,C)),O}function S(_){const l=_.length<0?0:z(_.length)|0,d=f(l);for(let O=0;O<l;O+=1)d[O]=_[O]&255;return d}function b(_){if(L(_,Uint8Array)){const l=new Uint8Array(_);return q(l.buffer,l.byteOffset,l.byteLength)}return S(_)}function q(_,l,d){if(l<0||_.byteLength<l)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<l+(d||0))throw new RangeError('"length" is outside of buffer bounds');let O;return l===void 0&&d===void 0?O=new Uint8Array(_):d===void 0?O=new Uint8Array(_,l):O=new Uint8Array(_,l,d),Object.setPrototypeOf(O,o.prototype),O}function M(_){if(o.isBuffer(_)){const l=z(_.length)|0,d=f(l);return d.length===0||_.copy(d,0,0,l),d}if(_.length!==void 0)return typeof _.length!="number"||Z(_.length)?f(0):S(_);if(_.type==="Buffer"&&Array.isArray(_.data))return S(_.data)}function z(_){if(_>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return _|0}function j(_){return+_!=_&&(_=0),o.alloc(+_)}o.isBuffer=function(l){return l!=null&&l._isBuffer===!0&&l!==o.prototype},o.compare=function(l,d){if(L(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),L(d,Uint8Array)&&(d=o.from(d,d.offset,d.byteLength)),!o.isBuffer(l)||!o.isBuffer(d))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(l===d)return 0;let O=l.length,C=d.length;for(let K=0,H=Math.min(O,C);K<H;++K)if(l[K]!==d[K]){O=l[K],C=d[K];break}return O<C?-1:C<O?1:0},o.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(l,d){if(!Array.isArray(l))throw new TypeError('"list" argument must be an Array of Buffers');if(l.length===0)return o.alloc(0);let O;if(d===void 0)for(d=0,O=0;O<l.length;++O)d+=l[O].length;const C=o.allocUnsafe(d);let K=0;for(O=0;O<l.length;++O){let H=l[O];if(L(H,Uint8Array))K+H.length>C.length?(o.isBuffer(H)||(H=o.from(H)),H.copy(C,K)):Uint8Array.prototype.set.call(C,H,K);else if(o.isBuffer(H))H.copy(C,K);else throw new TypeError('"list" argument must be an Array of Buffers');K+=H.length}return C};function V(_,l){if(o.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||L(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const d=_.length,O=arguments.length>2&&arguments[2]===!0;if(!O&&d===0)return 0;let C=!1;for(;;)switch(l){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return c(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d*2;case"hex":return d>>>1;case"base64":return v(_).length;default:if(C)return O?-1:c(_).length;l=(""+l).toLowerCase(),C=!0}}o.byteLength=V;function rt(_,l,d){let O=!1;if((l===void 0||l<0)&&(l=0),l>this.length||((d===void 0||d>this.length)&&(d=this.length),d<=0)||(d>>>=0,l>>>=0,d<=l))return"";for(_||(_="utf8");;)switch(_){case"hex":return et(this,l,d);case"utf8":case"utf-8":return F(this,l,d);case"ascii":return G(this,l,d);case"latin1":case"binary":return Q(this,l,d);case"base64":return I(this,l,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,l,d);default:if(O)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),O=!0}}o.prototype._isBuffer=!0;function k(_,l,d){const O=_[l];_[l]=_[d],_[d]=O}o.prototype.swap16=function(){const l=this.length;if(l%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let d=0;d<l;d+=2)k(this,d,d+1);return this},o.prototype.swap32=function(){const l=this.length;if(l%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let d=0;d<l;d+=4)k(this,d,d+3),k(this,d+1,d+2);return this},o.prototype.swap64=function(){const l=this.length;if(l%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let d=0;d<l;d+=8)k(this,d,d+7),k(this,d+1,d+6),k(this,d+2,d+5),k(this,d+3,d+4);return this},o.prototype.toString=function(){const l=this.length;return l===0?"":arguments.length===0?F(this,0,l):rt.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(l){if(!o.isBuffer(l))throw new TypeError("Argument must be a Buffer");return this===l?!0:o.compare(this,l)===0},o.prototype.inspect=function(){let l="";const d=t.INSPECT_MAX_BYTES;return l=this.toString("hex",0,d).replace(/(.{2})/g,"$1 ").trim(),this.length>d&&(l+=" ... "),"<Buffer "+l+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(l,d,O,C,K){if(L(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),!o.isBuffer(l))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof l);if(d===void 0&&(d=0),O===void 0&&(O=l?l.length:0),C===void 0&&(C=0),K===void 0&&(K=this.length),d<0||O>l.length||C<0||K>this.length)throw new RangeError("out of range index");if(C>=K&&d>=O)return 0;if(C>=K)return-1;if(d>=O)return 1;if(d>>>=0,O>>>=0,C>>>=0,K>>>=0,this===l)return 0;let H=K-C,wt=O-d;const vt=Math.min(H,wt),xt=this.slice(C,K),Et=l.slice(d,O);for(let At=0;At<vt;++At)if(xt[At]!==Et[At]){H=xt[At],wt=Et[At];break}return H<wt?-1:wt<H?1:0};function W(_,l,d,O,C){if(_.length===0)return-1;if(typeof d=="string"?(O=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,Z(d)&&(d=C?0:_.length-1),d<0&&(d=_.length+d),d>=_.length){if(C)return-1;d=_.length-1}else if(d<0)if(C)d=0;else return-1;if(typeof l=="string"&&(l=o.from(l,O)),o.isBuffer(l))return l.length===0?-1:D(_,l,d,O,C);if(typeof l=="number")return l=l&255,typeof Uint8Array.prototype.indexOf=="function"?C?Uint8Array.prototype.indexOf.call(_,l,d):Uint8Array.prototype.lastIndexOf.call(_,l,d):D(_,[l],d,O,C);throw new TypeError("val must be string, number or Buffer")}function D(_,l,d,O,C){let K=1,H=_.length,wt=l.length;if(O!==void 0&&(O=String(O).toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(_.length<2||l.length<2)return-1;K=2,H/=2,wt/=2,d/=2}function vt(Et,At){return K===1?Et[At]:Et.readUInt16BE(At*K)}let xt;if(C){let Et=-1;for(xt=d;xt<H;xt++)if(vt(_,xt)===vt(l,Et===-1?0:xt-Et)){if(Et===-1&&(Et=xt),xt-Et+1===wt)return Et*K}else Et!==-1&&(xt-=xt-Et),Et=-1}else for(d+wt>H&&(d=H-wt),xt=d;xt>=0;xt--){let Et=!0;for(let At=0;At<wt;At++)if(vt(_,xt+At)!==vt(l,At)){Et=!1;break}if(Et)return xt}return-1}o.prototype.includes=function(l,d,O){return this.indexOf(l,d,O)!==-1},o.prototype.indexOf=function(l,d,O){return W(this,l,d,O,!0)},o.prototype.lastIndexOf=function(l,d,O){return W(this,l,d,O,!1)};function J(_,l,d,O){d=Number(d)||0;const C=_.length-d;O?(O=Number(O),O>C&&(O=C)):O=C;const K=l.length;O>K/2&&(O=K/2);let H;for(H=0;H<O;++H){const wt=parseInt(l.substr(H*2,2),16);if(Z(wt))return H;_[d+H]=wt}return H}function nt(_,l,d,O){return B(c(l,_.length-d),_,d,O)}function tt(_,l,d,O){return B(u(l),_,d,O)}function dt(_,l,d,O){return B(v(l),_,d,O)}function ut(_,l,d,O){return B(m(l,_.length-d),_,d,O)}o.prototype.write=function(l,d,O,C){if(d===void 0)C="utf8",O=this.length,d=0;else if(O===void 0&&typeof d=="string")C=d,O=this.length,d=0;else if(isFinite(d))d=d>>>0,isFinite(O)?(O=O>>>0,C===void 0&&(C="utf8")):(C=O,O=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const K=this.length-d;if((O===void 0||O>K)&&(O=K),l.length>0&&(O<0||d<0)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");C||(C="utf8");let H=!1;for(;;)switch(C){case"hex":return J(this,l,d,O);case"utf8":case"utf-8":return nt(this,l,d,O);case"ascii":case"latin1":case"binary":return tt(this,l,d,O);case"base64":return dt(this,l,d,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,l,d,O);default:if(H)throw new TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),H=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(_,l,d){return l===0&&d===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(l,d))}function F(_,l,d){d=Math.min(_.length,d);const O=[];let C=l;for(;C<d;){const K=_[C];let H=null,wt=K>239?4:K>223?3:K>191?2:1;if(C+wt<=d){let vt,xt,Et,At;switch(wt){case 1:K<128&&(H=K);break;case 2:vt=_[C+1],(vt&192)===128&&(At=(K&31)<<6|vt&63,At>127&&(H=At));break;case 3:vt=_[C+1],xt=_[C+2],(vt&192)===128&&(xt&192)===128&&(At=(K&15)<<12|(vt&63)<<6|xt&63,At>2047&&(At<55296||At>57343)&&(H=At));break;case 4:vt=_[C+1],xt=_[C+2],Et=_[C+3],(vt&192)===128&&(xt&192)===128&&(Et&192)===128&&(At=(K&15)<<18|(vt&63)<<12|(xt&63)<<6|Et&63,At>65535&&At<1114112&&(H=At))}}H===null?(H=65533,wt=1):H>65535&&(H-=65536,O.push(H>>>10&1023|55296),H=56320|H&1023),O.push(H),C+=wt}return $(O)}const Y=4096;function $(_){const l=_.length;if(l<=Y)return String.fromCharCode.apply(String,_);let d="",O=0;for(;O<l;)d+=String.fromCharCode.apply(String,_.slice(O,O+=Y));return d}function G(_,l,d){let O="";d=Math.min(_.length,d);for(let C=l;C<d;++C)O+=String.fromCharCode(_[C]&127);return O}function Q(_,l,d){let O="";d=Math.min(_.length,d);for(let C=l;C<d;++C)O+=String.fromCharCode(_[C]);return O}function et(_,l,d){const O=_.length;(!l||l<0)&&(l=0),(!d||d<0||d>O)&&(d=O);let C="";for(let K=l;K<d;++K)C+=ot[_[K]];return C}function _t(_,l,d){const O=_.slice(l,d);let C="";for(let K=0;K<O.length-1;K+=2)C+=String.fromCharCode(O[K]+O[K+1]*256);return C}o.prototype.slice=function(l,d){const O=this.length;l=~~l,d=d===void 0?O:~~d,l<0?(l+=O,l<0&&(l=0)):l>O&&(l=O),d<0?(d+=O,d<0&&(d=0)):d>O&&(d=O),d<l&&(d=l);const C=this.subarray(l,d);return Object.setPrototypeOf(C,o.prototype),C};function at(_,l,d){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+l>d)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(l,d,O){l=l>>>0,d=d>>>0,O||at(l,d,this.length);let C=this[l],K=1,H=0;for(;++H<d&&(K*=256);)C+=this[l+H]*K;return C},o.prototype.readUintBE=o.prototype.readUIntBE=function(l,d,O){l=l>>>0,d=d>>>0,O||at(l,d,this.length);let C=this[l+--d],K=1;for(;d>0&&(K*=256);)C+=this[l+--d]*K;return C},o.prototype.readUint8=o.prototype.readUInt8=function(l,d){return l=l>>>0,d||at(l,1,this.length),this[l]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(l,d){return l=l>>>0,d||at(l,2,this.length),this[l]|this[l+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(l,d){return l=l>>>0,d||at(l,2,this.length),this[l]<<8|this[l+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(l,d){return l=l>>>0,d||at(l,4,this.length),(this[l]|this[l+1]<<8|this[l+2]<<16)+this[l+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(l,d){return l=l>>>0,d||at(l,4,this.length),this[l]*16777216+(this[l+1]<<16|this[l+2]<<8|this[l+3])},o.prototype.readBigUInt64LE=pt(function(l){l=l>>>0,x(l,"offset");const d=this[l],O=this[l+7];(d===void 0||O===void 0)&&T(l,this.length-8);const C=d+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24,K=this[++l]+this[++l]*2**8+this[++l]*2**16+O*2**24;return BigInt(C)+(BigInt(K)<<BigInt(32))}),o.prototype.readBigUInt64BE=pt(function(l){l=l>>>0,x(l,"offset");const d=this[l],O=this[l+7];(d===void 0||O===void 0)&&T(l,this.length-8);const C=d*2**24+this[++l]*2**16+this[++l]*2**8+this[++l],K=this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+O;return(BigInt(C)<<BigInt(32))+BigInt(K)}),o.prototype.readIntLE=function(l,d,O){l=l>>>0,d=d>>>0,O||at(l,d,this.length);let C=this[l],K=1,H=0;for(;++H<d&&(K*=256);)C+=this[l+H]*K;return K*=128,C>=K&&(C-=Math.pow(2,8*d)),C},o.prototype.readIntBE=function(l,d,O){l=l>>>0,d=d>>>0,O||at(l,d,this.length);let C=d,K=1,H=this[l+--C];for(;C>0&&(K*=256);)H+=this[l+--C]*K;return K*=128,H>=K&&(H-=Math.pow(2,8*d)),H},o.prototype.readInt8=function(l,d){return l=l>>>0,d||at(l,1,this.length),this[l]&128?(255-this[l]+1)*-1:this[l]},o.prototype.readInt16LE=function(l,d){l=l>>>0,d||at(l,2,this.length);const O=this[l]|this[l+1]<<8;return O&32768?O|4294901760:O},o.prototype.readInt16BE=function(l,d){l=l>>>0,d||at(l,2,this.length);const O=this[l+1]|this[l]<<8;return O&32768?O|4294901760:O},o.prototype.readInt32LE=function(l,d){return l=l>>>0,d||at(l,4,this.length),this[l]|this[l+1]<<8|this[l+2]<<16|this[l+3]<<24},o.prototype.readInt32BE=function(l,d){return l=l>>>0,d||at(l,4,this.length),this[l]<<24|this[l+1]<<16|this[l+2]<<8|this[l+3]},o.prototype.readBigInt64LE=pt(function(l){l=l>>>0,x(l,"offset");const d=this[l],O=this[l+7];(d===void 0||O===void 0)&&T(l,this.length-8);const C=this[l+4]+this[l+5]*2**8+this[l+6]*2**16+(O<<24);return(BigInt(C)<<BigInt(32))+BigInt(d+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24)}),o.prototype.readBigInt64BE=pt(function(l){l=l>>>0,x(l,"offset");const d=this[l],O=this[l+7];(d===void 0||O===void 0)&&T(l,this.length-8);const C=(d<<24)+this[++l]*2**16+this[++l]*2**8+this[++l];return(BigInt(C)<<BigInt(32))+BigInt(this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+O)}),o.prototype.readFloatLE=function(l,d){return l=l>>>0,d||at(l,4,this.length),r.read(this,l,!0,23,4)},o.prototype.readFloatBE=function(l,d){return l=l>>>0,d||at(l,4,this.length),r.read(this,l,!1,23,4)},o.prototype.readDoubleLE=function(l,d){return l=l>>>0,d||at(l,8,this.length),r.read(this,l,!0,52,8)},o.prototype.readDoubleBE=function(l,d){return l=l>>>0,d||at(l,8,this.length),r.read(this,l,!1,52,8)};function X(_,l,d,O,C,K){if(!o.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>C||l<K)throw new RangeError('"value" argument is out of bounds');if(d+O>_.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(l,d,O,C){if(l=+l,d=d>>>0,O=O>>>0,!C){const wt=Math.pow(2,8*O)-1;X(this,l,d,O,wt,0)}let K=1,H=0;for(this[d]=l&255;++H<O&&(K*=256);)this[d+H]=l/K&255;return d+O},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(l,d,O,C){if(l=+l,d=d>>>0,O=O>>>0,!C){const wt=Math.pow(2,8*O)-1;X(this,l,d,O,wt,0)}let K=O-1,H=1;for(this[d+K]=l&255;--K>=0&&(H*=256);)this[d+K]=l/H&255;return d+O},o.prototype.writeUint8=o.prototype.writeUInt8=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,1,255,0),this[d]=l&255,d+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,2,65535,0),this[d]=l&255,this[d+1]=l>>>8,d+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,2,65535,0),this[d]=l>>>8,this[d+1]=l&255,d+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,4,4294967295,0),this[d+3]=l>>>24,this[d+2]=l>>>16,this[d+1]=l>>>8,this[d]=l&255,d+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,4,4294967295,0),this[d]=l>>>24,this[d+1]=l>>>16,this[d+2]=l>>>8,this[d+3]=l&255,d+4};function lt(_,l,d,O,C){h(l,O,C,_,d,7);let K=Number(l&BigInt(4294967295));_[d++]=K,K=K>>8,_[d++]=K,K=K>>8,_[d++]=K,K=K>>8,_[d++]=K;let H=Number(l>>BigInt(32)&BigInt(4294967295));return _[d++]=H,H=H>>8,_[d++]=H,H=H>>8,_[d++]=H,H=H>>8,_[d++]=H,d}function E(_,l,d,O,C){h(l,O,C,_,d,7);let K=Number(l&BigInt(4294967295));_[d+7]=K,K=K>>8,_[d+6]=K,K=K>>8,_[d+5]=K,K=K>>8,_[d+4]=K;let H=Number(l>>BigInt(32)&BigInt(4294967295));return _[d+3]=H,H=H>>8,_[d+2]=H,H=H>>8,_[d+1]=H,H=H>>8,_[d]=H,d+8}o.prototype.writeBigUInt64LE=pt(function(l,d=0){return lt(this,l,d,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=pt(function(l,d=0){return E(this,l,d,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(l,d,O,C){if(l=+l,d=d>>>0,!C){const vt=Math.pow(2,8*O-1);X(this,l,d,O,vt-1,-vt)}let K=0,H=1,wt=0;for(this[d]=l&255;++K<O&&(H*=256);)l<0&&wt===0&&this[d+K-1]!==0&&(wt=1),this[d+K]=(l/H>>0)-wt&255;return d+O},o.prototype.writeIntBE=function(l,d,O,C){if(l=+l,d=d>>>0,!C){const vt=Math.pow(2,8*O-1);X(this,l,d,O,vt-1,-vt)}let K=O-1,H=1,wt=0;for(this[d+K]=l&255;--K>=0&&(H*=256);)l<0&&wt===0&&this[d+K+1]!==0&&(wt=1),this[d+K]=(l/H>>0)-wt&255;return d+O},o.prototype.writeInt8=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,1,127,-128),l<0&&(l=255+l+1),this[d]=l&255,d+1},o.prototype.writeInt16LE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,2,32767,-32768),this[d]=l&255,this[d+1]=l>>>8,d+2},o.prototype.writeInt16BE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,2,32767,-32768),this[d]=l>>>8,this[d+1]=l&255,d+2},o.prototype.writeInt32LE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,4,2147483647,-2147483648),this[d]=l&255,this[d+1]=l>>>8,this[d+2]=l>>>16,this[d+3]=l>>>24,d+4},o.prototype.writeInt32BE=function(l,d,O){return l=+l,d=d>>>0,O||X(this,l,d,4,2147483647,-2147483648),l<0&&(l=4294967295+l+1),this[d]=l>>>24,this[d+1]=l>>>16,this[d+2]=l>>>8,this[d+3]=l&255,d+4},o.prototype.writeBigInt64LE=pt(function(l,d=0){return lt(this,l,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=pt(function(l,d=0){return E(this,l,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ct(_,l,d,O,C,K){if(d+O>_.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function ft(_,l,d,O,C){return l=+l,d=d>>>0,C||ct(_,l,d,4),r.write(_,l,d,O,23,4),d+4}o.prototype.writeFloatLE=function(l,d,O){return ft(this,l,d,!0,O)},o.prototype.writeFloatBE=function(l,d,O){return ft(this,l,d,!1,O)};function yt(_,l,d,O,C){return l=+l,d=d>>>0,C||ct(_,l,d,8),r.write(_,l,d,O,52,8),d+8}o.prototype.writeDoubleLE=function(l,d,O){return yt(this,l,d,!0,O)},o.prototype.writeDoubleBE=function(l,d,O){return yt(this,l,d,!1,O)},o.prototype.copy=function(l,d,O,C){if(!o.isBuffer(l))throw new TypeError("argument should be a Buffer");if(O||(O=0),!C&&C!==0&&(C=this.length),d>=l.length&&(d=l.length),d||(d=0),C>0&&C<O&&(C=O),C===O||l.length===0||this.length===0)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(O<0||O>=this.length)throw new RangeError("Index out of range");if(C<0)throw new RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),l.length-d<C-O&&(C=l.length-d+O);const K=C-O;return this===l&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(d,O,C):Uint8Array.prototype.set.call(l,this.subarray(O,C),d),K},o.prototype.fill=function(l,d,O,C){if(typeof l=="string"){if(typeof d=="string"?(C=d,d=0,O=this.length):typeof O=="string"&&(C=O,O=this.length),C!==void 0&&typeof C!="string")throw new TypeError("encoding must be a string");if(typeof C=="string"&&!o.isEncoding(C))throw new TypeError("Unknown encoding: "+C);if(l.length===1){const H=l.charCodeAt(0);(C==="utf8"&&H<128||C==="latin1")&&(l=H)}}else typeof l=="number"?l=l&255:typeof l=="boolean"&&(l=Number(l));if(d<0||this.length<d||this.length<O)throw new RangeError("Out of range index");if(O<=d)return this;d=d>>>0,O=O===void 0?this.length:O>>>0,l||(l=0);let K;if(typeof l=="number")for(K=d;K<O;++K)this[K]=l;else{const H=o.isBuffer(l)?l:o.from(l,C),wt=H.length;if(wt===0)throw new TypeError('The value "'+l+'" is invalid for argument "value"');for(K=0;K<O-d;++K)this[K+d]=H[K%wt]}return this};const it={};function st(_,l,d){it[_]=class extends d{constructor(){super(),Object.defineProperty(this,"message",{value:l.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(C){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:C,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}st("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),st("ERR_INVALID_ARG_TYPE",function(_,l){return`The "${_}" argument must be of type number. Received type ${typeof l}`},TypeError),st("ERR_OUT_OF_RANGE",function(_,l,d){let O=`The value of "${_}" is out of range.`,C=d;return Number.isInteger(d)&&Math.abs(d)>2**32?C=g(String(d)):typeof d=="bigint"&&(C=String(d),(d>BigInt(2)**BigInt(32)||d<-(BigInt(2)**BigInt(32)))&&(C=g(C)),C+="n"),O+=` It must be ${l}. Received ${C}`,O},RangeError);function g(_){let l="",d=_.length;const O=_[0]==="-"?1:0;for(;d>=O+4;d-=3)l=`_${_.slice(d-3,d)}${l}`;return`${_.slice(0,d)}${l}`}function s(_,l,d){x(l,"offset"),(_[l]===void 0||_[l+d]===void 0)&&T(l,_.length-(d+1))}function h(_,l,d,O,C,K){if(_>d||_<l){const H=typeof l=="bigint"?"n":"";let wt;throw l===0||l===BigInt(0)?wt=`>= 0${H} and < 2${H} ** ${(K+1)*8}${H}`:wt=`>= -(2${H} ** ${(K+1)*8-1}${H}) and < 2 ** ${(K+1)*8-1}${H}`,new it.ERR_OUT_OF_RANGE("value",wt,_)}s(O,C,K)}function x(_,l){if(typeof _!="number")throw new it.ERR_INVALID_ARG_TYPE(l,"number",_)}function T(_,l,d){throw Math.floor(_)!==_?(x(_,d),new it.ERR_OUT_OF_RANGE("offset","an integer",_)):l<0?new it.ERR_BUFFER_OUT_OF_BOUNDS:new it.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${l}`,_)}const U=/[^+/0-9A-Za-z-_]/g;function p(_){if(_=_.split("=")[0],_=_.trim().replace(U,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function c(_,l){l=l||1/0;let d;const O=_.length;let C=null;const K=[];for(let H=0;H<O;++H){if(d=_.charCodeAt(H),d>55295&&d<57344){if(!C){if(d>56319){(l-=3)>-1&&K.push(239,191,189);continue}else if(H+1===O){(l-=3)>-1&&K.push(239,191,189);continue}C=d;continue}if(d<56320){(l-=3)>-1&&K.push(239,191,189),C=d;continue}d=(C-55296<<10|d-56320)+65536}else C&&(l-=3)>-1&&K.push(239,191,189);if(C=null,d<128){if((l-=1)<0)break;K.push(d)}else if(d<2048){if((l-=2)<0)break;K.push(d>>6|192,d&63|128)}else if(d<65536){if((l-=3)<0)break;K.push(d>>12|224,d>>6&63|128,d&63|128)}else if(d<1114112){if((l-=4)<0)break;K.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw new Error("Invalid code point")}return K}function u(_){const l=[];for(let d=0;d<_.length;++d)l.push(_.charCodeAt(d)&255);return l}function m(_,l){let d,O,C;const K=[];for(let H=0;H<_.length&&!((l-=2)<0);++H)d=_.charCodeAt(H),O=d>>8,C=d%256,K.push(C),K.push(O);return K}function v(_){return e.toByteArray(p(_))}function B(_,l,d,O){let C;for(C=0;C<O&&!(C+d>=l.length||C>=_.length);++C)l[C+d]=_[C];return C}function L(_,l){return _ instanceof l||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===l.name}function Z(_){return _!==_}const ot=function(){const _="0123456789abcdef",l=new Array(256);for(let d=0;d<16;++d){const O=d*16;for(let C=0;C<16;++C)l[O+C]=_[d]+_[C]}return l}();function pt(_){return typeof BigInt>"u"?gt:_}function gt(){throw new Error("BigInt not supported")}})(Ko);function Ha(t){const e=El(t),r=new ArrayBuffer(e.length),n=new DataView(r);for(let i=0;i<r.byteLength;i++)n.setUint8(i,e.charCodeAt(i));return r}const bl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function El(t){t.length%4===0&&(t=t.replace(/==?$/,""));let e="",r=0,n=0;for(let i=0;i<t.length;i++)r<<=6,r|=bl.indexOf(t[i]),n+=6,n===24&&(e+=String.fromCharCode((r&16711680)>>16),e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,e+=String.fromCharCode(r)):n===18&&(r>>=2,e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255)),e}const xl=-1,vl=-2,Nl=-3,Tl=-4,Ol=-5,Sl=-6;function Yp(t,e){if(typeof t=="number")return i(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const r=t,n=Array(r.length);function i(a,f=!1){if(a===xl)return;if(a===Nl)return NaN;if(a===Tl)return 1/0;if(a===Ol)return-1/0;if(a===Sl)return-0;if(f)throw new Error("Invalid input");if(a in n)return n[a];const o=r[a];if(!o||typeof o!="object")n[a]=o;else if(Array.isArray(o))if(typeof o[0]=="string"){const y=o[0],w=e?.[y];if(w)return n[a]=w(i(o[1]));switch(y){case"Date":n[a]=new Date(o[1]);break;case"Set":const N=new Set;n[a]=N;for(let S=1;S<o.length;S+=1)N.add(i(o[S]));break;case"Map":const A=new Map;n[a]=A;for(let S=1;S<o.length;S+=2)A.set(i(o[S]),i(o[S+1]));break;case"RegExp":n[a]=new RegExp(o[1],o[2]);break;case"Object":n[a]=Object(o[1]);break;case"BigInt":n[a]=BigInt(o[1]);break;case"null":const R=Object.create(null);n[a]=R;for(let S=1;S<o.length;S+=2)R[o[S]]=i(o[S+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const S=globalThis[y],b=o[1],q=Ha(b),M=new S(q);n[a]=M;break}case"ArrayBuffer":{const S=o[1],b=Ha(S);n[a]=b;break}default:throw new Error(`Unknown type ${y}`)}}else{const y=new Array(o.length);n[a]=y;for(let w=0;w<o.length;w+=1){const N=o[w];N!==vl&&(y[w]=i(N))}}else{const y={};n[a]=y;for(const w in o){const N=o[w];y[w]=i(N)}}return n[a]}return i(0)}var ra;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(ra||(ra={}));const ji="abcdefghijklmnopqrstuvwxyz234567",nn=Object.create(null);for(let t=0;t<ji.length;t++)nn[ji[t]]=t;nn[0]=nn.o;nn[1]=nn.i;function Rl(t){let e=0,r=0,n="";function i(a){return e<0?r|=a>>-e:r=a<<e&248,e>3?(e-=8,1):(e<4&&(n+=ji[r>>3],e+=5),0)}for(let a=0;a<t.length;)a+=i(t[a]);return n+(e<0?ji[r>>3]:"")}function Al(t){let e=0,r=0;const n=new Uint8Array(t.length*4/3|0);let i=0;function a(f){let o=nn[f.toLowerCase()];if(o===void 0)throw new Error(`Invalid character: ${JSON.stringify(f)}`);o<<=3,r|=o>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,e>0?r=o<<5-e&255:r=0)}for(const f of t)a(f);return n.slice(0,i)}const Il=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Bl(t){const e=new Uint8Array(t);let r=-1;for(let n=0;n<e.length;n++){const a=(e[n]^r)&255;r=Il[a]^r>>>8}return(r^-1)>>>0}function Ul(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Yo(t,...e){if(!Ul(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Ka(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Fl(t,e){Yo(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const qr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fs=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ie=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Pl(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Wo(t){return typeof t=="string"&&(t=Pl(t)),Yo(t),t}class Vl{clone(){return this._cloneInto()}}function Na(t){const e=n=>t().update(Wo(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Zo(t=32){if(qr&&typeof qr.getRandomValues=="function")return qr.getRandomValues(new Uint8Array(t));if(qr&&typeof qr.randomBytes=="function")return qr.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function kl(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),a=BigInt(4294967295),f=Number(r>>i&a),o=Number(r&a),y=n?4:0,w=n?0:4;t.setUint32(e+y,f,n),t.setUint32(e+w,o,n)}const Cl=(t,e,r)=>t&e^~t&r,Ml=(t,e,r)=>t&e^t&r^e&r;class Xo extends Vl{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Fs(this.buffer)}update(e){Ka(this);const{view:r,buffer:n,blockLen:i}=this;e=Wo(e);const a=e.length;for(let f=0;f<a;){const o=Math.min(i-this.pos,a-f);if(o===i){const y=Fs(e);for(;i<=a-f;f+=i)this.process(y,f);continue}n.set(e.subarray(f,f+o),this.pos),this.pos+=o,f+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ka(this),Fl(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:a}=this;let{pos:f}=this;r[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>i-f&&(this.process(n,0),f=0);for(let A=f;A<i;A++)r[A]=0;kl(n,i-8,BigInt(this.length*8),a),this.process(n,0);const o=Fs(e),y=this.outputLen;if(y%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const w=y/4,N=this.get();if(w>N.length)throw new Error("_sha2: outputLen bigger than state");for(let A=0;A<w;A++)o.setUint32(4*A,N[A],a)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:a,destroyed:f,pos:o}=this;return e.length=i,e.pos=o,e.finished=a,e.destroyed=f,i%r&&e.buffer.set(n),e}}const $l=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Je=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qe=new Uint32Array(64);class Jo extends Xo{constructor(){super(64,32,8,!1),this.A=Je[0]|0,this.B=Je[1]|0,this.C=Je[2]|0,this.D=Je[3]|0,this.E=Je[4]|0,this.F=Je[5]|0,this.G=Je[6]|0,this.H=Je[7]|0}get(){const{A:e,B:r,C:n,D:i,E:a,F:f,G:o,H:y}=this;return[e,r,n,i,a,f,o,y]}set(e,r,n,i,a,f,o,y){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=f|0,this.G=o|0,this.H=y|0}process(e,r){for(let A=0;A<16;A++,r+=4)Qe[A]=e.getUint32(r,!1);for(let A=16;A<64;A++){const R=Qe[A-15],S=Qe[A-2],b=Ie(R,7)^Ie(R,18)^R>>>3,q=Ie(S,17)^Ie(S,19)^S>>>10;Qe[A]=q+Qe[A-7]+b+Qe[A-16]|0}let{A:n,B:i,C:a,D:f,E:o,F:y,G:w,H:N}=this;for(let A=0;A<64;A++){const R=Ie(o,6)^Ie(o,11)^Ie(o,25),S=N+R+Cl(o,y,w)+$l[A]+Qe[A]|0,q=(Ie(n,2)^Ie(n,13)^Ie(n,22))+Ml(n,i,a)|0;N=w,w=y,y=o,o=f+S|0,f=a,a=i,i=n,n=S+q|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,f=f+this.D|0,o=o+this.E|0,y=y+this.F|0,w=w+this.G|0,N=N+this.H|0,this.set(n,i,a,f,o,y,w,N)}roundClean(){Qe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class ql extends Jo{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ta=Na(()=>new Jo),Dl=Na(()=>new ql);function Ll(t){return Dl.create().update(new Uint8Array(t)).digest()}const Tn="__principal__",Gl=2,za=4,jl="aaaaa-aa",Hl=t=>{var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(r=>parseInt(r,16)))},Kl=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"");let Nt=class wi{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([za]))}static managementCanister(){return this.fromHex(jl)}static selfAuthenticating(e){const r=Ll(e);return new this(new Uint8Array([...r,Gl]))}static from(e){if(typeof e=="string")return wi.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new wi(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new wi(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(Hl(e))}static fromText(e){let r=e;if(e.includes(Tn)){const f=JSON.parse(e);Tn in f&&(r=f[Tn])}const n=r.toLowerCase().replace(/-/g,"");let i=Al(n);i=i.slice(4,i.length);const a=new this(i);if(a.toText()!==r)throw new Error(`Principal "${a.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return a}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===za}toUint8Array(){return this._arr}toHex(){return Kl(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,Bl(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),a=new Uint8Array([...n,...i]),o=Rl(a).match(/.{1,5}/g);if(!o)throw new Error;return o.join("-")}toString(){return this.toText()}toJSON(){return{[Tn]:this.toText()}}compareTo(e){for(let r=0;r<Math.min(this._arr.length,e._arr.length);r++){if(this._arr[r]<e._arr[r])return"lt";if(this._arr[r]>e._arr[r])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const r=this.compareTo(e);return r=="lt"||r=="eq"}gtEq(e){const r=this.compareTo(e);return r=="gt"||r=="eq"}};const zl=Object.freeze(Object.defineProperty({__proto__:null,JSON_KEY_PRINCIPAL:Tn,Principal:Nt},Symbol.toStringTag,{value:"Module"}));function Re(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function Mt(t){return[...new Uint8Array(t)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Yl=new RegExp(/^[0-9a-fA-F]+$/);function We(t){if(!Yl.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(e).buffer}function Qo(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function zn(t,e){return Qo(t,e)===0}function Un(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Oa(t){return t instanceof Uint8Array?Un(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Un(new Uint8Array(t)):"buffer"in t?Oa(t.buffer):Un(new Uint8Array(t))}class Gt extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Gt.prototype,Object.setPrototypeOf(this,Gt.prototype)}}function Ft(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}let cn=class{constructor(e,r=e?.byteLength||0){this._buffer=Hi(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}get buffer(){return Hi(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const r=this._view.subarray(0,e);return this._view=this._view.subarray(e),r.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const r=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(e){const r=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+e);n.set(this._view),this._buffer=r,this._view=n}};function Ps(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Hi(t){return t instanceof Uint8Array?Ps(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Ps(new Uint8Array(t)):"buffer"in t?Hi(t.buffer):Ps(new Uint8Array(t))}function Wl(t){const r=new TextEncoder().encode(t);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function $e(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Wl(t)}function tc(){throw new Error("unexpected end of buffer")}function Pr(t,e){return t.byteLength<e&&tc(),t.read(e)}function Vr(t){const e=t.readUint8();return e===void 0&&tc(),e}function jt(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new cn(new ArrayBuffer(e),0);for(;;){const n=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function Xt(t){let e=BigInt(1),r=BigInt(0),n;do n=Vr(t),r+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return r}function Wt(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new cn(new ArrayBuffer(r),0);for(;;){const a=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&a&64||!e&&t===BigInt(0)&&!(a&64)){n.write(new Uint8Array([a]));break}else n.write(new Uint8Array([a|128]))}function i(a){const f=a%BigInt(128);return Number(e?BigInt(128)-f-BigInt(1):f)}return n.buffer}function sr(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(e[r]&64))return Xt(t);break}const n=new Uint8Array(Pr(t,r+1));let i=BigInt(0);for(let a=n.byteLength-1;a>=0;a--)i=i*BigInt(128)+BigInt(128-(n[a]&127)-1);return-i-BigInt(1)}function Zl(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return ec(t,e)}function ec(t,e){t=BigInt(t);const r=new cn(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),a=BigInt(0),f=Number(t%i);for(r.write(new Uint8Array([f]));++n<e;)t<0&&a===BigInt(0)&&f!==0&&(a=BigInt(1)),f=Number((t/i-a)%BigInt(256)),r.write(new Uint8Array([f])),i*=BigInt(256);return r.buffer}function rc(t,e){let r=BigInt(Vr(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const a=BigInt(Vr(t));r=r+n*a}return r}function Xl(t,e){let r=rc(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function na(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const bi="DIDL",Ya=400;function Cn(t,e,r){return t.map((n,i)=>r(n,e[i]))}class Jl{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,r){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(r)}merge(e,r){const n=this._idx.get(e.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const e=jt(this._typs.length),r=Ft(...this._typs);return Ft(e,r)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return Wt(this._idx.get(e)||0)}}class Ql{visitType(e,r){throw new Error("Not implemented")}visitPrimitive(e,r){return this.visitType(e,r)}visitEmpty(e,r){return this.visitPrimitive(e,r)}visitBool(e,r){return this.visitPrimitive(e,r)}visitNull(e,r){return this.visitPrimitive(e,r)}visitReserved(e,r){return this.visitPrimitive(e,r)}visitText(e,r){return this.visitPrimitive(e,r)}visitNumber(e,r){return this.visitPrimitive(e,r)}visitInt(e,r){return this.visitNumber(e,r)}visitNat(e,r){return this.visitNumber(e,r)}visitFloat(e,r){return this.visitPrimitive(e,r)}visitFixedInt(e,r){return this.visitNumber(e,r)}visitFixedNat(e,r){return this.visitNumber(e,r)}visitPrincipal(e,r){return this.visitPrimitive(e,r)}visitConstruct(e,r){return this.visitType(e,r)}visitVec(e,r,n){return this.visitConstruct(e,n)}visitOpt(e,r,n){return this.visitConstruct(e,n)}visitRecord(e,r,n){return this.visitConstruct(e,n)}visitTuple(e,r,n){const i=r.map((a,f)=>[`_${f}_`,a]);return this.visitRecord(e,i,n)}visitVariant(e,r,n){return this.visitConstruct(e,n)}visitRec(e,r,n){return this.visitConstruct(r,n)}visitFunc(e,r){return this.visitConstruct(e,r)}visitService(e,r){return this.visitConstruct(e,r)}}class as{display(){return this.name}valueToString(e){return Kt(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class we extends as{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class gr extends as{checkType(e){if(e instanceof wr){const r=e.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class nc extends we{accept(e,r){return e.visitEmpty(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return Wt(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class ic extends as{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,r){throw e.visitType(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,r){let n=r.decodeValue(e,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof wr?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class sc extends we{accept(e,r){return e.visitBool(this,r)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return Wt(-2)}decodeValue(e,r){switch(this.checkType(r),Vr(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class ac extends we{accept(e,r){return e.visitNull(this,r)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Wt(-1)}decodeValue(e,r){return this.checkType(r),null}get name(){return"null"}}class Ki extends we{accept(e,r){return e.visitReserved(this,r)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Wt(-16)}decodeValue(e,r){return r.name!==this.name&&r.decodeValue(e,r),null}get name(){return"reserved"}}class oc extends we{accept(e,r){return e.visitText(this,r)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=new TextEncoder().encode(e),n=jt(r.byteLength);return Ft(n,r)}encodeType(){return Wt(-15)}decodeValue(e,r){this.checkType(r);const n=Xt(e),i=Pr(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class cc extends we{accept(e,r){return e.visitInt(this,r)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return Wt(e)}encodeType(){return Wt(-4)}decodeValue(e,r){return this.checkType(r),sr(e)}get name(){return"int"}valueToString(e){return e.toString()}}class uc extends we{accept(e,r){return e.visitNat(this,r)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return jt(e)}encodeType(){return Wt(-3)}decodeValue(e,r){return this.checkType(r),Xt(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Sa extends we{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,r){return e.visitFloat(this,r)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),r}encodeType(){const e=this._bits===32?-13:-14;return Wt(e)}decodeValue(e,r){this.checkType(r);const n=Pr(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class kr extends we{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedInt(this,r)}covariant(e){const r=na(this._bits-1)*BigInt(-1),n=na(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=r&&e<=n;else if(Number.isInteger(e)){const a=BigInt(e);i=a>=r&&a<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return ec(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return Wt(-9-e)}decodeValue(e,r){this.checkType(r);const n=Xl(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class _r extends we{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedNat(this,r)}covariant(e){const r=na(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<r:Number.isInteger(e)&&e>=0?n=BigInt(e)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return Zl(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return Wt(-5-e)}decodeValue(e,r){this.checkType(r);const n=rc(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class os extends gr{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof _r&&e._bits===8&&(this._blobOptimization=!0)}accept(e,r){return e.visitVec(this,this._type,r)}covariant(e){const r=this._type instanceof _r?this._type._bits:this._type instanceof kr?this._type._bits:0;if(ArrayBuffer.isView(e)&&r==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(a){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${a.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=jt(e.length);if(this._blobOptimization)return Ft(r,new Uint8Array(e));if(ArrayBuffer.isView(e))return Ft(r,new Uint8Array(e.buffer));const n=new cn(new ArrayBuffer(r.byteLength+e.length),0);n.write(r);for(const i of e){const a=this._type.encodeValue(i);n.write(new Uint8Array(a))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=Wt(-19),n=this._type.encodeType(e);e.add(this,Ft(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof os))throw new Error("Not a vector type");const i=Number(Xt(e));if(this._type instanceof _r){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof kr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const a=[];for(let f=0;f<i;f++)a.push(this._type.decodeValue(e,n._type));return a}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class sn extends gr{constructor(e){super(),this._type=e}accept(e,r){return e.visitOpt(this,this._type,r)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${Kt(e)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Ft(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=Wt(-18),n=this._type.encodeType(e);e.add(this,Ft(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof sn))throw new Error("Not an option type");switch(Vr(e)){case 0:return[];case 1:return[this._type.decodeValue(e,n._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class Yn extends gr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>$e(r[0])-$e(n[0]))}accept(e,r){return e.visitRecord(this,this._fields,r)}tryAsTuple(){const e=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([r,n])=>{if(!e.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=this._fields.map(([i])=>e[i]),n=Cn(this._fields,r,([,i],a)=>i.encodeValue(a));return Ft(...n)}_buildTypeTableImpl(e){this._fields.forEach(([a,f])=>f.buildTypeTable(e));const r=Wt(-20),n=jt(this._fields.length),i=this._fields.map(([a,f])=>Ft(jt($e(a)),f.encodeType(e)));e.add(this,Ft(r,n,Ft(...i)))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Yn))throw new Error("Not a record type");const i={};let a=0,f=0;for(;f<n._fields.length;){const[o,y]=n._fields[f];if(a>=this._fields.length){y.decodeValue(e,y),f++;continue}const[w,N]=this._fields[a],A=$e(this._fields[a][0]),R=$e(o);if(A===R)i[w]=N.decodeValue(e,y),a++,f++;else if(R>A)if(N instanceof sn||N instanceof Ki)i[w]=[],a++;else throw new Error("Cannot find required field "+w);else y.decodeValue(e,y),f++}for(const[o,y]of this._fields.slice(a))if(y instanceof sn||y instanceof Ki)i[o]=[];else throw new Error("Cannot find required field "+o);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(e){const r=this._fields.map(([i])=>e[i]);return`record {${Cn(this._fields,r,([i,a],f)=>i+"="+a.valueToString(f)).join("; ")}}`}}class cs extends Yn{constructor(e){const r={};e.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=e}accept(e,r){return e.visitTuple(this,this._components,r)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=Cn(this._components,e,(n,i)=>n.encodeValue(i));return Ft(...r)}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof cs))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[a,f]of n._components.entries())a>=this._components.length?f.decodeValue(e,f):i.push(this._components[a].decodeValue(e,f));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(e){return`record {${Cn(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class us extends gr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>$e(r[0])-$e(n[0]))}accept(e,r){return e.visitVariant(this,this._fields,r)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([r,n])=>{try{return!e.hasOwnProperty(r)||n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(e.hasOwnProperty(n)){const a=jt(r),f=i.encodeValue(e[n]);return Ft(a,f)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,a])=>{a.buildTypeTable(e)});const r=Wt(-21),n=jt(this._fields.length),i=this._fields.map(([a,f])=>Ft(jt($e(a)),f.encodeType(e)));e.add(this,Ft(r,n,...i))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof us))throw new Error("Not a variant type");const i=Number(Xt(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[a,f]=n._fields[i];for(const[o,y]of this._fields)if($e(a)===$e(o)){const w=y.decodeValue(e,f);return{[o]:w}}throw new Error("Cannot find field hash "+a)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[r,n]of this._fields)if(e.hasOwnProperty(r)){const i=n.valueToString(e[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+e)}}class wr extends gr{constructor(){super(...arguments),this._id=wr._counter++,this._type=void 0}accept(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,r)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}wr._counter=0;function Ra(t){if(Vr(t)!==1)throw new Error("Cannot decode principal");const r=Number(Xt(t));return Nt.fromUint8Array(new Uint8Array(Pr(t,r)))}class lc extends we{accept(e,r){return e.visitPrincipal(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=jt(r.byteLength);return Ft(new Uint8Array([1]),n,r)}encodeType(){return Wt(-24)}decodeValue(e,r){return this.checkType(r),Ra(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class Aa extends gr{constructor(e,r,n=[]){super(),this.argTypes=e,this.retTypes=r,this.annotations=n}static argsToString(e,r){if(e.length!==r.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(e,r){return e.visitFunc(this,r)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue([e,r]){const n=e.toUint8Array(),i=jt(n.byteLength),a=Ft(new Uint8Array([1]),i,n),f=new TextEncoder().encode(r),o=jt(f.byteLength);return Ft(new Uint8Array([1]),a,o,f)}_buildTypeTableImpl(e){this.argTypes.forEach(w=>w.buildTypeTable(e)),this.retTypes.forEach(w=>w.buildTypeTable(e));const r=Wt(-22),n=jt(this.argTypes.length),i=Ft(...this.argTypes.map(w=>w.encodeType(e))),a=jt(this.retTypes.length),f=Ft(...this.retTypes.map(w=>w.encodeType(e))),o=jt(this.annotations.length),y=Ft(...this.annotations.map(w=>this.encodeAnnotation(w)));e.add(this,Ft(r,n,i,a,f,o,y))}decodeValue(e){if(Vr(e)!==1)throw new Error("Cannot decode function reference");const n=Ra(e),i=Number(Xt(e)),a=Pr(e,i),o=new TextDecoder("utf8",{fatal:!0}).decode(a);return[n,o]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${r})${n}`}valueToString([e,r]){return`func "${e.toText()}".${r}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e}) → (${r})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class fc extends gr{constructor(e){super(),this._fields=Object.entries(e).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(e,r){return e.visitService(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Kt(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=jt(r.length);return Ft(new Uint8Array([1]),n,r)}_buildTypeTableImpl(e){this._fields.forEach(([a,f])=>f.buildTypeTable(e));const r=Wt(-23),n=jt(this._fields.length),i=this._fields.map(([a,f])=>{const o=new TextEncoder().encode(a),y=jt(o.length);return Ft(y,o,f.encodeType(e))});e.add(this,Ft(r,n,...i))}decodeValue(e){return Ra(e)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Kt(t){const e=JSON.stringify(t,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>Ya?e.substring(0,Ya-3)+"...":e}function ia(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new Jl;t.forEach(y=>y.buildTypeTable(r));const n=new TextEncoder().encode(bi),i=r.encode(),a=jt(e.length),f=Ft(...t.map(y=>y.encodeType(r))),o=Ft(...Cn(t,e,(y,w)=>{try{y.covariant(w)}catch(N){throw new Error(N.message+`

`)}return y.encodeValue(w)}));return Ft(n,i,a,f,o)}function dc(t,e){const r=new cn(e);if(e.byteLength<bi.length)throw new Error("Message length smaller than magic number");const n=Pr(r,bi.length),i=new TextDecoder().decode(n);if(i!==bi)throw new Error("Wrong magic number: "+JSON.stringify(i));function a(S){const b=[],q=Number(Xt(S));for(let j=0;j<q;j++){const V=Number(sr(S));switch(V){case-18:case-19:{const rt=Number(sr(S));b.push([V,rt]);break}case-20:case-21:{const rt=[];let k=Number(Xt(S)),W;for(;k--;){const D=Number(Xt(S));if(D>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof W=="number"&&W>=D)throw new Error("field id collision or not sorted");W=D;const J=Number(sr(S));rt.push([D,J])}b.push([V,rt]);break}case-22:{const rt=[];let k=Number(Xt(S));for(;k--;)rt.push(Number(sr(S)));const W=[];let D=Number(Xt(S));for(;D--;)W.push(Number(sr(S)));const J=[];let nt=Number(Xt(S));for(;nt--;)switch(Number(Xt(S))){case 1:{J.push("query");break}case 2:{J.push("oneway");break}case 3:{J.push("composite_query");break}default:throw new Error("unknown annotation")}b.push([V,[rt,W,J]]);break}case-23:{let rt=Number(Xt(S));const k=[];for(;rt--;){const W=Number(Xt(S)),D=new TextDecoder().decode(Pr(S,W)),J=sr(S);k.push([D,J])}b.push([V,k]);break}default:throw new Error("Illegal op_code: "+V)}}const M=[],z=Number(Xt(S));for(let j=0;j<z;j++)M.push(Number(sr(S)));return[b,M]}const[f,o]=a(r);if(o.length<t.length)throw new Error("Wrong number of return values");const y=f.map(S=>kc());function w(S){if(S<-24)throw new Error("future value not supported");if(S<0)switch(S){case-1:return yc;case-2:return _c;case-3:return wc;case-4:return gc;case-5:return Oc;case-6:return Sc;case-7:return Rc;case-8:return Ac;case-9:return xc;case-10:return vc;case-11:return Nc;case-12:return Tc;case-13:return bc;case-14:return Ec;case-15:return mc;case-16:return pc;case-17:return hc;case-24:return Ic;default:throw new Error("Illegal op_code: "+S)}if(S>=f.length)throw new Error("type index out of range");return y[S]}function N(S){switch(S[0]){case-19:{const b=w(S[1]);return Uc(b)}case-18:{const b=w(S[1]);return Fc(b)}case-20:{const b={};for(const[z,j]of S[1]){const V=`_${z}_`;b[V]=w(j)}const q=Pc(b),M=q.tryAsTuple();return Array.isArray(M)?Bc(...M):q}case-21:{const b={};for(const[q,M]of S[1]){const z=`_${q}_`;b[z]=w(M)}return Vc(b)}case-22:{const[b,q,M]=S[1];return Cc(b.map(z=>w(z)),q.map(z=>w(z)),M)}case-23:{const b={},q=S[1];for(const[M,z]of q){let j=w(z);if(j instanceof wr&&(j=j.getType()),!(j instanceof Aa))throw new Error("Illegal service definition: services can only contain functions");b[M]=j}return Mc(b)}default:throw new Error("Illegal op_code: "+S[0])}}f.forEach((S,b)=>{if(S[0]===-22){const q=N(S);y[b].fill(q)}}),f.forEach((S,b)=>{if(S[0]!==-22){const q=N(S);y[b].fill(q)}});const A=o.map(S=>w(S)),R=t.map((S,b)=>S.decodeValue(r,A[b]));for(let S=t.length;S<A.length;S++)A[S].decodeValue(r,A[S]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return R}const hc=new nc,pc=new Ki,tf=new ic,_c=new sc,yc=new ac,mc=new oc,gc=new cc,wc=new uc,bc=new Sa(32),Ec=new Sa(64),xc=new kr(8),vc=new kr(16),Nc=new kr(32),Tc=new kr(64),Oc=new _r(8),Sc=new _r(16),Rc=new _r(32),Ac=new _r(64),Ic=new lc;function Bc(...t){return new cs(t)}function Uc(t){return new os(t)}function Fc(t){return new sn(t)}function Pc(t){return new Yn(t)}function Vc(t){return new us(t)}function kc(){return new wr}function Cc(t,e,r=[]){return new Aa(t,e,r)}function Mc(t){return new fc(t)}const ef=Object.freeze(Object.defineProperty({__proto__:null,Bool:_c,BoolClass:sc,ConstructType:gr,Empty:hc,EmptyClass:nc,FixedIntClass:kr,FixedNatClass:_r,Float32:bc,Float64:Ec,FloatClass:Sa,Func:Cc,FuncClass:Aa,Int:gc,Int16:vc,Int32:Nc,Int64:Tc,Int8:xc,IntClass:cc,Nat:wc,Nat16:Sc,Nat32:Rc,Nat64:Ac,Nat8:Oc,NatClass:uc,Null:yc,NullClass:ac,Opt:Fc,OptClass:sn,PrimitiveType:we,Principal:Ic,PrincipalClass:lc,Rec:kc,RecClass:wr,Record:Pc,RecordClass:Yn,Reserved:pc,ReservedClass:Ki,Service:Mc,ServiceClass:fc,Text:mc,TextClass:oc,Tuple:Bc,TupleClass:cs,Type:as,Unknown:tf,UnknownClass:ic,Variant:Vc,VariantClass:us,Vec:Uc,VecClass:os,Visitor:Ql,decode:dc,encode:ia},Symbol.toStringTag,{value:"Module"}));var $c={},Wn={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=Hn,r=Kn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=j,t.INSPECT_MAX_BYTES=50;var i=2147483647;t.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{var p=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(p,c),p.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function f(p){if(p>i)throw new RangeError('The value "'+p+'" is invalid for option "size"');var c=new Uint8Array(p);return Object.setPrototypeOf(c,o.prototype),c}function o(p,c,u){if(typeof p=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return A(p)}return y(p,c,u)}o.poolSize=8192;function y(p,c,u){if(typeof p=="string")return R(p,c);if(ArrayBuffer.isView(p))return b(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(x(p,ArrayBuffer)||p&&x(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(x(p,SharedArrayBuffer)||p&&x(p.buffer,SharedArrayBuffer)))return q(p,c,u);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var m=p.valueOf&&p.valueOf();if(m!=null&&m!==p)return o.from(m,c,u);var v=M(p);if(v)return v;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return o.from(p[Symbol.toPrimitive]("string"),c,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}o.from=function(p,c,u){return y(p,c,u)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function w(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function N(p,c,u){return w(p),p<=0?f(p):c!==void 0?typeof u=="string"?f(p).fill(c,u):f(p).fill(c):f(p)}o.alloc=function(p,c,u){return N(p,c,u)};function A(p){return w(p),f(p<0?0:z(p)|0)}o.allocUnsafe=function(p){return A(p)},o.allocUnsafeSlow=function(p){return A(p)};function R(p,c){if((typeof c!="string"||c==="")&&(c="utf8"),!o.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var u=V(p,c)|0,m=f(u),v=m.write(p,c);return v!==u&&(m=m.slice(0,v)),m}function S(p){for(var c=p.length<0?0:z(p.length)|0,u=f(c),m=0;m<c;m+=1)u[m]=p[m]&255;return u}function b(p){if(x(p,Uint8Array)){var c=new Uint8Array(p);return q(c.buffer,c.byteOffset,c.byteLength)}return S(p)}function q(p,c,u){if(c<0||p.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<c+(u||0))throw new RangeError('"length" is outside of buffer bounds');var m;return c===void 0&&u===void 0?m=new Uint8Array(p):u===void 0?m=new Uint8Array(p,c):m=new Uint8Array(p,c,u),Object.setPrototypeOf(m,o.prototype),m}function M(p){if(o.isBuffer(p)){var c=z(p.length)|0,u=f(c);return u.length===0||p.copy(u,0,0,c),u}if(p.length!==void 0)return typeof p.length!="number"||T(p.length)?f(0):S(p);if(p.type==="Buffer"&&Array.isArray(p.data))return S(p.data)}function z(p){if(p>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return p|0}function j(p){return+p!=p&&(p=0),o.alloc(+p)}o.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==o.prototype},o.compare=function(c,u){if(x(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),x(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),!o.isBuffer(c)||!o.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;for(var m=c.length,v=u.length,B=0,L=Math.min(m,v);B<L;++B)if(c[B]!==u[B]){m=c[B],v=u[B];break}return m<v?-1:v<m?1:0},o.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(c,u){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return o.alloc(0);var m;if(u===void 0)for(u=0,m=0;m<c.length;++m)u+=c[m].length;var v=o.allocUnsafe(u),B=0;for(m=0;m<c.length;++m){var L=c[m];if(x(L,Uint8Array))B+L.length>v.length?o.from(L).copy(v,B):Uint8Array.prototype.set.call(v,L,B);else if(o.isBuffer(L))L.copy(v,B);else throw new TypeError('"list" argument must be an Array of Buffers');B+=L.length}return v};function V(p,c){if(o.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||x(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);var u=p.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&u===0)return 0;for(var v=!1;;)switch(c){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return it(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return s(p).length;default:if(v)return m?-1:it(p).length;c=(""+c).toLowerCase(),v=!0}}o.byteLength=V;function rt(p,c,u){var m=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,c>>>=0,u<=c))return"";for(p||(p="utf8");;)switch(p){case"hex":return et(this,c,u);case"utf8":case"utf-8":return F(this,c,u);case"ascii":return G(this,c,u);case"latin1":case"binary":return Q(this,c,u);case"base64":return I(this,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,c,u);default:if(m)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),m=!0}}o.prototype._isBuffer=!0;function k(p,c,u){var m=p[c];p[c]=p[u],p[u]=m}o.prototype.swap16=function(){var c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<c;u+=2)k(this,u,u+1);return this},o.prototype.swap32=function(){var c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<c;u+=4)k(this,u,u+3),k(this,u+1,u+2);return this},o.prototype.swap64=function(){var c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<c;u+=8)k(this,u,u+7),k(this,u+1,u+6),k(this,u+2,u+5),k(this,u+3,u+4);return this},o.prototype.toString=function(){var c=this.length;return c===0?"":arguments.length===0?F(this,0,c):rt.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(c){if(!o.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:o.compare(this,c)===0},o.prototype.inspect=function(){var c="",u=t.INSPECT_MAX_BYTES;return c=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(c+=" ... "),"<Buffer "+c+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(c,u,m,v,B){if(x(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),!o.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(u===void 0&&(u=0),m===void 0&&(m=c?c.length:0),v===void 0&&(v=0),B===void 0&&(B=this.length),u<0||m>c.length||v<0||B>this.length)throw new RangeError("out of range index");if(v>=B&&u>=m)return 0;if(v>=B)return-1;if(u>=m)return 1;if(u>>>=0,m>>>=0,v>>>=0,B>>>=0,this===c)return 0;for(var L=B-v,Z=m-u,ot=Math.min(L,Z),pt=this.slice(v,B),gt=c.slice(u,m),_=0;_<ot;++_)if(pt[_]!==gt[_]){L=pt[_],Z=gt[_];break}return L<Z?-1:Z<L?1:0};function W(p,c,u,m,v){if(p.length===0)return-1;if(typeof u=="string"?(m=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,T(u)&&(u=v?0:p.length-1),u<0&&(u=p.length+u),u>=p.length){if(v)return-1;u=p.length-1}else if(u<0)if(v)u=0;else return-1;if(typeof c=="string"&&(c=o.from(c,m)),o.isBuffer(c))return c.length===0?-1:D(p,c,u,m,v);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(p,c,u):Uint8Array.prototype.lastIndexOf.call(p,c,u):D(p,[c],u,m,v);throw new TypeError("val must be string, number or Buffer")}function D(p,c,u,m,v){var B=1,L=p.length,Z=c.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(p.length<2||c.length<2)return-1;B=2,L/=2,Z/=2,u/=2}function ot(d,O){return B===1?d[O]:d.readUInt16BE(O*B)}var pt;if(v){var gt=-1;for(pt=u;pt<L;pt++)if(ot(p,pt)===ot(c,gt===-1?0:pt-gt)){if(gt===-1&&(gt=pt),pt-gt+1===Z)return gt*B}else gt!==-1&&(pt-=pt-gt),gt=-1}else for(u+Z>L&&(u=L-Z),pt=u;pt>=0;pt--){for(var _=!0,l=0;l<Z;l++)if(ot(p,pt+l)!==ot(c,l)){_=!1;break}if(_)return pt}return-1}o.prototype.includes=function(c,u,m){return this.indexOf(c,u,m)!==-1},o.prototype.indexOf=function(c,u,m){return W(this,c,u,m,!0)},o.prototype.lastIndexOf=function(c,u,m){return W(this,c,u,m,!1)};function J(p,c,u,m){u=Number(u)||0;var v=p.length-u;m?(m=Number(m),m>v&&(m=v)):m=v;var B=c.length;m>B/2&&(m=B/2);for(var L=0;L<m;++L){var Z=parseInt(c.substr(L*2,2),16);if(T(Z))return L;p[u+L]=Z}return L}function nt(p,c,u,m){return h(it(c,p.length-u),p,u,m)}function tt(p,c,u,m){return h(st(c),p,u,m)}function dt(p,c,u,m){return h(s(c),p,u,m)}function ut(p,c,u,m){return h(g(c,p.length-u),p,u,m)}o.prototype.write=function(c,u,m,v){if(u===void 0)v="utf8",m=this.length,u=0;else if(m===void 0&&typeof u=="string")v=u,m=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(m)?(m=m>>>0,v===void 0&&(v="utf8")):(v=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var B=this.length-u;if((m===void 0||m>B)&&(m=B),c.length>0&&(m<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");for(var L=!1;;)switch(v){case"hex":return J(this,c,u,m);case"utf8":case"utf-8":return nt(this,c,u,m);case"ascii":case"latin1":case"binary":return tt(this,c,u,m);case"base64":return dt(this,c,u,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,c,u,m);default:if(L)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),L=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(p,c,u){return c===0&&u===p.length?e.fromByteArray(p):e.fromByteArray(p.slice(c,u))}function F(p,c,u){u=Math.min(p.length,u);for(var m=[],v=c;v<u;){var B=p[v],L=null,Z=B>239?4:B>223?3:B>191?2:1;if(v+Z<=u){var ot,pt,gt,_;switch(Z){case 1:B<128&&(L=B);break;case 2:ot=p[v+1],(ot&192)===128&&(_=(B&31)<<6|ot&63,_>127&&(L=_));break;case 3:ot=p[v+1],pt=p[v+2],(ot&192)===128&&(pt&192)===128&&(_=(B&15)<<12|(ot&63)<<6|pt&63,_>2047&&(_<55296||_>57343)&&(L=_));break;case 4:ot=p[v+1],pt=p[v+2],gt=p[v+3],(ot&192)===128&&(pt&192)===128&&(gt&192)===128&&(_=(B&15)<<18|(ot&63)<<12|(pt&63)<<6|gt&63,_>65535&&_<1114112&&(L=_))}}L===null?(L=65533,Z=1):L>65535&&(L-=65536,m.push(L>>>10&1023|55296),L=56320|L&1023),m.push(L),v+=Z}return $(m)}var Y=4096;function $(p){var c=p.length;if(c<=Y)return String.fromCharCode.apply(String,p);for(var u="",m=0;m<c;)u+=String.fromCharCode.apply(String,p.slice(m,m+=Y));return u}function G(p,c,u){var m="";u=Math.min(p.length,u);for(var v=c;v<u;++v)m+=String.fromCharCode(p[v]&127);return m}function Q(p,c,u){var m="";u=Math.min(p.length,u);for(var v=c;v<u;++v)m+=String.fromCharCode(p[v]);return m}function et(p,c,u){var m=p.length;(!c||c<0)&&(c=0),(!u||u<0||u>m)&&(u=m);for(var v="",B=c;B<u;++B)v+=U[p[B]];return v}function _t(p,c,u){for(var m=p.slice(c,u),v="",B=0;B<m.length-1;B+=2)v+=String.fromCharCode(m[B]+m[B+1]*256);return v}o.prototype.slice=function(c,u){var m=this.length;c=~~c,u=u===void 0?m:~~u,c<0?(c+=m,c<0&&(c=0)):c>m&&(c=m),u<0?(u+=m,u<0&&(u=0)):u>m&&(u=m),u<c&&(u=c);var v=this.subarray(c,u);return Object.setPrototypeOf(v,o.prototype),v};function at(p,c,u){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+c>u)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(c,u,m){c=c>>>0,u=u>>>0,m||at(c,u,this.length);for(var v=this[c],B=1,L=0;++L<u&&(B*=256);)v+=this[c+L]*B;return v},o.prototype.readUintBE=o.prototype.readUIntBE=function(c,u,m){c=c>>>0,u=u>>>0,m||at(c,u,this.length);for(var v=this[c+--u],B=1;u>0&&(B*=256);)v+=this[c+--u]*B;return v},o.prototype.readUint8=o.prototype.readUInt8=function(c,u){return c=c>>>0,u||at(c,1,this.length),this[c]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(c,u){return c=c>>>0,u||at(c,2,this.length),this[c]|this[c+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(c,u){return c=c>>>0,u||at(c,2,this.length),this[c]<<8|this[c+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(c,u){return c=c>>>0,u||at(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(c,u){return c=c>>>0,u||at(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},o.prototype.readIntLE=function(c,u,m){c=c>>>0,u=u>>>0,m||at(c,u,this.length);for(var v=this[c],B=1,L=0;++L<u&&(B*=256);)v+=this[c+L]*B;return B*=128,v>=B&&(v-=Math.pow(2,8*u)),v},o.prototype.readIntBE=function(c,u,m){c=c>>>0,u=u>>>0,m||at(c,u,this.length);for(var v=u,B=1,L=this[c+--v];v>0&&(B*=256);)L+=this[c+--v]*B;return B*=128,L>=B&&(L-=Math.pow(2,8*u)),L},o.prototype.readInt8=function(c,u){return c=c>>>0,u||at(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},o.prototype.readInt16LE=function(c,u){c=c>>>0,u||at(c,2,this.length);var m=this[c]|this[c+1]<<8;return m&32768?m|4294901760:m},o.prototype.readInt16BE=function(c,u){c=c>>>0,u||at(c,2,this.length);var m=this[c+1]|this[c]<<8;return m&32768?m|4294901760:m},o.prototype.readInt32LE=function(c,u){return c=c>>>0,u||at(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},o.prototype.readInt32BE=function(c,u){return c=c>>>0,u||at(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},o.prototype.readFloatLE=function(c,u){return c=c>>>0,u||at(c,4,this.length),r.read(this,c,!0,23,4)},o.prototype.readFloatBE=function(c,u){return c=c>>>0,u||at(c,4,this.length),r.read(this,c,!1,23,4)},o.prototype.readDoubleLE=function(c,u){return c=c>>>0,u||at(c,8,this.length),r.read(this,c,!0,52,8)},o.prototype.readDoubleBE=function(c,u){return c=c>>>0,u||at(c,8,this.length),r.read(this,c,!1,52,8)};function X(p,c,u,m,v,B){if(!o.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>v||c<B)throw new RangeError('"value" argument is out of bounds');if(u+m>p.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(c,u,m,v){if(c=+c,u=u>>>0,m=m>>>0,!v){var B=Math.pow(2,8*m)-1;X(this,c,u,m,B,0)}var L=1,Z=0;for(this[u]=c&255;++Z<m&&(L*=256);)this[u+Z]=c/L&255;return u+m},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(c,u,m,v){if(c=+c,u=u>>>0,m=m>>>0,!v){var B=Math.pow(2,8*m)-1;X(this,c,u,m,B,0)}var L=m-1,Z=1;for(this[u+L]=c&255;--L>=0&&(Z*=256);)this[u+L]=c/Z&255;return u+m},o.prototype.writeUint8=o.prototype.writeUInt8=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,1,255,0),this[u]=c&255,u+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,2,65535,0),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=c&255,u+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4},o.prototype.writeIntLE=function(c,u,m,v){if(c=+c,u=u>>>0,!v){var B=Math.pow(2,8*m-1);X(this,c,u,m,B-1,-B)}var L=0,Z=1,ot=0;for(this[u]=c&255;++L<m&&(Z*=256);)c<0&&ot===0&&this[u+L-1]!==0&&(ot=1),this[u+L]=(c/Z>>0)-ot&255;return u+m},o.prototype.writeIntBE=function(c,u,m,v){if(c=+c,u=u>>>0,!v){var B=Math.pow(2,8*m-1);X(this,c,u,m,B-1,-B)}var L=m-1,Z=1,ot=0;for(this[u+L]=c&255;--L>=0&&(Z*=256);)c<0&&ot===0&&this[u+L+1]!==0&&(ot=1),this[u+L]=(c/Z>>0)-ot&255;return u+m},o.prototype.writeInt8=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=c&255,u+1},o.prototype.writeInt16LE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,2,32767,-32768),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeInt16BE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeInt32LE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,4,2147483647,-2147483648),this[u]=c&255,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},o.prototype.writeInt32BE=function(c,u,m){return c=+c,u=u>>>0,m||X(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4};function lt(p,c,u,m,v,B){if(u+m>p.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function E(p,c,u,m,v){return c=+c,u=u>>>0,v||lt(p,c,u,4),r.write(p,c,u,m,23,4),u+4}o.prototype.writeFloatLE=function(c,u,m){return E(this,c,u,!0,m)},o.prototype.writeFloatBE=function(c,u,m){return E(this,c,u,!1,m)};function ct(p,c,u,m,v){return c=+c,u=u>>>0,v||lt(p,c,u,8),r.write(p,c,u,m,52,8),u+8}o.prototype.writeDoubleLE=function(c,u,m){return ct(this,c,u,!0,m)},o.prototype.writeDoubleBE=function(c,u,m){return ct(this,c,u,!1,m)},o.prototype.copy=function(c,u,m,v){if(!o.isBuffer(c))throw new TypeError("argument should be a Buffer");if(m||(m=0),!v&&v!==0&&(v=this.length),u>=c.length&&(u=c.length),u||(u=0),v>0&&v<m&&(v=m),v===m||c.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),c.length-u<v-m&&(v=c.length-u+m);var B=v-m;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,m,v):Uint8Array.prototype.set.call(c,this.subarray(m,v),u),B},o.prototype.fill=function(c,u,m,v){if(typeof c=="string"){if(typeof u=="string"?(v=u,u=0,m=this.length):typeof m=="string"&&(v=m,m=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!o.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(c.length===1){var B=c.charCodeAt(0);(v==="utf8"&&B<128||v==="latin1")&&(c=B)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(u<0||this.length<u||this.length<m)throw new RangeError("Out of range index");if(m<=u)return this;u=u>>>0,m=m===void 0?this.length:m>>>0,c||(c=0);var L;if(typeof c=="number")for(L=u;L<m;++L)this[L]=c;else{var Z=o.isBuffer(c)?c:o.from(c,v),ot=Z.length;if(ot===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(L=0;L<m-u;++L)this[L+u]=Z[L%ot]}return this};var ft=/[^+/0-9A-Za-z-_]/g;function yt(p){if(p=p.split("=")[0],p=p.trim().replace(ft,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function it(p,c){c=c||1/0;for(var u,m=p.length,v=null,B=[],L=0;L<m;++L){if(u=p.charCodeAt(L),u>55295&&u<57344){if(!v){if(u>56319){(c-=3)>-1&&B.push(239,191,189);continue}else if(L+1===m){(c-=3)>-1&&B.push(239,191,189);continue}v=u;continue}if(u<56320){(c-=3)>-1&&B.push(239,191,189),v=u;continue}u=(v-55296<<10|u-56320)+65536}else v&&(c-=3)>-1&&B.push(239,191,189);if(v=null,u<128){if((c-=1)<0)break;B.push(u)}else if(u<2048){if((c-=2)<0)break;B.push(u>>6|192,u&63|128)}else if(u<65536){if((c-=3)<0)break;B.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((c-=4)<0)break;B.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return B}function st(p){for(var c=[],u=0;u<p.length;++u)c.push(p.charCodeAt(u)&255);return c}function g(p,c){for(var u,m,v,B=[],L=0;L<p.length&&!((c-=2)<0);++L)u=p.charCodeAt(L),m=u>>8,v=u%256,B.push(v),B.push(m);return B}function s(p){return e.toByteArray(yt(p))}function h(p,c,u,m){for(var v=0;v<m&&!(v+u>=c.length||v>=p.length);++v)c[v+u]=p[v];return v}function x(p,c){return p instanceof c||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===c.name}function T(p){return p!==p}var U=function(){for(var p="0123456789abcdef",c=new Array(256),u=0;u<16;++u)for(var m=u*16,v=0;v<16;++v)c[m+v]=p[u]+p[v];return c}()})(Wn);var qc={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,a=Math.floor,f="[BigNumber Error] ",o=f+"Number primitive has more than 15 significant digits: ",y=1e14,w=14,N=9007199254740991,A=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],R=1e7,S=1e9;function b(W){var D,J,nt,tt=E.prototype={constructor:E,toString:null,valueOf:null},dt=new E(1),ut=20,I=4,F=-7,Y=21,$=-1e7,G=1e7,Q=!1,et=1,_t=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},X="0123456789abcdefghijklmnopqrstuvwxyz",lt=!0;function E(g,s){var h,x,T,U,p,c,u,m,v=this;if(!(v instanceof E))return new E(g,s);if(s==null){if(g&&g._isBigNumber===!0){v.s=g.s,!g.c||g.e>G?v.c=v.e=null:g.e<$?v.c=[v.e=0]:(v.e=g.e,v.c=g.c.slice());return}if((c=typeof g=="number")&&g*0==0){if(v.s=1/g<0?(g=-g,-1):1,g===~~g){for(U=0,p=g;p>=10;p/=10,U++);U>G?v.c=v.e=null:(v.e=U,v.c=[g]);return}m=String(g)}else{if(!n.test(m=String(g)))return nt(v,m,c);v.s=m.charCodeAt(0)==45?(m=m.slice(1),-1):1}(U=m.indexOf("."))>-1&&(m=m.replace(".","")),(p=m.search(/e/i))>0?(U<0&&(U=p),U+=+m.slice(p+1),m=m.substring(0,p)):U<0&&(U=m.length)}else{if(j(s,2,X.length,"Base"),s==10&&lt)return v=new E(g),it(v,ut+v.e+1,I);if(m=String(g),c=typeof g=="number"){if(g*0!=0)return nt(v,m,c,s);if(v.s=1/g<0?(m=m.slice(1),-1):1,E.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(o+g)}else v.s=m.charCodeAt(0)===45?(m=m.slice(1),-1):1;for(h=X.slice(0,s),U=p=0,u=m.length;p<u;p++)if(h.indexOf(x=m.charAt(p))<0){if(x=="."){if(p>U){U=u;continue}}else if(!T&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){T=!0,p=-1,U=0;continue}return nt(v,String(g),c,s)}c=!1,m=J(m,s,10,v.s),(U=m.indexOf("."))>-1?m=m.replace(".",""):U=m.length}for(p=0;m.charCodeAt(p)===48;p++);for(u=m.length;m.charCodeAt(--u)===48;);if(m=m.slice(p,++u)){if(u-=p,c&&E.DEBUG&&u>15&&(g>N||g!==a(g)))throw Error(o+v.s*g);if((U=U-p-1)>G)v.c=v.e=null;else if(U<$)v.c=[v.e=0];else{if(v.e=U,v.c=[],p=(U+1)%w,U<0&&(p+=w),p<u){for(p&&v.c.push(+m.slice(0,p)),u-=w;p<u;)v.c.push(+m.slice(p,p+=w));p=w-(m=m.slice(p)).length}else p-=u;for(;p--;m+="0");v.c.push(+m)}}else v.c=[v.e=0]}E.clone=b,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=E.set=function(g){var s,h;if(g!=null)if(typeof g=="object"){if(g.hasOwnProperty(s="DECIMAL_PLACES")&&(h=g[s],j(h,0,S,s),ut=h),g.hasOwnProperty(s="ROUNDING_MODE")&&(h=g[s],j(h,0,8,s),I=h),g.hasOwnProperty(s="EXPONENTIAL_AT")&&(h=g[s],h&&h.pop?(j(h[0],-S,0,s),j(h[1],0,S,s),F=h[0],Y=h[1]):(j(h,-S,S,s),F=-(Y=h<0?-h:h))),g.hasOwnProperty(s="RANGE"))if(h=g[s],h&&h.pop)j(h[0],-S,-1,s),j(h[1],1,S,s),$=h[0],G=h[1];else if(j(h,-S,S,s),h)$=-(G=h<0?-h:h);else throw Error(f+s+" cannot be zero: "+h);if(g.hasOwnProperty(s="CRYPTO"))if(h=g[s],h===!!h)if(h)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Q=h;else throw Q=!h,Error(f+"crypto unavailable");else Q=h;else throw Error(f+s+" not true or false: "+h);if(g.hasOwnProperty(s="MODULO_MODE")&&(h=g[s],j(h,0,9,s),et=h),g.hasOwnProperty(s="POW_PRECISION")&&(h=g[s],j(h,0,S,s),_t=h),g.hasOwnProperty(s="FORMAT"))if(h=g[s],typeof h=="object")at=h;else throw Error(f+s+" not an object: "+h);if(g.hasOwnProperty(s="ALPHABET"))if(h=g[s],typeof h=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(h))lt=h.slice(0,10)=="0123456789",X=h;else throw Error(f+s+" invalid: "+h)}else throw Error(f+"Object expected: "+g);return{DECIMAL_PLACES:ut,ROUNDING_MODE:I,EXPONENTIAL_AT:[F,Y],RANGE:[$,G],CRYPTO:Q,MODULO_MODE:et,POW_PRECISION:_t,FORMAT:at,ALPHABET:X}},E.isBigNumber=function(g){if(!g||g._isBigNumber!==!0)return!1;if(!E.DEBUG)return!0;var s,h,x=g.c,T=g.e,U=g.s;t:if({}.toString.call(x)=="[object Array]"){if((U===1||U===-1)&&T>=-S&&T<=S&&T===a(T)){if(x[0]===0){if(T===0&&x.length===1)return!0;break t}if(s=(T+1)%w,s<1&&(s+=w),String(x[0]).length==s){for(s=0;s<x.length;s++)if(h=x[s],h<0||h>=y||h!==a(h))break t;if(h!==0)return!0}}}else if(x===null&&T===null&&(U===null||U===1||U===-1))return!0;throw Error(f+"Invalid BigNumber: "+g)},E.maximum=E.max=function(){return ft(arguments,-1)},E.minimum=E.min=function(){return ft(arguments,1)},E.random=function(){var g=9007199254740992,s=Math.random()*g&2097151?function(){return a(Math.random()*g)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(h){var x,T,U,p,c,u=0,m=[],v=new E(dt);if(h==null?h=ut:j(h,0,S),p=i(h/w),Q)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(p*=2));u<p;)c=x[u]*131072+(x[u+1]>>>11),c>=9e15?(T=crypto.getRandomValues(new Uint32Array(2)),x[u]=T[0],x[u+1]=T[1]):(m.push(c%1e14),u+=2);u=p/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(p*=7);u<p;)c=(x[u]&31)*281474976710656+x[u+1]*1099511627776+x[u+2]*4294967296+x[u+3]*16777216+(x[u+4]<<16)+(x[u+5]<<8)+x[u+6],c>=9e15?crypto.randomBytes(7).copy(x,u):(m.push(c%1e14),u+=7);u=p/7}else throw Q=!1,Error(f+"crypto unavailable");if(!Q)for(;u<p;)c=s(),c<9e15&&(m[u++]=c%1e14);for(p=m[--u],h%=w,p&&h&&(c=A[w-h],m[u]=a(p/c)*c);m[u]===0;m.pop(),u--);if(u<0)m=[U=0];else{for(U=-1;m[0]===0;m.splice(0,1),U-=w);for(u=1,c=m[0];c>=10;c/=10,u++);u<w&&(U-=w-u)}return v.e=U,v.c=m,v}}(),E.sum=function(){for(var g=1,s=arguments,h=new E(s[0]);g<s.length;)h=h.plus(s[g++]);return h},J=function(){var g="0123456789";function s(h,x,T,U){for(var p,c=[0],u,m=0,v=h.length;m<v;){for(u=c.length;u--;c[u]*=x);for(c[0]+=U.indexOf(h.charAt(m++)),p=0;p<c.length;p++)c[p]>T-1&&(c[p+1]==null&&(c[p+1]=0),c[p+1]+=c[p]/T|0,c[p]%=T)}return c.reverse()}return function(h,x,T,U,p){var c,u,m,v,B,L,Z,ot,pt=h.indexOf("."),gt=ut,_=I;for(pt>=0&&(v=_t,_t=0,h=h.replace(".",""),ot=new E(x),L=ot.pow(h.length-pt),_t=v,ot.c=s(k(M(L.c),L.e,"0"),10,T,g),ot.e=ot.c.length),Z=s(h,x,T,p?(c=X,g):(c=g,X)),m=v=Z.length;Z[--v]==0;Z.pop());if(!Z[0])return c.charAt(0);if(pt<0?--m:(L.c=Z,L.e=m,L.s=U,L=D(L,ot,gt,_,T),Z=L.c,B=L.r,m=L.e),u=m+gt+1,pt=Z[u],v=T/2,B=B||u<0||Z[u+1]!=null,B=_<4?(pt!=null||B)&&(_==0||_==(L.s<0?3:2)):pt>v||pt==v&&(_==4||B||_==6&&Z[u-1]&1||_==(L.s<0?8:7)),u<1||!Z[0])h=B?k(c.charAt(1),-gt,c.charAt(0)):c.charAt(0);else{if(Z.length=u,B)for(--T;++Z[--u]>T;)Z[u]=0,u||(++m,Z=[1].concat(Z));for(v=Z.length;!Z[--v];);for(pt=0,h="";pt<=v;h+=c.charAt(Z[pt++]));h=k(h,m,c.charAt(0))}return h}}(),D=function(){function g(x,T,U){var p,c,u,m,v=0,B=x.length,L=T%R,Z=T/R|0;for(x=x.slice();B--;)u=x[B]%R,m=x[B]/R|0,p=Z*u+m*L,c=L*u+p%R*R+v,v=(c/U|0)+(p/R|0)+Z*m,x[B]=c%U;return v&&(x=[v].concat(x)),x}function s(x,T,U,p){var c,u;if(U!=p)u=U>p?1:-1;else for(c=u=0;c<U;c++)if(x[c]!=T[c]){u=x[c]>T[c]?1:-1;break}return u}function h(x,T,U,p){for(var c=0;U--;)x[U]-=c,c=x[U]<T[U]?1:0,x[U]=c*p+x[U]-T[U];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,T,U,p,c){var u,m,v,B,L,Z,ot,pt,gt,_,l,d,O,C,K,H,wt,vt=x.s==T.s?1:-1,xt=x.c,Et=T.c;if(!xt||!xt[0]||!Et||!Et[0])return new E(!x.s||!T.s||(xt?Et&&xt[0]==Et[0]:!Et)?NaN:xt&&xt[0]==0||!Et?vt*0:vt/0);for(pt=new E(vt),gt=pt.c=[],m=x.e-T.e,vt=U+m+1,c||(c=y,m=q(x.e/w)-q(T.e/w),vt=vt/w|0),v=0;Et[v]==(xt[v]||0);v++);if(Et[v]>(xt[v]||0)&&m--,vt<0)gt.push(1),B=!0;else{for(C=xt.length,H=Et.length,v=0,vt+=2,L=a(c/(Et[0]+1)),L>1&&(Et=g(Et,L,c),xt=g(xt,L,c),H=Et.length,C=xt.length),O=H,_=xt.slice(0,H),l=_.length;l<H;_[l++]=0);wt=Et.slice(),wt=[0].concat(wt),K=Et[0],Et[1]>=c/2&&K++;do{if(L=0,u=s(Et,_,H,l),u<0){if(d=_[0],H!=l&&(d=d*c+(_[1]||0)),L=a(d/K),L>1)for(L>=c&&(L=c-1),Z=g(Et,L,c),ot=Z.length,l=_.length;s(Z,_,ot,l)==1;)L--,h(Z,H<ot?wt:Et,ot,c),ot=Z.length,u=1;else L==0&&(u=L=1),Z=Et.slice(),ot=Z.length;if(ot<l&&(Z=[0].concat(Z)),h(_,Z,l,c),l=_.length,u==-1)for(;s(Et,_,H,l)<1;)L++,h(_,H<l?wt:Et,l,c),l=_.length}else u===0&&(L++,_=[0]);gt[v++]=L,_[0]?_[l++]=xt[O]||0:(_=[xt[O]],l=1)}while((O++<C||_[0]!=null)&&vt--);B=_[0]!=null,gt[0]||gt.splice(0,1)}if(c==y){for(v=1,vt=gt[0];vt>=10;vt/=10,v++);it(pt,U+(pt.e=v+m*w-1)+1,p,B)}else pt.e=m,pt.r=+B;return pt}}();function ct(g,s,h,x){var T,U,p,c,u;if(h==null?h=I:j(h,0,8),!g.c)return g.toString();if(T=g.c[0],p=g.e,s==null)u=M(g.c),u=x==1||x==2&&(p<=F||p>=Y)?rt(u,p):k(u,p,"0");else if(g=it(new E(g),s,h),U=g.e,u=M(g.c),c=u.length,x==1||x==2&&(s<=U||U<=F)){for(;c<s;u+="0",c++);u=rt(u,U)}else if(s-=p,u=k(u,U,"0"),U+1>c){if(--s>0)for(u+=".";s--;u+="0");}else if(s+=U-c,s>0)for(U+1==c&&(u+=".");s--;u+="0");return g.s<0&&T?"-"+u:u}function ft(g,s){for(var h,x,T=1,U=new E(g[0]);T<g.length;T++)x=new E(g[T]),(!x.s||(h=z(U,x))===s||h===0&&U.s===s)&&(U=x);return U}function yt(g,s,h){for(var x=1,T=s.length;!s[--T];s.pop());for(T=s[0];T>=10;T/=10,x++);return(h=x+h*w-1)>G?g.c=g.e=null:h<$?g.c=[g.e=0]:(g.e=h,g.c=s),g}nt=function(){var g=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,h=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,p,c,u){var m,v=c?p:p.replace(T,"");if(x.test(v))U.s=isNaN(v)?null:v<0?-1:1;else{if(!c&&(v=v.replace(g,function(B,L,Z){return m=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!u||u==m?L:B}),u&&(m=u,v=v.replace(s,"$1").replace(h,"0.$1")),p!=v))return new E(v,m);if(E.DEBUG)throw Error(f+"Not a"+(u?" base "+u:"")+" number: "+p);U.s=null}U.c=U.e=null}}();function it(g,s,h,x){var T,U,p,c,u,m,v,B=g.c,L=A;if(B){t:{for(T=1,c=B[0];c>=10;c/=10,T++);if(U=s-T,U<0)U+=w,p=s,u=B[m=0],v=a(u/L[T-p-1]%10);else if(m=i((U+1)/w),m>=B.length)if(x){for(;B.length<=m;B.push(0));u=v=0,T=1,U%=w,p=U-w+1}else break t;else{for(u=c=B[m],T=1;c>=10;c/=10,T++);U%=w,p=U-w+T,v=p<0?0:a(u/L[T-p-1]%10)}if(x=x||s<0||B[m+1]!=null||(p<0?u:u%L[T-p-1]),x=h<4?(v||x)&&(h==0||h==(g.s<0?3:2)):v>5||v==5&&(h==4||x||h==6&&(U>0?p>0?u/L[T-p]:0:B[m-1])%10&1||h==(g.s<0?8:7)),s<1||!B[0])return B.length=0,x?(s-=g.e+1,B[0]=L[(w-s%w)%w],g.e=-s||0):B[0]=g.e=0,g;if(U==0?(B.length=m,c=1,m--):(B.length=m+1,c=L[w-U],B[m]=p>0?a(u/L[T-p]%L[p])*c:0),x)for(;;)if(m==0){for(U=1,p=B[0];p>=10;p/=10,U++);for(p=B[0]+=c,c=1;p>=10;p/=10,c++);U!=c&&(g.e++,B[0]==y&&(B[0]=1));break}else{if(B[m]+=c,B[m]!=y)break;B[m--]=0,c=1}for(U=B.length;B[--U]===0;B.pop());}g.e>G?g.c=g.e=null:g.e<$&&(g.c=[g.e=0])}return g}function st(g){var s,h=g.e;return h===null?g.toString():(s=M(g.c),s=h<=F||h>=Y?rt(s,h):k(s,h,"0"),g.s<0?"-"+s:s)}return tt.absoluteValue=tt.abs=function(){var g=new E(this);return g.s<0&&(g.s=1),g},tt.comparedTo=function(g,s){return z(this,new E(g,s))},tt.decimalPlaces=tt.dp=function(g,s){var h,x,T,U=this;if(g!=null)return j(g,0,S),s==null?s=I:j(s,0,8),it(new E(U),g+U.e+1,s);if(!(h=U.c))return null;if(x=((T=h.length-1)-q(this.e/w))*w,T=h[T])for(;T%10==0;T/=10,x--);return x<0&&(x=0),x},tt.dividedBy=tt.div=function(g,s){return D(this,new E(g,s),ut,I)},tt.dividedToIntegerBy=tt.idiv=function(g,s){return D(this,new E(g,s),0,1)},tt.exponentiatedBy=tt.pow=function(g,s){var h,x,T,U,p,c,u,m,v,B=this;if(g=new E(g),g.c&&!g.isInteger())throw Error(f+"Exponent not an integer: "+st(g));if(s!=null&&(s=new E(s)),c=g.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!g.c||!g.c[0])return v=new E(Math.pow(+st(B),c?g.s*(2-V(g)):+st(g))),s?v.mod(s):v;if(u=g.s<0,s){if(s.c?!s.c[0]:!s.s)return new E(NaN);x=!u&&B.isInteger()&&s.isInteger(),x&&(B=B.mod(s))}else{if(g.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||c&&B.c[1]>=24e7:B.c[0]<8e13||c&&B.c[0]<=9999975e7)))return U=B.s<0&&V(g)?-0:0,B.e>-1&&(U=1/U),new E(u?1/U:U);_t&&(U=i(_t/w+2))}for(c?(h=new E(.5),u&&(g.s=1),m=V(g)):(T=Math.abs(+st(g)),m=T%2),v=new E(dt);;){if(m){if(v=v.times(B),!v.c)break;U?v.c.length>U&&(v.c.length=U):x&&(v=v.mod(s))}if(T){if(T=a(T/2),T===0)break;m=T%2}else if(g=g.times(h),it(g,g.e+1,1),g.e>14)m=V(g);else{if(T=+st(g),T===0)break;m=T%2}B=B.times(B),U?B.c&&B.c.length>U&&(B.c.length=U):x&&(B=B.mod(s))}return x?v:(u&&(v=dt.div(v)),s?v.mod(s):U?it(v,_t,I,p):v)},tt.integerValue=function(g){var s=new E(this);return g==null?g=I:j(g,0,8),it(s,s.e+1,g)},tt.isEqualTo=tt.eq=function(g,s){return z(this,new E(g,s))===0},tt.isFinite=function(){return!!this.c},tt.isGreaterThan=tt.gt=function(g,s){return z(this,new E(g,s))>0},tt.isGreaterThanOrEqualTo=tt.gte=function(g,s){return(s=z(this,new E(g,s)))===1||s===0},tt.isInteger=function(){return!!this.c&&q(this.e/w)>this.c.length-2},tt.isLessThan=tt.lt=function(g,s){return z(this,new E(g,s))<0},tt.isLessThanOrEqualTo=tt.lte=function(g,s){return(s=z(this,new E(g,s)))===-1||s===0},tt.isNaN=function(){return!this.s},tt.isNegative=function(){return this.s<0},tt.isPositive=function(){return this.s>0},tt.isZero=function(){return!!this.c&&this.c[0]==0},tt.minus=function(g,s){var h,x,T,U,p=this,c=p.s;if(g=new E(g,s),s=g.s,!c||!s)return new E(NaN);if(c!=s)return g.s=-s,p.plus(g);var u=p.e/w,m=g.e/w,v=p.c,B=g.c;if(!u||!m){if(!v||!B)return v?(g.s=-s,g):new E(B?p:NaN);if(!v[0]||!B[0])return B[0]?(g.s=-s,g):new E(v[0]?p:I==3?-0:0)}if(u=q(u),m=q(m),v=v.slice(),c=u-m){for((U=c<0)?(c=-c,T=v):(m=u,T=B),T.reverse(),s=c;s--;T.push(0));T.reverse()}else for(x=(U=(c=v.length)<(s=B.length))?c:s,c=s=0;s<x;s++)if(v[s]!=B[s]){U=v[s]<B[s];break}if(U&&(T=v,v=B,B=T,g.s=-g.s),s=(x=B.length)-(h=v.length),s>0)for(;s--;v[h++]=0);for(s=y-1;x>c;){if(v[--x]<B[x]){for(h=x;h&&!v[--h];v[h]=s);--v[h],v[x]+=y}v[x]-=B[x]}for(;v[0]==0;v.splice(0,1),--m);return v[0]?yt(g,v,m):(g.s=I==3?-1:1,g.c=[g.e=0],g)},tt.modulo=tt.mod=function(g,s){var h,x,T=this;return g=new E(g,s),!T.c||!g.s||g.c&&!g.c[0]?new E(NaN):!g.c||T.c&&!T.c[0]?new E(T):(et==9?(x=g.s,g.s=1,h=D(T,g,0,3),g.s=x,h.s*=x):h=D(T,g,0,et),g=T.minus(h.times(g)),!g.c[0]&&et==1&&(g.s=T.s),g)},tt.multipliedBy=tt.times=function(g,s){var h,x,T,U,p,c,u,m,v,B,L,Z,ot,pt,gt,_=this,l=_.c,d=(g=new E(g,s)).c;if(!l||!d||!l[0]||!d[0])return!_.s||!g.s||l&&!l[0]&&!d||d&&!d[0]&&!l?g.c=g.e=g.s=null:(g.s*=_.s,!l||!d?g.c=g.e=null:(g.c=[0],g.e=0)),g;for(x=q(_.e/w)+q(g.e/w),g.s*=_.s,u=l.length,B=d.length,u<B&&(ot=l,l=d,d=ot,T=u,u=B,B=T),T=u+B,ot=[];T--;ot.push(0));for(pt=y,gt=R,T=B;--T>=0;){for(h=0,L=d[T]%gt,Z=d[T]/gt|0,p=u,U=T+p;U>T;)m=l[--p]%gt,v=l[p]/gt|0,c=Z*m+v*L,m=L*m+c%gt*gt+ot[U]+h,h=(m/pt|0)+(c/gt|0)+Z*v,ot[U--]=m%pt;ot[U]=h}return h?++x:ot.splice(0,1),yt(g,ot,x)},tt.negated=function(){var g=new E(this);return g.s=-g.s||null,g},tt.plus=function(g,s){var h,x=this,T=x.s;if(g=new E(g,s),s=g.s,!T||!s)return new E(NaN);if(T!=s)return g.s=-s,x.minus(g);var U=x.e/w,p=g.e/w,c=x.c,u=g.c;if(!U||!p){if(!c||!u)return new E(T/0);if(!c[0]||!u[0])return u[0]?g:new E(c[0]?x:T*0)}if(U=q(U),p=q(p),c=c.slice(),T=U-p){for(T>0?(p=U,h=u):(T=-T,h=c),h.reverse();T--;h.push(0));h.reverse()}for(T=c.length,s=u.length,T-s<0&&(h=u,u=c,c=h,s=T),T=0;s;)T=(c[--s]=c[s]+u[s]+T)/y|0,c[s]=y===c[s]?0:c[s]%y;return T&&(c=[T].concat(c),++p),yt(g,c,p)},tt.precision=tt.sd=function(g,s){var h,x,T,U=this;if(g!=null&&g!==!!g)return j(g,1,S),s==null?s=I:j(s,0,8),it(new E(U),g,s);if(!(h=U.c))return null;if(T=h.length-1,x=T*w+1,T=h[T]){for(;T%10==0;T/=10,x--);for(T=h[0];T>=10;T/=10,x++);}return g&&U.e+1>x&&(x=U.e+1),x},tt.shiftedBy=function(g){return j(g,-N,N),this.times("1e"+g)},tt.squareRoot=tt.sqrt=function(){var g,s,h,x,T,U=this,p=U.c,c=U.s,u=U.e,m=ut+4,v=new E("0.5");if(c!==1||!p||!p[0])return new E(!c||c<0&&(!p||p[0])?NaN:p?U:1/0);if(c=Math.sqrt(+st(U)),c==0||c==1/0?(s=M(p),(s.length+u)%2==0&&(s+="0"),c=Math.sqrt(+s),u=q((u+1)/2)-(u<0||u%2),c==1/0?s="5e"+u:(s=c.toExponential(),s=s.slice(0,s.indexOf("e")+1)+u),h=new E(s)):h=new E(c+""),h.c[0]){for(u=h.e,c=u+m,c<3&&(c=0);;)if(T=h,h=v.times(T.plus(D(U,T,m,1))),M(T.c).slice(0,c)===(s=M(h.c)).slice(0,c))if(h.e<u&&--c,s=s.slice(c-3,c+1),s=="9999"||!x&&s=="4999"){if(!x&&(it(T,T.e+ut+2,0),T.times(T).eq(U))){h=T;break}m+=4,c+=4,x=1}else{(!+s||!+s.slice(1)&&s.charAt(0)=="5")&&(it(h,h.e+ut+2,1),g=!h.times(h).eq(U));break}}return it(h,h.e+ut+1,I,g)},tt.toExponential=function(g,s){return g!=null&&(j(g,0,S),g++),ct(this,g,s,1)},tt.toFixed=function(g,s){return g!=null&&(j(g,0,S),g=g+this.e+1),ct(this,g,s)},tt.toFormat=function(g,s,h){var x,T=this;if(h==null)g!=null&&s&&typeof s=="object"?(h=s,s=null):g&&typeof g=="object"?(h=g,g=s=null):h=at;else if(typeof h!="object")throw Error(f+"Argument not an object: "+h);if(x=T.toFixed(g,s),T.c){var U,p=x.split("."),c=+h.groupSize,u=+h.secondaryGroupSize,m=h.groupSeparator||"",v=p[0],B=p[1],L=T.s<0,Z=L?v.slice(1):v,ot=Z.length;if(u&&(U=c,c=u,u=U,ot-=U),c>0&&ot>0){for(U=ot%c||c,v=Z.substr(0,U);U<ot;U+=c)v+=m+Z.substr(U,c);u>0&&(v+=m+Z.slice(U)),L&&(v="-"+v)}x=B?v+(h.decimalSeparator||"")+((u=+h.fractionGroupSize)?B.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(h.fractionGroupSeparator||"")):B):v}return(h.prefix||"")+x+(h.suffix||"")},tt.toFraction=function(g){var s,h,x,T,U,p,c,u,m,v,B,L,Z=this,ot=Z.c;if(g!=null&&(c=new E(g),!c.isInteger()&&(c.c||c.s!==1)||c.lt(dt)))throw Error(f+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+st(c));if(!ot)return new E(Z);for(s=new E(dt),m=h=new E(dt),x=u=new E(dt),L=M(ot),U=s.e=L.length-Z.e-1,s.c[0]=A[(p=U%w)<0?w+p:p],g=!g||c.comparedTo(s)>0?U>0?s:m:c,p=G,G=1/0,c=new E(L),u.c[0]=0;v=D(c,s,0,1),T=h.plus(v.times(x)),T.comparedTo(g)!=1;)h=x,x=T,m=u.plus(v.times(T=m)),u=T,s=c.minus(v.times(T=s)),c=T;return T=D(g.minus(h),x,0,1),u=u.plus(T.times(m)),h=h.plus(T.times(x)),u.s=m.s=Z.s,U=U*2,B=D(m,x,U,I).minus(Z).abs().comparedTo(D(u,h,U,I).minus(Z).abs())<1?[m,x]:[u,h],G=p,B},tt.toNumber=function(){return+st(this)},tt.toPrecision=function(g,s){return g!=null&&j(g,1,S),ct(this,g,s,2)},tt.toString=function(g){var s,h=this,x=h.s,T=h.e;return T===null?x?(s="Infinity",x<0&&(s="-"+s)):s="NaN":(g==null?s=T<=F||T>=Y?rt(M(h.c),T):k(M(h.c),T,"0"):g===10&&lt?(h=it(new E(h),ut+T+1,I),s=k(M(h.c),h.e,"0")):(j(g,2,X.length,"Base"),s=J(k(M(h.c),T,"0"),10,g,x,!0)),x<0&&h.c[0]&&(s="-"+s)),s},tt.valueOf=tt.toJSON=function(){return st(this)},tt._isBigNumber=!0,W!=null&&E.set(W),E}function q(W){var D=W|0;return W>0||W===D?D:D-1}function M(W){for(var D,J,nt=1,tt=W.length,dt=W[0]+"";nt<tt;){for(D=W[nt++]+"",J=w-D.length;J--;D="0"+D);dt+=D}for(tt=dt.length;dt.charCodeAt(--tt)===48;);return dt.slice(0,tt+1||1)}function z(W,D){var J,nt,tt=W.c,dt=D.c,ut=W.s,I=D.s,F=W.e,Y=D.e;if(!ut||!I)return null;if(J=tt&&!tt[0],nt=dt&&!dt[0],J||nt)return J?nt?0:-I:ut;if(ut!=I)return ut;if(J=ut<0,nt=F==Y,!tt||!dt)return nt?0:!tt^J?1:-1;if(!nt)return F>Y^J?1:-1;for(I=(F=tt.length)<(Y=dt.length)?F:Y,ut=0;ut<I;ut++)if(tt[ut]!=dt[ut])return tt[ut]>dt[ut]^J?1:-1;return F==Y?0:F>Y^J?1:-1}function j(W,D,J,nt){if(W<D||W>J||W!==a(W))throw Error(f+(nt||"Argument")+(typeof W=="number"?W<D||W>J?" out of range: ":" not an integer: ":" not a primitive number: ")+String(W))}function V(W){var D=W.c.length-1;return q(W.e/w)==D&&W.c[D]%2!=0}function rt(W,D){return(W.length>1?W.charAt(0)+"."+W.slice(1):W)+(D<0?"e":"e+")+D}function k(W,D,J){var nt,tt;if(D<0){for(tt=J+".";++D;tt+=J);W=tt+W}else if(nt=W.length,++D>nt){for(tt=J,D-=nt;--D;tt+=J);W+=tt}else D<nt&&(W=W.slice(0,D)+"."+W.slice(D));return W}r=b(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(rn)})(qc);var ls=qc.exports,rf=function(e,r,n){var i=new e.Uint8Array(n),a=r.pushInt,f=r.pushInt32,o=r.pushInt32Neg,y=r.pushInt64,w=r.pushInt64Neg,N=r.pushFloat,A=r.pushFloatSingle,R=r.pushFloatDouble,S=r.pushTrue,b=r.pushFalse,q=r.pushUndefined,M=r.pushNull,z=r.pushInfinity,j=r.pushInfinityNeg,V=r.pushNaN,rt=r.pushNaNNeg,k=r.pushArrayStart,W=r.pushArrayStartFixed,D=r.pushArrayStartFixed32,J=r.pushArrayStartFixed64,nt=r.pushObjectStart,tt=r.pushObjectStartFixed,dt=r.pushObjectStartFixed32,ut=r.pushObjectStartFixed64,I=r.pushByteString,F=r.pushByteStringStart,Y=r.pushUtf8String,$=r.pushUtf8StringStart,G=r.pushSimpleUnassigned,Q=r.pushTagStart,et=r.pushTagStart4,_t=r.pushTagStart8,at=r.pushTagUnassigned,X=r.pushBreak,lt=e.Math.pow,E=0,ct=0,ft=0;function yt(P){for(P=P|0,E=0,ct=P;(E|0)<(ct|0)&&(ft=xn[i[E]&255](i[E]|0)|0,!((ft|0)>0)););return ft|0}function it(P){return P=P|0,((E|0)+(P|0)|0)<(ct|0)?0:1}function st(P){return P=P|0,i[P|0]<<8|i[P+1|0]|0}function g(P){return P=P|0,i[P|0]<<24|i[P+1|0]<<16|i[P+2|0]<<8|i[P+3|0]|0}function s(P){return P=P|0,a(P|0),E=E+1|0,0}function h(P){return P=P|0,it(1)|0?1:(a(i[E+1|0]|0),E=E+2|0,0)}function x(P){return P=P|0,it(2)|0?1:(a(st(E+1|0)|0),E=E+3|0,0)}function T(P){return P=P|0,it(4)|0?1:(f(st(E+1|0)|0,st(E+3|0)|0),E=E+5|0,0)}function U(P){return P=P|0,it(8)|0?1:(y(st(E+1|0)|0,st(E+3|0)|0,st(E+5|0)|0,st(E+7|0)|0),E=E+9|0,0)}function p(P){return P=P|0,a(-1-(P-32|0)|0),E=E+1|0,0}function c(P){return P=P|0,it(1)|0?1:(a(-1-(i[E+1|0]|0)|0),E=E+2|0,0)}function u(P){P=P|0;var St=0;return it(2)|0?1:(St=st(E+1|0)|0,a(-1-(St|0)|0),E=E+3|0,0)}function m(P){return P=P|0,it(4)|0?1:(o(st(E+1|0)|0,st(E+3|0)|0),E=E+5|0,0)}function v(P){return P=P|0,it(8)|0?1:(w(st(E+1|0)|0,st(E+3|0)|0,st(E+5|0)|0,st(E+7|0)|0),E=E+9|0,0)}function B(P){P=P|0;var St=0,Rt=0,Tt=0;return Tt=P-64|0,it(Tt|0)|0?1:(St=E+1|0,Rt=(E+1|0)+(Tt|0)|0,I(St|0,Rt|0),E=Rt|0,0)}function L(P){P=P|0;var St=0,Rt=0,Tt=0;return it(1)|0||(Tt=i[E+1|0]|0,St=E+2|0,Rt=(E+2|0)+(Tt|0)|0,it(Tt+1|0)|0)?1:(I(St|0,Rt|0),E=Rt|0,0)}function Z(P){P=P|0;var St=0,Rt=0,Tt=0;return it(2)|0||(Tt=st(E+1|0)|0,St=E+3|0,Rt=(E+3|0)+(Tt|0)|0,it(Tt+2|0)|0)?1:(I(St|0,Rt|0),E=Rt|0,0)}function ot(P){P=P|0;var St=0,Rt=0,Tt=0;return it(4)|0||(Tt=g(E+1|0)|0,St=E+5|0,Rt=(E+5|0)+(Tt|0)|0,it(Tt+4|0)|0)?1:(I(St|0,Rt|0),E=Rt|0,0)}function pt(P){return P=P|0,1}function gt(P){return P=P|0,F(),E=E+1|0,0}function _(P){P=P|0;var St=0,Rt=0,Tt=0;return Tt=P-96|0,it(Tt|0)|0?1:(St=E+1|0,Rt=(E+1|0)+(Tt|0)|0,Y(St|0,Rt|0),E=Rt|0,0)}function l(P){P=P|0;var St=0,Rt=0,Tt=0;return it(1)|0||(Tt=i[E+1|0]|0,St=E+2|0,Rt=(E+2|0)+(Tt|0)|0,it(Tt+1|0)|0)?1:(Y(St|0,Rt|0),E=Rt|0,0)}function d(P){P=P|0;var St=0,Rt=0,Tt=0;return it(2)|0||(Tt=st(E+1|0)|0,St=E+3|0,Rt=(E+3|0)+(Tt|0)|0,it(Tt+2|0)|0)?1:(Y(St|0,Rt|0),E=Rt|0,0)}function O(P){P=P|0;var St=0,Rt=0,Tt=0;return it(4)|0||(Tt=g(E+1|0)|0,St=E+5|0,Rt=(E+5|0)+(Tt|0)|0,it(Tt+4|0)|0)?1:(Y(St|0,Rt|0),E=Rt|0,0)}function C(P){return P=P|0,1}function K(P){return P=P|0,$(),E=E+1|0,0}function H(P){return P=P|0,W(P-128|0),E=E+1|0,0}function wt(P){return P=P|0,it(1)|0?1:(W(i[E+1|0]|0),E=E+2|0,0)}function vt(P){return P=P|0,it(2)|0?1:(W(st(E+1|0)|0),E=E+3|0,0)}function xt(P){return P=P|0,it(4)|0?1:(D(st(E+1|0)|0,st(E+3|0)|0),E=E+5|0,0)}function Et(P){return P=P|0,it(8)|0?1:(J(st(E+1|0)|0,st(E+3|0)|0,st(E+5|0)|0,st(E+7|0)|0),E=E+9|0,0)}function At(P){return P=P|0,k(),E=E+1|0,0}function Ut(P){P=P|0;var St=0;return St=P-160|0,it(St|0)|0?1:(tt(St|0),E=E+1|0,0)}function br(P){return P=P|0,it(1)|0?1:(tt(i[E+1|0]|0),E=E+2|0,0)}function Er(P){return P=P|0,it(2)|0?1:(tt(st(E+1|0)|0),E=E+3|0,0)}function xr(P){return P=P|0,it(4)|0?1:(dt(st(E+1|0)|0,st(E+3|0)|0),E=E+5|0,0)}function vr(P){return P=P|0,it(8)|0?1:(ut(st(E+1|0)|0,st(E+3|0)|0,st(E+5|0)|0,st(E+7|0)|0),E=E+9|0,0)}function be(P){return P=P|0,nt(),E=E+1|0,0}function pe(P){return P=P|0,Q(P-192|0|0),E=E+1|0,0}function ti(P){return P=P|0,Q(P|0),E=E+1|0,0}function ei(P){return P=P|0,Q(P|0),E=E+1|0,0}function ri(P){return P=P|0,Q(P|0),E=E+1|0,0}function ni(P){return P=P|0,Q(P|0),E=E+1|0,0}function qt(P){return P=P|0,Q(P-192|0|0),E=E+1|0,0}function ii(P){return P=P|0,Q(P|0),E=E+1|0,0}function si(P){return P=P|0,Q(P|0),E=E+1|0,0}function ai(P){return P=P|0,Q(P|0),E=E+1|0,0}function ln(P){return P=P|0,it(1)|0?1:(Q(i[E+1|0]|0),E=E+2|0,0)}function fn(P){return P=P|0,it(2)|0?1:(Q(st(E+1|0)|0),E=E+3|0,0)}function dn(P){return P=P|0,it(4)|0?1:(et(st(E+1|0)|0,st(E+3|0)|0),E=E+5|0,0)}function hn(P){return P=P|0,it(8)|0?1:(_t(st(E+1|0)|0,st(E+3|0)|0,st(E+5|0)|0,st(E+7|0)|0),E=E+9|0,0)}function Ct(P){return P=P|0,G((P|0)-224|0),E=E+1|0,0}function pn(P){return P=P|0,b(),E=E+1|0,0}function _n(P){return P=P|0,S(),E=E+1|0,0}function yn(P){return P=P|0,M(),E=E+1|0,0}function Nr(P){return P=P|0,q(),E=E+1|0,0}function mn(P){return P=P|0,it(1)|0?1:(G(i[E+1|0]|0),E=E+2|0,0)}function gn(P){P=P|0;var St=0,Rt=0,Tt=1,Xe=0,qe=0,oi=0;return it(2)|0?1:(St=i[E+1|0]|0,Rt=i[E+2|0]|0,(St|0)&128&&(Tt=-1),Xe=+(((St|0)&124)>>2),qe=+(((St|0)&3)<<8|Rt),+Xe==0?N(+(+Tt*5960464477539063e-23*+qe)):+Xe==31?+Tt==1?+qe>0?V():z():+qe>0?rt():j():N(+(+Tt*lt(2,+(+Xe-25))*+(1024+qe))),E=E+3|0,0)}function wn(P){return P=P|0,it(4)|0?1:(A(i[E+1|0]|0,i[E+2|0]|0,i[E+3|0]|0,i[E+4|0]|0),E=E+5|0,0)}function bn(P){return P=P|0,it(8)|0?1:(R(i[E+1|0]|0,i[E+2|0]|0,i[E+3|0]|0,i[E+4|0]|0,i[E+5|0]|0,i[E+6|0]|0,i[E+7|0]|0,i[E+8|0]|0),E=E+9|0,0)}function Bt(P){return P=P|0,1}function En(P){return P=P|0,X(),E=E+1|0,0}var xn=[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,h,x,T,U,Bt,Bt,Bt,Bt,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,c,u,m,v,Bt,Bt,Bt,Bt,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,L,Z,ot,pt,Bt,Bt,Bt,gt,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,l,d,O,C,Bt,Bt,Bt,K,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,wt,vt,xt,Et,Bt,Bt,Bt,At,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,br,Er,xr,vr,Bt,Bt,Bt,be,pe,pe,pe,pe,pe,pe,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,qt,ln,fn,dn,hn,Bt,Bt,Bt,Bt,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,pn,_n,yn,Nr,mn,gn,wn,bn,Bt,Bt,Bt,En];return{parse:yt}},fs={},se={};const Ia=ls.BigNumber;se.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};se.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};se.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};se.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};se.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};se.SHIFT32=Math.pow(2,32);se.SHIFT16=Math.pow(2,16);se.MAX_SAFE_HIGH=2097151;se.NEG_ONE=new Ia(-1);se.TEN=new Ia(10);se.TWO=new Ia(2);se.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(t){const{Buffer:e}=Wn,r=ls.BigNumber,n=se,i=n.SHIFT32,a=n.SHIFT16,f=2097151;t.parseHalf=function(w){var N,A,R;return R=w[0]&128?-1:1,N=(w[0]&124)>>2,A=(w[0]&3)<<8|w[1],N?N===31?R*(A?NaN:1/0):R*Math.pow(2,N-25)*(1024+A):R*5960464477539063e-23*A};function o(y){return y<16?"0"+y.toString(16):y.toString(16)}t.arrayBufferToBignumber=function(y){const w=y.byteLength;let N="";for(let A=0;A<w;A++)N+=o(y[A]);return new r(N,16)},t.buildMap=y=>{const w=new Map,N=Object.keys(y),A=N.length;for(let R=0;R<A;R++)w.set(N[R],y[N[R]]);return w},t.buildInt32=(y,w)=>y*a+w,t.buildInt64=(y,w,N,A)=>{const R=t.buildInt32(y,w),S=t.buildInt32(N,A);return R>f?new r(R).times(i).plus(S):R*i+S},t.writeHalf=function(w,N){const A=e.allocUnsafe(4);A.writeFloatBE(N,0);const R=A.readUInt32BE(0);if(R&8191)return!1;var S=R>>16&32768;const b=R>>23&255,q=R&8388607;if(b>=113&&b<=142)S+=(b-112<<10)+(q>>13);else if(b>=103&&b<113){if(q&(1<<126-b)-1)return!1;S+=q+8388608>>126-b}else return!1;return w.writeUInt16BE(S,0),!0},t.keySorter=function(y,w){var N=y[0].byteLength,A=w[0].byteLength;return N>A?1:A>N?-1:y[0].compare(w[0])},t.isNegativeZero=y=>y===0&&1/y<0,t.nextPowerOf2=y=>{let w=0;if(y&&!(y&y-1))return y;for(;y!==0;)y>>=1,w+=1;return 1<<w}})(fs);const Ba=se,nf=Ba.MT,ci=Ba.SIMPLE,Vs=Ba.SYMS;let sf=class sa{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,nf.SIMPLE_FLOAT)}static isSimple(e){return e instanceof sa}static decode(e,r){switch(r==null&&(r=!0),e){case ci.FALSE:return!1;case ci.TRUE:return!0;case ci.NULL:return r?null:Vs.NULL;case ci.UNDEFINED:return r?void 0:Vs.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return Vs.BREAK;default:return new sa(e)}}};var Dc=sf;let af=class aa{constructor(e,r,n){if(this.tag=e,this.value=r,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var r,n;if(n=e?.[this.tag],typeof n!="function"&&(n=aa["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(aa,this.value)}catch(i){return r=i,this.err=r,this}}};var Lc=af;const Gc=self.location?self.location.protocol+"//"+self.location.host:"",oa=self.URL;let of=class{constructor(e="",r=Gc){this.super=new oa(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function cf(t){if(typeof t=="string")return new oa(t).toString();if(!(t instanceof oa)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",a=t.host||"",f=t.hostname||"",o=t.search||(t.query?"?"+t.query:""),y=t.hash||"",w=t.pathname||"",N=t.path||w+o;return`${i}${e||r}${a||f+n}${N}${y}`}}var jc={URLWithLegacySupport:of,URLSearchParams:self.URLSearchParams,defaultBase:Gc,format:cf};const{URLWithLegacySupport:Wa,format:uf}=jc;var lf=(t,e={},r={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(r[i]||n||i)+":";let a;try{a=new Wa(t)}catch{a={}}const f=Object.assign({},e,{protocol:i||a.protocol,host:e.host||a.host});return new Wa(t,uf(f)).toString()};const{URLWithLegacySupport:ff,format:df,URLSearchParams:hf,defaultBase:pf}=jc,_f=lf;var Hc={URL:ff,URLSearchParams:hf,format:df,relative:_f,defaultBase:pf};const{Buffer:Dr}=Wn,Za=Kn,yf=ls.BigNumber,mf=rf,ae=fs,Vt=se,gf=Dc,wf=Lc,{URL:bf}=Hc;let ca=class ua{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=ae.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Dr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:r=>new Date(r),1:r=>new Date(r*1e3),2:r=>ae.arrayBufferToBignumber(r),3:r=>Vt.NEG_ONE.minus(ae.arrayBufferToBignumber(r)),4:r=>Vt.TEN.pow(r[0]).times(r[1]),5:r=>Vt.TWO.pow(r[0]).times(r[1]),32:r=>new bf(r),35:r=>new RegExp(r)},e.tags),this.parser=mf(rn,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Vt.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Vt.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Vt.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Vt.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Vt.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Vt.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Vt.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,r){const n=this._currentParent;switch(n.values++,n.type){case Vt.PARENT.ARRAY:case Vt.PARENT.BYTE_STRING:case Vt.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Vt.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Vt.PARENT.MAP,n.ref=ae.buildMap(n.ref)));break;case Vt.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Vt.PARENT.TAG:this._ref.push(e),r||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,r,n){this._parents[this._depth]={type:r,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Vt.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,r){const n=this._knownTags[e];return n?n(r):new wf(e,r)}createMap(e,r){return e}createObject(e,r){return e}createArray(e,r){return e}createByteString(e,r){return Dr.concat(e)}createByteStringFromHeap(e,r){return e===r?Dr.alloc(0):Dr.from(this._heap.slice(e,r))}createInt(e){return e}createInt32(e,r){return ae.buildInt32(e,r)}createInt64(e,r,n,i){return ae.buildInt64(e,r,n,i)}createFloat(e){return e}createFloatSingle(e,r,n,i){return Za.read([e,r,n,i],0,!1,23,4)}createFloatDouble(e,r,n,i,a,f,o,y){return Za.read([e,r,n,i,a,f,o,y],0,!1,52,8)}createInt32Neg(e,r){return-1-ae.buildInt32(e,r)}createInt64Neg(e,r,n,i){const a=ae.buildInt32(e,r),f=ae.buildInt32(n,i);return a>Vt.MAX_SAFE_HIGH?Vt.NEG_ONE.minus(new yf(a).times(Vt.SHIFT32).plus(f)):-1-(a*Vt.SHIFT32+f)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,r){return e.join("")}createUtf8StringFromHeap(e,r){return e===r?"":this._buffer.toString("utf8",e,r)}createSimpleUnassigned(e){return new gf(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,r){this._push(this.createInt32(e,r))}pushInt64(e,r,n,i){this._push(this.createInt64(e,r,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,r,n,i){this._push(this.createFloatSingle(e,r,n,i))}pushFloatDouble(e,r,n,i,a,f,o,y){this._push(this.createFloatDouble(e,r,n,i,a,f,o,y))}pushInt32Neg(e,r){this._push(this.createInt32Neg(e,r))}pushInt64Neg(e,r,n,i){this._push(this.createInt64Neg(e,r,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Vt.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,r){const n=ae.buildInt32(e,r);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,r,n,i){const a=ae.buildInt64(e,r,n,i);this._createArrayStartFixed(a)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,r){const n=ae.buildInt32(e,r);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,r,n,i){const a=ae.buildInt64(e,r,n,i);this._createObjectStartFixed(a)}pushByteStringStart(){this._parents[this._depth]={type:Vt.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,r){this._push(this.createByteStringFromHeap(e,r))}pushUtf8StringStart(){this._parents[this._depth]={type:Vt.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,r){this._push(this.createUtf8StringFromHeap(e,r))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Vt.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,r){this.pushTagStart(ae.buildInt32(e,r))}pushTagStart8(e,r,n,i){this.pushTagStart(ae.buildInt64(e,r,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Vt.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Vt.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const r=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(r>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,r){return typeof e=="string"&&(e=Dr.from(e,r||"hex")),new ua({size:e.length}).decodeFirst(e)}static decodeAll(e,r){return typeof e=="string"&&(e=Dr.from(e,r||"hex")),new ua({size:e.length}).decodeAll(e)}};ca.decodeFirst=ca.decode;var Kc=ca;const{Buffer:ks}=Wn,Ef=Kc,xf=fs;class Ua extends Ef{createTag(e,r){return`${e}(${r})`}createInt(e){return super.createInt(e).toString()}createInt32(e,r){return super.createInt32(e,r).toString()}createInt64(e,r,n,i){return super.createInt64(e,r,n,i).toString()}createInt32Neg(e,r){return super.createInt32Neg(e,r).toString()}createInt64Neg(e,r,n,i){return super.createInt64Neg(e,r,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const r=super.createFloat(e);return xf.isNegativeZero(e)?"-0_1":`${r}_1`}createFloatSingle(e,r,n,i){return`${super.createFloatSingle(e,r,n,i)}_2`}createFloatDouble(e,r,n,i,a,f,o,y){return`${super.createFloatDouble(e,r,n,i,a,f,o,y)}_3`}createByteString(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,r){return`h'${ks.from(super.createByteStringFromHeap(e,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,r){const n=super.createArray(e,r);return r===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,r){const n=super.createMap(e),i=Array.from(n.keys()).reduce(Xa(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createObject(e,r){const n=super.createObject(e),i=Object.keys(n).reduce(Xa(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,r){return`"${ks.from(super.createUtf8StringFromHeap(e,r)).toString("utf8")}"`}static diagnose(e,r){return typeof e=="string"&&(e=ks.from(e,r||"hex")),new Ua().decodeFirst(e)}}var vf=Ua;function Xa(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:ke}=Wn,{URL:Nf}=Hc,la=ls.BigNumber,Cs=fs,Zt=se,Ee=Zt.MT,ui=Zt.NUMBYTES,Ja=Zt.SHIFT32,Qa=Zt.SYMS,Lr=Zt.TAG,Tf=Zt.MT.SIMPLE_FLOAT<<5|Zt.NUMBYTES.TWO,Of=Zt.MT.SIMPLE_FLOAT<<5|Zt.NUMBYTES.FOUR,Sf=Zt.MT.SIMPLE_FLOAT<<5|Zt.NUMBYTES.EIGHT,Rf=Zt.MT.SIMPLE_FLOAT<<5|Zt.SIMPLE.TRUE,Af=Zt.MT.SIMPLE_FLOAT<<5|Zt.SIMPLE.FALSE,If=Zt.MT.SIMPLE_FLOAT<<5|Zt.SIMPLE.UNDEFINED,to=Zt.MT.SIMPLE_FLOAT<<5|Zt.SIMPLE.NULL,Bf=new la("0x20000000000000"),Uf=ke.from("f97e00","hex"),Ff=ke.from("f9fc00","hex"),Pf=ke.from("f97c00","hex");function Vf(t){return{}.toString.call(t).slice(8,-1)}class zi{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[Nf,this._pushUrl],[la,this._pushBigNumber]];const r=e.genTypes||[],n=r.length;for(let i=0;i<n;i++)this.addSemanticType(r[i][0],r[i][1]);this._reset()}addSemanticType(e,r){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const f=this.semanticTypes[i][1];return this.semanticTypes[i][1]=r,f}return this.semanticTypes.push([e,r]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,r,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=r,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(Uf)}_pushInfinity(e){const r=e<0?Ff:Pf;return this.push(r)}_pushFloat(e){const r=ke.allocUnsafe(2);if(Cs.writeHalf(r,e)&&Cs.parseHalf(r)===e)return this._pushUInt8(Tf)&&this.push(r);const n=ke.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(Of)&&this.push(n):this._pushUInt8(Sf)&&this._pushDoubleBE(e)}_pushInt(e,r,n){const i=r<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|ui.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|ui.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|ui.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|ui.EIGHT)&&this._pushUInt32BE(Math.floor(e/Ja))&&this._pushUInt32BE(e%Ja):r===Ee.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,Ee.NEG_INT,e):this._pushInt(e,Ee.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const r=ke.byteLength(e,"utf8");return this._pushInt(r,Ee.UTF8_STRING)&&this.pushWrite(e,5,r)}_pushBoolean(e){return this._pushUInt8(e?Rf:Af)}_pushUndefined(e){return this._pushUInt8(If)}_pushArray(e,r){const n=r.length;if(!e._pushInt(n,Ee.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(r[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,Ee.TAG)}_pushDate(e,r){return e._pushTag(Lr.DATE_EPOCH)&&e.pushAny(Math.round(r/1e3))}_pushBuffer(e,r){return e._pushInt(r.length,Ee.BYTE_STRING)&&e.push(r)}_pushNoFilter(e,r){return e._pushBuffer(e,r.slice())}_pushRegexp(e,r){return e._pushTag(Lr.REGEXP)&&e.pushAny(r.source)}_pushSet(e,r){if(!e._pushInt(r.size,Ee.ARRAY))return!1;for(const n of r)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,r){return e._pushTag(Lr.URI)&&e.pushAny(r.format())}_pushBigint(e){let r=Lr.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),r=Lr.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=ke.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(e,r){if(r.isNaN())return e._pushNaN();if(!r.isFinite())return e._pushInfinity(r.isNegative()?-1/0:1/0);if(r.isInteger())return e._pushBigint(r);if(!(e._pushTag(Lr.DECIMAL_FRAC)&&e._pushInt(2,Ee.ARRAY)))return!1;const n=r.decimalPlaces(),i=r.multipliedBy(new la(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(Bf)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,r){return e._pushInt(r.size,Ee.MAP)?this._pushRawMap(r.size,Array.from(r)):!1}_pushObject(e){if(!e)return this._pushUInt8(to);for(var r=this.semanticTypes.length,n=0;n<r;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var a=Object.keys(e),f=a.length;return this._pushInt(f,Ee.MAP)?this._pushRawMap(f,a.map(o=>[o,e[o]])):!1}_pushRawMap(e,r){r=r.map(function(i){return i[0]=zi.encode(i[0]),i}).sort(Cs.keySorter);for(var n=0;n<e;n++)if(!this.push(r[n][0])||!this.pushAny(r[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var r=Vf(e);switch(r){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,ke.isBuffer(e)?e:ke.from(e));case"Null":return this._pushUInt8(to);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case Qa.NULL:return this._pushObject(null);case Qa.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,a=0,f=0;f<i;f++)a+=r[f];var o=ke.allocUnsafe(a),y=0,w=0;for(f=0;f<i;f++){switch(w=r[f],n[f]){case 0:e[f].copy(o,y);break;case 1:o.writeUInt8(e[f],y,!0);break;case 2:o.writeUInt16BE(e[f],y,!0);break;case 3:o.writeUInt32BE(e[f],y,!0);break;case 4:o.writeDoubleBE(e[f],y,!0);break;case 5:o.write(e[f],y,w,"utf8");break;default:throw new Error("unkown method")}y+=w}var N=o;return this._reset(),N}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const r=new zi;if(!r.pushAny(e))throw new Error("Failed to encode input");return r.finalize()}}var kf=zi;(function(t){t.Diagnose=vf,t.Decoder=Kc,t.Encoder=kf,t.Simple=Dc,t.Tagged=Lc,t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}})($c);const zc=ul($c);function Se(t){return Un(Ta.create().update(new Uint8Array(t)).digest())}function Ei(t){if(t instanceof zc.Tagged)return Ei(t.value);if(typeof t=="string")return Yc(t);if(typeof t=="number")return Se(jt(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return Se(t);if(Array.isArray(t)){const e=t.map(Ei);return Se(Re(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return Se(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return Ei(t.toHash());if(typeof t=="object")return Yi(t);if(typeof t=="bigint")return Se(jt(t))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const Yc=t=>{const e=new TextEncoder().encode(t);return Se(e)};function Mn(t){return Yi(t)}function Yi(t){const n=Object.entries(t).filter(([,f])=>f!==void 0).map(([f,o])=>{const y=Yc(f),w=Ei(o);return[y,w]}).sort(([f],[o])=>Qo(f,o)),i=Re(...n.map(f=>Re(...f)));return Se(i)}var Cf=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const Mf=new TextEncoder().encode(`
ic-request`);class Fa{getPrincipal(){return this._principal||(this._principal=Nt.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:r}=e,n=Cf(e,["body"]),i=Mn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Re(Mf,i))}})}}class $n{getPrincipal(){return Nt.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var de={},un={},kt={};Object.defineProperty(kt,"__esModule",{value:!0});const $f=9007199254740992;function Ze(t,...e){const r=new Uint8Array(t.byteLength+e.reduce((i,a)=>i+a.byteLength,0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const i of e)r.set(new Uint8Array(i),n),n+=i.byteLength;return r.buffer}function Ae(t,e,r){r=r.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);r=r.slice(-n*2).padStart(n*2,"0");const i=[(t<<5)+e].concat(r.match(/../g).map(a=>parseInt(a,16)));return new Uint8Array(i).buffer}function ds(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;{const r=e<=255?24:e<=65535?25:e<=4294967295?26:27;return Ae(t,r,e.toString(16))}}function Wc(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=(n&1023)<<10|t.charCodeAt(r)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Ze(new Uint8Array(ds(3,t.length)),new Uint8Array(e))}function qf(t,e){if(t==14277111)return Ze(new Uint8Array([217,217,247]),e);if(t<24)return Ze(new Uint8Array([192+t]),e);{const r=t<=255?24:t<=65535?25:t<=4294967295?26:27,n=2**(r-24),i=t.toString(16).slice(-n*2).padStart(n*2,"0"),a=[192+r].concat(i.match(/../g).map(f=>parseInt(f,16)));return new Uint8Array(a).buffer}}kt.tagged=qf;function Zn(t){return new Uint8Array(t).buffer}kt.raw=Zn;function Pa(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);const e=[0+t];return new Uint8Array(e).buffer}kt.uSmall=Pa;function Zc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),255),t=t.toString(16),Ae(0,24,t)}kt.u8=Zc;function Xc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),65535),t=t.toString(16),Ae(0,25,t)}kt.u16=Xc;function Jc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),4294967295),t=t.toString(16),Ae(0,26,t)}kt.u32=Jc;function Va(t,e){if(typeof t=="string"&&e==16){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Ae(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),$f),t=t.toString(16),Ae(0,27,t)}kt.u64=Va;function Qc(t){if(isNaN(t))throw new RangeError("Invalid number.");if(t===0)return Pa(0);t=Math.min(Math.max(0,-t),24)-1;const e=[32+t];return new Uint8Array(e).buffer}kt.iSmall=Qc;function tu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),255),t=t.toString(16),Ae(1,24,t)}kt.i8=tu;function eu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),65535),t=t.toString(16),Ae(1,25,t)}kt.i16=eu;function ru(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),4294967295),t=t.toString(16),Ae(1,26,t)}kt.i32=ru;function nu(t,e){if(typeof t=="string"&&e==16){if(t.startsWith("-")?t=t.slice(1):t="0",t.match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let r=!1,n=t.split("").reduceRight((i,a)=>{if(r)return a+i;let f=parseInt(a,16)-1;return f>=0?(r=!0,f.toString(16)+i):"f"+i},"");return r?Ae(1,27,n):Va(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),9007199254740992),t=t.toString(16),Ae(1,27,t)}kt.i64=nu;function Df(t){return t>=0?t<24?Pa(t):t<=255?Zc(t):t<=65535?Xc(t):t<=4294967295?Jc(t):Va(t):t>=-24?Qc(t):t>=-255?tu(t):t>=-65535?eu(t):t>=-4294967295?ru(t):nu(t)}kt.number=Df;function Lf(t){return Ze(ds(2,t.byteLength),t)}kt.bytes=Lf;function Gf(t){return Wc(t)}kt.string=Gf;function jf(t){return Ze(ds(4,t.length),...t)}kt.array=jf;function Hf(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort(([n],[i])=>n.localeCompare(i))),Ze(ds(5,t.size),...r.map(([n,i])=>Ze(Wc(n),i)))}kt.map=Hf;function Kf(t){const e=new Float32Array([t]);return Ze(new Uint8Array([250]),new Uint8Array(e.buffer))}kt.singleFloat=Kf;function zf(t){const e=new Float64Array([t]);return Ze(new Uint8Array([251]),new Uint8Array(e.buffer))}kt.doubleFloat=zf;function Yf(t){return t?iu():su()}kt.bool=Yf;function iu(){return Zn(new Uint8Array([245]))}kt.true_=iu;function su(){return Zn(new Uint8Array([244]))}kt.false_=su;function Wf(){return Zn(new Uint8Array([246]))}kt.null_=Wf;function Zf(){return Zn(new Uint8Array([247]))}kt.undefined_=Zf;var Xf=rn&&rn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(un,"__esModule",{value:!0});const ve=Xf(kt),Jf=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class au{constructor(e,r=!1){this._serializer=e,this._stable=r,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return ve.undefined_();case"boolean":return ve.bool(e);case"number":return Math.floor(e)===e?ve.number(e):ve.doubleFloat(e);case"string":return ve.string(e);case"object":if(e===null)return ve.null_();if(Array.isArray(e))return ve.array(e.map(r=>this._serializer.serializeValue(r)));if(Jf.find(r=>e instanceof r))return ve.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const r=new Map;for(const[n,i]of e.entries())r.set(n,this._serializer.serializeValue(i));return ve.map(r,this._stable)}else{const r=new Map;for(const[n,i]of Object.entries(e))r.set(n,this._serializer.serializeValue(i));return ve.map(r,this._stable)}default:throw new Error("Invalid value.")}}}un.JsonDefaultCborEncoder=au;class ou{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}un.ToCborEncoder=ou;class cu{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const r=new this;return r.addEncoder(new au(r,e)),r.addEncoder(new ou),r}removeEncoder(e){for(const r of this._encoders.values())r.name==e&&this._encoders.delete(r)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let r=null;for(const n of this._encoders)(!r||n.priority>r.priority)&&n.match(e)&&(r=n);if(r===null)throw new Error("Could not find an encoder for value.");return r}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}un.CborSerializer=cu;class Qf extends cu{serialize(e){return ve.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}un.SelfDescribeCborSerializer=Qf;(function(t){function e(i){for(var a in i)t.hasOwnProperty(a)||(t[a]=i[a])}var r=rn&&rn.__importStar||function(i){if(i&&i.__esModule)return i;var a={};if(i!=null)for(var f in i)Object.hasOwnProperty.call(i,f)&&(a[f]=i[f]);return a.default=i,a};Object.defineProperty(t,"__esModule",{value:!0}),e(un);const n=r(kt);t.value=n})(de);class td{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return de.value.bytes(e.toUint8Array())}}class ed{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return de.value.bytes(new Uint8Array(e))}}class rd{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?de.value.tagged(2,de.value.bytes(We(e.toString(16)))):de.value.tagged(3,de.value.bytes(We((BigInt("-1")*e).toString(16))))}}const hs=de.SelfDescribeCborSerializer.withDefaultEncoders(!0);hs.addEncoder(new td);hs.addEncoder(new ed);hs.addEncoder(new rd);var fa;(function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"})(fa||(fa={}));function Ms(t){return hs.serialize(t)}function eo(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}class nd extends zc.Decoder{createByteString(e){return Re(...e)}createByteStringFromHeap(e,r){return e===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,r))}}function ze(t){const e=new Uint8Array(t),r=new nd({size:e.byteLength,tags:{2:n=>eo(n),3:n=>-eo(n),[fa.Semantic]:n=>n}});try{return r.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${Mt(e)}`)}}const li=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var da;(function(t){t.Call="call"})(da||(da={}));function ha(){const t=new ArrayBuffer(16),e=new DataView(t),r=li(),n=li(),i=li(),a=li();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,a),t}const ro=BigInt(1e6),id=60*1e3;class fi{constructor(e){if(e<90*1e3){const o=BigInt(Date.now()+e)*ro/BigInt(1e9);this._value=o*BigInt(1e9);return}const a=BigInt(Math.floor(Date.now()+e-id))*ro/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=a}toCBOR(){return de.value.u64(this._value.toString(16),16)}toHash(){return jt(this._value)}}function no(t=ha){return async e=>{const r=e.request.headers;e.request.headers=r,e.endpoint==="call"&&(e.body.nonce=t())}}function On(t){const e=[];return t.forEach((r,n)=>{e.push([n,r])}),e}class $s extends Gt{constructor(e,r){super(e),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class sd extends Gt{constructor(e,r,n,i,a,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=f,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class ad extends Gt{constructor(e,r,n,i,a,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=f,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class od extends Gt{constructor(e,r,n,i,a,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=f,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const uu=BigInt(0),ka=BigInt(1),cd=BigInt(2);function ps(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function mr(t){if(!ps(t))throw new Error("Uint8Array expected")}function Fn(t,e){if(typeof e!="boolean")throw new Error(`${t} must be valid boolean, got "${e}".`)}const ud=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Cr(t){mr(t);let e="";for(let r=0;r<t.length;r++)e+=ud[t[r]];return e}function lu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const De={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function io(t){if(t>=De._0&&t<=De._9)return t-De._0;if(t>=De._A&&t<=De._F)return t-(De._A-10);if(t>=De._a&&t<=De._f)return t-(De._a-10)}function fu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,a=0;i<r;i++,a+=2){const f=io(t.charCodeAt(a)),o=io(t.charCodeAt(a+1));if(f===void 0||o===void 0){const y=t[a]+t[a+1];throw new Error('hex string expected, got non-hex character "'+y+'" at index '+a)}n[i]=f*16+o}return n}function Oe(t){return lu(Cr(t))}function Pn(t){return mr(t),lu(Cr(Uint8Array.from(t).reverse()))}function ee(t,e){return fu(t.toString(16).padStart(e*2,"0"))}function Wi(t,e){return ee(t,e).reverse()}function fe(t,e,r){let n;if(typeof e=="string")try{n=fu(e)}catch(a){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${a}`)}else if(ps(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function zt(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];mr(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const a=t[n];r.set(a,i),i+=a.length}return r}function Ca(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}const qs=t=>typeof t=="bigint"&&uu<=t;function du(t,e,r){return qs(t)&&qs(e)&&qs(r)&&e<=t&&t<r}function fr(t,e,r,n){if(!du(e,r,n))throw new Error(`expected valid ${t}: ${r} <= n < ${n}, got ${typeof e} ${e}`)}function Vn(t){let e;for(e=0;t>uu;t>>=ka,e+=1);return e}function ld(t,e){return t>>BigInt(e)&ka}const xi=t=>(cd<<BigInt(t-1))-ka,fd={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ps(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Xn(t,e,r={}){const n=(i,a,f)=>{const o=fd[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);const y=t[i];if(!(f&&y===void 0)&&!o(y,t))throw new Error(`Invalid param ${String(i)}=${y} (${typeof y}), expected ${a}`)};for(const[i,a]of Object.entries(e))n(i,a,!1);for(const[i,a]of Object.entries(r))n(i,a,!0);return t}const so=()=>{throw new Error("not implemented")};function qn(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const a=t(r,...n);return e.set(r,a),a}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qt=BigInt(0),$t=BigInt(1),dr=BigInt(2),dd=BigInt(3),pa=BigInt(4),ao=BigInt(5),oo=BigInt(8);BigInt(9);BigInt(16);function Lt(t,e){const r=t%e;return r>=Qt?r:e+r}function hd(t,e,r){if(r<=Qt||e<Qt)throw new Error("Expected power/modulo > 0");if(r===$t)return Qt;let n=$t;for(;e>Qt;)e&$t&&(n=n*t%r),t=t*t%r,e>>=$t;return n}function Be(t,e,r){let n=t;for(;e-- >Qt;)n*=n,n%=r;return n}function co(t,e){if(t===Qt||e<=Qt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Lt(t,e),n=e,i=Qt,a=$t;for(;r!==Qt;){const o=n/r,y=n%r,w=i-a*o;n=r,r=y,i=a,a=w}if(n!==$t)throw new Error("invert: does not exist");return Lt(i,e)}function pd(t){const e=(t-$t)/dr;let r,n,i;for(r=t-$t,n=0;r%dr===Qt;r/=dr,n++);for(i=dr;i<t&&hd(i,e,t)!==t-$t;i++);if(n===1){const f=(t+$t)/pa;return function(y,w){const N=y.pow(w,f);if(!y.eql(y.sqr(N),w))throw new Error("Cannot find square root");return N}}const a=(r+$t)/dr;return function(o,y){if(o.pow(y,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let w=n,N=o.pow(o.mul(o.ONE,i),r),A=o.pow(y,a),R=o.pow(y,r);for(;!o.eql(R,o.ONE);){if(o.eql(R,o.ZERO))return o.ZERO;let S=1;for(let q=o.sqr(R);S<w&&!o.eql(q,o.ONE);S++)q=o.sqr(q);const b=o.pow(N,$t<<BigInt(w-S-1));N=o.sqr(b),A=o.mul(A,b),R=o.mul(R,N),w=S}return A}}function _d(t){if(t%pa===dd){const e=(t+$t)/pa;return function(n,i){const a=n.pow(i,e);if(!n.eql(n.sqr(a),i))throw new Error("Cannot find square root");return a}}if(t%oo===ao){const e=(t-ao)/oo;return function(n,i){const a=n.mul(i,dr),f=n.pow(a,e),o=n.mul(i,f),y=n.mul(n.mul(o,dr),f),w=n.mul(o,n.sub(y,n.ONE));if(!n.eql(n.sqr(w),i))throw new Error("Cannot find square root");return w}}return pd(t)}const yd=(t,e)=>(Lt(t,e)&$t)===$t,md=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hu(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=md.reduce((n,i)=>(n[i]="function",n),e);return Xn(t,r)}function vi(t,e,r){if(r<Qt)throw new Error("Expected power > 0");if(r===Qt)return t.ONE;if(r===$t)return e;let n=t.ONE,i=e;for(;r>Qt;)r&$t&&(n=t.mul(n,i)),i=t.sqr(i),r>>=$t;return n}function Ni(t,e){const r=new Array(e.length),n=e.reduce((a,f,o)=>t.is0(f)?a:(r[o]=a,t.mul(a,f)),t.ONE),i=t.inv(n);return e.reduceRight((a,f,o)=>t.is0(f)?a:(r[o]=t.mul(a,r[o]),t.mul(a,f)),i),r}function gd(t){const e=(t-$t)/dr;return(r,n)=>r.pow(n,e)}function pu(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Jn(t,e,r=!1,n={}){if(t<=Qt)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:a}=pu(t,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const f=_d(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:a,MASK:xi(i),ZERO:Qt,ONE:$t,create:y=>Lt(y,t),isValid:y=>{if(typeof y!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof y}`);return Qt<=y&&y<t},is0:y=>y===Qt,isOdd:y=>(y&$t)===$t,neg:y=>Lt(-y,t),eql:(y,w)=>y===w,sqr:y=>Lt(y*y,t),add:(y,w)=>Lt(y+w,t),sub:(y,w)=>Lt(y-w,t),mul:(y,w)=>Lt(y*w,t),pow:(y,w)=>vi(o,y,w),div:(y,w)=>Lt(y*co(w,t),t),sqrN:y=>y*y,addN:(y,w)=>y+w,subN:(y,w)=>y-w,mulN:(y,w)=>y*w,inv:y=>co(y,t),sqrt:n.sqrt||(y=>f(o,y)),invertBatch:y=>Ni(o,y),cmov:(y,w,N)=>N?w:y,toBytes:y=>r?Wi(y,a):ee(y,a),fromBytes:y=>{if(y.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${y.length}`);return r?Pn(y):Oe(y)}});return Object.freeze(o)}function _u(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function yu(t){const e=_u(t);return e+Math.ceil(e/2)}function wd(t,e,r=!1){const n=t.length,i=_u(e),a=yu(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const f=r?Oe(t):Pn(t),o=Lt(f,e-$t)+$t;return r?Wi(o,i):ee(o,i)}const bd=Oe;function or(t,e){if(Dn(t),Dn(e),t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function Ed(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function Dn(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function xd(t,e,r,n){mr(t),mr(e),Dn(r),e.length>255&&(e=n(zt(Ca("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:a}=n,f=Math.ceil(r/i);if(r>65535||f>255)throw new Error("expand_message_xmd: invalid lenInBytes");const o=zt(e,or(e.length,1)),y=or(0,a),w=or(r,2),N=new Array(f),A=n(zt(y,t,w,or(0,1),o));N[0]=n(zt(A,or(1,1),o));for(let S=1;S<=f;S++){const b=[Ed(A,N[S-1]),or(S+1,1),o];N[S]=n(zt(...b))}return zt(...N).slice(0,r)}function vd(t,e,r,n,i){if(mr(t),mr(e),Dn(r),e.length>255){const a=Math.ceil(2*n/8);e=i.create({dkLen:a}).update(Ca("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(or(r,2)).update(e).update(or(e.length,1)).digest()}function uo(t,e,r){Xn(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:a,hash:f,expand:o,DST:y}=r;mr(t),Dn(e);const w=typeof y=="string"?Ca(y):y,N=n.toString(2).length,A=Math.ceil((N+i)/8),R=e*a*A;let S;if(o==="xmd")S=xd(t,w,R,f);else if(o==="xof")S=vd(t,w,R,i,f);else if(o==="_internal_pass")S=t;else throw new Error('expand must be "xmd" or "xof"');const b=new Array(e);for(let q=0;q<e;q++){const M=new Array(a);for(let z=0;z<a;z++){const j=A*(z+q*a),V=S.subarray(j,j+A);M[z]=Lt(bd(V),n)}b[q]=M}return b}function mu(t,e){const r=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[a,f,o,y]=r.map(w=>w.reduce((N,A)=>t.add(t.mul(N,n),A)));return n=t.div(a,f),i=t.mul(i,t.div(o,y)),{x:n,y:i}}}function lo(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const a=uo(n,2,{...r,DST:r.DST,...i}),f=t.fromAffine(e(a[0])),o=t.fromAffine(e(a[1])),y=f.add(o).clearCofactor();return y.assertValidity(),y},encodeToCurve(n,i){const a=uo(n,1,{...r,DST:r.encodeDST,...i}),f=t.fromAffine(e(a[0])).clearCofactor();return f.assertValidity(),f},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const a of n)if(typeof a!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${a} in array`);const i=t.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nd=BigInt(0),Ds=BigInt(1),Ls=new WeakMap,fo=new WeakMap;function gu(t,e){const r=(a,f)=>{const o=f.negate();return a?o:f},n=a=>{if(!Number.isSafeInteger(a)||a<=0||a>e)throw new Error(`Wrong window size=${a}, should be [1..${e}]`)},i=a=>{n(a);const f=Math.ceil(e/a)+1,o=2**(a-1);return{windows:f,windowSize:o}};return{constTimeNegate:r,unsafeLadder(a,f){let o=t.ZERO,y=a;for(;f>Nd;)f&Ds&&(o=o.add(y)),y=y.double(),f>>=Ds;return o},precomputeWindow(a,f){const{windows:o,windowSize:y}=i(f),w=[];let N=a,A=N;for(let R=0;R<o;R++){A=N,w.push(A);for(let S=1;S<y;S++)A=A.add(N),w.push(A);N=A.double()}return w},wNAF(a,f,o){const{windows:y,windowSize:w}=i(a);let N=t.ZERO,A=t.BASE;const R=BigInt(2**a-1),S=2**a,b=BigInt(a);for(let q=0;q<y;q++){const M=q*w;let z=Number(o&R);o>>=b,z>w&&(z-=S,o+=Ds);const j=M,V=M+Math.abs(z)-1,rt=q%2!==0,k=z<0;z===0?A=A.add(r(rt,f[j])):N=N.add(r(k,f[V]))}return{p:N,f:A}},wNAFCached(a,f,o){const y=fo.get(a)||1;let w=Ls.get(a);return w||(w=this.precomputeWindow(a,y),y!==1&&Ls.set(a,o(w))),this.wNAF(y,w,f)},setWindowSize(a,f){n(f),fo.set(a,f),Ls.delete(a)}}}function wu(t,e,r,n){if(!Array.isArray(r)||!Array.isArray(n)||n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");n.forEach((N,A)=>{if(!e.isValid(N))throw new Error(`wrong scalar at index ${A}`)}),r.forEach((N,A)=>{if(!(N instanceof t))throw new Error(`wrong point at index ${A}`)});const i=Vn(BigInt(r.length)),a=i>12?i-3:i>4?i-2:i?2:1,f=(1<<a)-1,o=new Array(f+1).fill(t.ZERO),y=Math.floor((e.BITS-1)/a)*a;let w=t.ZERO;for(let N=y;N>=0;N-=a){o.fill(t.ZERO);for(let R=0;R<n.length;R++){const S=n[R],b=Number(S>>BigInt(N)&BigInt(f));o[b]=o[b].add(r[R])}let A=t.ZERO;for(let R=o.length-1,S=t.ZERO;R>0;R--)S=S.add(o[R]),A=A.add(S);if(w=w.add(A),N!==0)for(let R=0;R<a;R++)w=w.double()}return w}function bu(t){return hu(t.Fp),Xn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...pu(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Td(t){const e=bu(t);Xn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const Ir=BigInt(0),Ht=BigInt(1),tr=BigInt(2),Zi=BigInt(3),ho=BigInt(4);function po(t){const e=Td(t),{Fp:r}=e,n=Jn(e.n,e.nBitLength),i=e.toBytes||((q,M,z)=>{const j=M.toAffine();return zt(Uint8Array.from([4]),r.toBytes(j.x),r.toBytes(j.y))}),a=e.fromBytes||(q=>{const M=q.subarray(1),z=r.fromBytes(M.subarray(0,r.BYTES)),j=r.fromBytes(M.subarray(r.BYTES,2*r.BYTES));return{x:z,y:j}});function f(q){const{a:M,b:z}=e,j=r.sqr(q),V=r.mul(j,q);return r.add(r.add(V,r.mul(q,M)),z)}if(!r.eql(r.sqr(e.Gy),f(e.Gx)))throw new Error("bad generator point: equation left != right");function o(q){return du(q,Ht,e.n)}function y(q){const{allowedPrivateKeyLengths:M,nByteLength:z,wrapPrivateKey:j,n:V}=e;if(M&&typeof q!="bigint"){if(ps(q)&&(q=Cr(q)),typeof q!="string"||!M.includes(q.length))throw new Error("Invalid key");q=q.padStart(z*2,"0")}let rt;try{rt=typeof q=="bigint"?q:Oe(fe("private key",q,z))}catch{throw new Error(`private key must be ${z} bytes, hex or bigint, not ${typeof q}`)}return j&&(rt=Lt(rt,V)),fr("private key",rt,Ht,V),rt}function w(q){if(!(q instanceof R))throw new Error("ProjectivePoint expected")}const N=qn((q,M)=>{const{px:z,py:j,pz:V}=q;if(r.eql(V,r.ONE))return{x:z,y:j};const rt=q.is0();M==null&&(M=rt?r.ONE:r.inv(V));const k=r.mul(z,M),W=r.mul(j,M),D=r.mul(V,M);if(rt)return{x:r.ZERO,y:r.ZERO};if(!r.eql(D,r.ONE))throw new Error("invZ was invalid");return{x:k,y:W}}),A=qn(q=>{if(q.is0()){if(e.allowInfinityPoint&&!r.is0(q.py))return;throw new Error("bad point: ZERO")}const{x:M,y:z}=q.toAffine();if(!r.isValid(M)||!r.isValid(z))throw new Error("bad point: x or y not FE");const j=r.sqr(z),V=f(M);if(!r.eql(j,V))throw new Error("bad point: equation left != right");if(!q.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class R{constructor(M,z,j){if(this.px=M,this.py=z,this.pz=j,M==null||!r.isValid(M))throw new Error("x required");if(z==null||!r.isValid(z))throw new Error("y required");if(j==null||!r.isValid(j))throw new Error("z required");Object.freeze(this)}static fromAffine(M){const{x:z,y:j}=M||{};if(!M||!r.isValid(z)||!r.isValid(j))throw new Error("invalid affine point");if(M instanceof R)throw new Error("projective point not allowed");const V=rt=>r.eql(rt,r.ZERO);return V(z)&&V(j)?R.ZERO:new R(z,j,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(M){const z=r.invertBatch(M.map(j=>j.pz));return M.map((j,V)=>j.toAffine(z[V])).map(R.fromAffine)}static fromHex(M){const z=R.fromAffine(a(fe("pointHex",M)));return z.assertValidity(),z}static fromPrivateKey(M){return R.BASE.multiply(y(M))}static msm(M,z){return wu(R,n,M,z)}_setWindowSize(M){b.setWindowSize(this,M)}assertValidity(){A(this)}hasEvenY(){const{y:M}=this.toAffine();if(r.isOdd)return!r.isOdd(M);throw new Error("Field doesn't support isOdd")}equals(M){w(M);const{px:z,py:j,pz:V}=this,{px:rt,py:k,pz:W}=M,D=r.eql(r.mul(z,W),r.mul(rt,V)),J=r.eql(r.mul(j,W),r.mul(k,V));return D&&J}negate(){return new R(this.px,r.neg(this.py),this.pz)}double(){const{a:M,b:z}=e,j=r.mul(z,Zi),{px:V,py:rt,pz:k}=this;let W=r.ZERO,D=r.ZERO,J=r.ZERO,nt=r.mul(V,V),tt=r.mul(rt,rt),dt=r.mul(k,k),ut=r.mul(V,rt);return ut=r.add(ut,ut),J=r.mul(V,k),J=r.add(J,J),W=r.mul(M,J),D=r.mul(j,dt),D=r.add(W,D),W=r.sub(tt,D),D=r.add(tt,D),D=r.mul(W,D),W=r.mul(ut,W),J=r.mul(j,J),dt=r.mul(M,dt),ut=r.sub(nt,dt),ut=r.mul(M,ut),ut=r.add(ut,J),J=r.add(nt,nt),nt=r.add(J,nt),nt=r.add(nt,dt),nt=r.mul(nt,ut),D=r.add(D,nt),dt=r.mul(rt,k),dt=r.add(dt,dt),nt=r.mul(dt,ut),W=r.sub(W,nt),J=r.mul(dt,tt),J=r.add(J,J),J=r.add(J,J),new R(W,D,J)}add(M){w(M);const{px:z,py:j,pz:V}=this,{px:rt,py:k,pz:W}=M;let D=r.ZERO,J=r.ZERO,nt=r.ZERO;const tt=e.a,dt=r.mul(e.b,Zi);let ut=r.mul(z,rt),I=r.mul(j,k),F=r.mul(V,W),Y=r.add(z,j),$=r.add(rt,k);Y=r.mul(Y,$),$=r.add(ut,I),Y=r.sub(Y,$),$=r.add(z,V);let G=r.add(rt,W);return $=r.mul($,G),G=r.add(ut,F),$=r.sub($,G),G=r.add(j,V),D=r.add(k,W),G=r.mul(G,D),D=r.add(I,F),G=r.sub(G,D),nt=r.mul(tt,$),D=r.mul(dt,F),nt=r.add(D,nt),D=r.sub(I,nt),nt=r.add(I,nt),J=r.mul(D,nt),I=r.add(ut,ut),I=r.add(I,ut),F=r.mul(tt,F),$=r.mul(dt,$),I=r.add(I,F),F=r.sub(ut,F),F=r.mul(tt,F),$=r.add($,F),ut=r.mul(I,$),J=r.add(J,ut),ut=r.mul(G,$),D=r.mul(Y,D),D=r.sub(D,ut),ut=r.mul(Y,I),nt=r.mul(G,nt),nt=r.add(nt,ut),new R(D,J,nt)}subtract(M){return this.add(M.negate())}is0(){return this.equals(R.ZERO)}wNAF(M){return b.wNAFCached(this,M,R.normalizeZ)}multiplyUnsafe(M){fr("scalar",M,Ir,e.n);const z=R.ZERO;if(M===Ir)return z;if(M===Ht)return this;const{endo:j}=e;if(!j)return b.unsafeLadder(this,M);let{k1neg:V,k1:rt,k2neg:k,k2:W}=j.splitScalar(M),D=z,J=z,nt=this;for(;rt>Ir||W>Ir;)rt&Ht&&(D=D.add(nt)),W&Ht&&(J=J.add(nt)),nt=nt.double(),rt>>=Ht,W>>=Ht;return V&&(D=D.negate()),k&&(J=J.negate()),J=new R(r.mul(J.px,j.beta),J.py,J.pz),D.add(J)}multiply(M){const{endo:z,n:j}=e;fr("scalar",M,Ht,j);let V,rt;if(z){const{k1neg:k,k1:W,k2neg:D,k2:J}=z.splitScalar(M);let{p:nt,f:tt}=this.wNAF(W),{p:dt,f:ut}=this.wNAF(J);nt=b.constTimeNegate(k,nt),dt=b.constTimeNegate(D,dt),dt=new R(r.mul(dt.px,z.beta),dt.py,dt.pz),V=nt.add(dt),rt=tt.add(ut)}else{const{p:k,f:W}=this.wNAF(M);V=k,rt=W}return R.normalizeZ([V,rt])[0]}multiplyAndAddUnsafe(M,z,j){const V=R.BASE,rt=(W,D)=>D===Ir||D===Ht||!W.equals(V)?W.multiplyUnsafe(D):W.multiply(D),k=rt(this,z).add(rt(M,j));return k.is0()?void 0:k}toAffine(M){return N(this,M)}isTorsionFree(){const{h:M,isTorsionFree:z}=e;if(M===Ht)return!0;if(z)return z(R,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:M,clearCofactor:z}=e;return M===Ht?this:z?z(R,this):this.multiplyUnsafe(e.h)}toRawBytes(M=!0){return Fn("isCompressed",M),this.assertValidity(),i(R,this,M)}toHex(M=!0){return Fn("isCompressed",M),Cr(this.toRawBytes(M))}}R.BASE=new R(e.Gx,e.Gy,r.ONE),R.ZERO=new R(r.ZERO,r.ONE,r.ZERO);const S=e.nBitLength,b=gu(R,e.endo?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:R,normPrivateKeyToScalar:y,weierstrassEquation:f,isWithinCurveOrder:o}}function Od(t,e){const r=t.ORDER;let n=Ir;for(let b=r-Ht;b%tr===Ir;b/=tr)n+=Ht;const i=n,a=tr<<i-Ht-Ht,f=a*tr,o=(r-Ht)/f,y=(o-Ht)/tr,w=f-Ht,N=a,A=t.pow(e,o),R=t.pow(e,(o+Ht)/tr);let S=(b,q)=>{let M=A,z=t.pow(q,w),j=t.sqr(z);j=t.mul(j,q);let V=t.mul(b,j);V=t.pow(V,y),V=t.mul(V,z),z=t.mul(V,q),j=t.mul(V,b);let rt=t.mul(j,z);V=t.pow(rt,N);let k=t.eql(V,t.ONE);z=t.mul(j,R),V=t.mul(rt,M),j=t.cmov(z,j,k),rt=t.cmov(V,rt,k);for(let W=i;W>Ht;W--){let D=W-tr;D=tr<<D-Ht;let J=t.pow(rt,D);const nt=t.eql(J,t.ONE);z=t.mul(j,M),M=t.mul(M,M),J=t.mul(rt,M),j=t.cmov(z,j,nt),rt=t.cmov(J,rt,nt)}return{isValid:k,value:j}};if(t.ORDER%ho===Zi){const b=(t.ORDER-Zi)/ho,q=t.sqrt(t.neg(e));S=(M,z)=>{let j=t.sqr(z);const V=t.mul(M,z);j=t.mul(j,V);let rt=t.pow(j,b);rt=t.mul(rt,V);const k=t.mul(rt,q),W=t.mul(t.sqr(rt),z),D=t.eql(W,M);let J=t.cmov(k,rt,D);return{isValid:D,value:J}}}return S}function Eu(t,e){if(hu(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=Od(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,a,f,o,y,w,N,A;i=t.sqr(n),i=t.mul(i,e.Z),a=t.sqr(i),a=t.add(a,i),f=t.add(a,t.ONE),f=t.mul(f,e.B),o=t.cmov(e.Z,t.neg(a),!t.eql(a,t.ZERO)),o=t.mul(o,e.A),a=t.sqr(f),w=t.sqr(o),y=t.mul(w,e.A),a=t.add(a,y),a=t.mul(a,f),w=t.mul(w,o),y=t.mul(w,e.B),a=t.add(a,y),N=t.mul(i,f);const{isValid:R,value:S}=r(a,w);A=t.mul(i,n),A=t.mul(A,S),N=t.cmov(N,f,R),A=t.cmov(A,S,R);const b=t.isOdd(n)===t.isOdd(A);return A=t.cmov(t.neg(A),A,b),N=t.div(N,o),{x:N,y:A}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Sd=BigInt(0),di=BigInt(1),_o=BigInt(2),Jr=BigInt(3);function Rd(t){const e=[];for(;t>di;t>>=di)(t&di)===Sd?e.unshift(0):(t&Jr)===Jr?(e.unshift(-1),t+=di):e.unshift(1);return e}function Ad(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:a}=t.fields,f=t.params.xNegative,o=t.params.twistType,y=po({n:r.ORDER,...t.G1}),w=Object.assign(y,lo(y.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),N=po({n:r.ORDER,...t.G2}),A=Object.assign(N,lo(N.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let R;if(o==="multiplicative")R=(X,lt,E,ct,ft,yt)=>a.mul014(ct,X,n.mul(lt,ft),n.mul(E,yt));else if(o==="divisive")R=(X,lt,E,ct,ft,yt)=>a.mul034(ct,n.mul(E,yt),n.mul(lt,ft),X);else throw new Error("bls: unknown twist type");const S=n.div(n.ONE,n.mul(n.ONE,_o));function b(X,lt,E,ct){const ft=n.sqr(E),yt=n.sqr(ct),it=n.mulByB(n.mul(yt,Jr)),st=n.mul(it,Jr),g=n.sub(n.sub(n.sqr(n.add(E,ct)),yt),ft),s=n.sub(it,ft),h=n.mul(n.sqr(lt),Jr),x=n.neg(g);return X.push([s,h,x]),lt=n.mul(n.mul(n.mul(n.sub(ft,st),lt),E),S),E=n.sub(n.sqr(n.mul(n.add(ft,st),S)),n.mul(n.sqr(it),Jr)),ct=n.mul(ft,g),{Rx:lt,Ry:E,Rz:ct}}function q(X,lt,E,ct,ft,yt){const it=n.sub(E,n.mul(yt,ct)),st=n.sub(lt,n.mul(ft,ct)),g=n.sub(n.mul(it,ft),n.mul(st,yt)),s=n.neg(it),h=st;X.push([g,s,h]);const x=n.sqr(st),T=n.mul(x,st),U=n.mul(x,lt),p=n.add(n.sub(T,n.mul(U,_o)),n.mul(n.sqr(it),ct));return lt=n.mul(st,p),E=n.sub(n.mul(n.sub(U,p),it),n.mul(T,E)),ct=n.mul(ct,T),{Rx:lt,Ry:E,Rz:ct}}const M=Rd(t.params.ateLoopSize),z=qn(X=>{const lt=X,{x:E,y:ct}=lt.toAffine(),ft=E,yt=ct,it=n.neg(ct);let st=ft,g=yt,s=n.ONE;const h=[];for(const x of M){const T=[];({Rx:st,Ry:g,Rz:s}=b(T,st,g,s)),x&&({Rx:st,Ry:g,Rz:s}=q(T,st,g,s,ft,x===-1?it:yt)),h.push(T)}if(t.postPrecompute){const x=h[h.length-1];t.postPrecompute(st,g,s,ft,yt,q.bind(null,x))}return h});function j(X,lt=!1){let E=a.ONE;if(X.length){const ct=X[0][0].length;for(let ft=0;ft<ct;ft++){E=a.sqr(E);for(const[yt,it,st]of X)for(const[g,s,h]of yt[ft])E=R(g,s,h,E,it,st)}}return f&&(E=a.conjugate(E)),lt?a.finalExponentiate(E):E}function V(X,lt=!0){const E=[];w.ProjectivePoint.normalizeZ(X.map(({g1:ct})=>ct)),A.ProjectivePoint.normalizeZ(X.map(({g2:ct})=>ct));for(const{g1:ct,g2:ft}of X){if(ct.equals(w.ProjectivePoint.ZERO)||ft.equals(A.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ct.assertValidity(),ft.assertValidity();const yt=ct.toAffine();E.push([z(ft),yt.x,yt.y])}return j(E,lt)}function rt(X,lt,E=!0){return V([{g1:X,g2:lt}],E)}const k={randomPrivateKey:()=>{const X=yu(r.ORDER);return wd(t.randomBytes(X),r.ORDER)},calcPairingPrecomputes:z},{ShortSignature:W}=t.G1,{Signature:D}=t.G2;function J(X){return X instanceof w.ProjectivePoint?X:w.ProjectivePoint.fromHex(X)}function nt(X,lt){return X instanceof w.ProjectivePoint?X:w.hashToCurve(fe("point",X),lt)}function tt(X){return X instanceof A.ProjectivePoint?X:D.fromHex(X)}function dt(X,lt){return X instanceof A.ProjectivePoint?X:A.hashToCurve(fe("point",X),lt)}function ut(X){return w.ProjectivePoint.fromPrivateKey(X).toRawBytes(!0)}function I(X){return A.ProjectivePoint.fromPrivateKey(X).toRawBytes(!0)}function F(X,lt,E){const ct=dt(X,E);ct.assertValidity();const ft=ct.multiply(w.normPrivateKeyToScalar(lt));return X instanceof A.ProjectivePoint?ft:D.toRawBytes(ft)}function Y(X,lt,E){const ct=nt(X,E);ct.assertValidity();const ft=ct.multiply(w.normPrivateKeyToScalar(lt));return X instanceof w.ProjectivePoint?ft:W.toRawBytes(ft)}function $(X,lt,E,ct){const ft=J(E),yt=dt(lt,ct),it=w.ProjectivePoint.BASE,st=tt(X),g=V([{g1:ft.negate(),g2:yt},{g1:it,g2:st}]);return a.eql(g,a.ONE)}function G(X,lt,E,ct){const ft=tt(E),yt=nt(lt,ct),it=A.ProjectivePoint.BASE,st=J(X),g=V([{g1:yt,g2:ft},{g1:st,g2:it.negate()}]);return a.eql(g,a.ONE)}function Q(X){if(!X.length)throw new Error("Expected non-empty array");const E=X.map(J).reduce((ct,ft)=>ct.add(ft),w.ProjectivePoint.ZERO);return X[0]instanceof w.ProjectivePoint?(E.assertValidity(),E):E.toRawBytes(!0)}function et(X){if(!X.length)throw new Error("Expected non-empty array");const E=X.map(tt).reduce((ct,ft)=>ct.add(ft),A.ProjectivePoint.ZERO);return X[0]instanceof A.ProjectivePoint?(E.assertValidity(),E):D.toRawBytes(E)}function _t(X){if(!X.length)throw new Error("Expected non-empty array");const E=X.map(J).reduce((ct,ft)=>ct.add(ft),w.ProjectivePoint.ZERO);return X[0]instanceof w.ProjectivePoint?(E.assertValidity(),E):W.toRawBytes(E)}function at(X,lt,E,ct){if(!lt.length)throw new Error("Expected non-empty messages array");if(E.length!==lt.length)throw new Error("Pubkey count should equal msg count");const ft=tt(X),yt=lt.map(s=>dt(s,ct)),it=E.map(J),st=new Map;for(let s=0;s<it.length;s++){const h=it[s],x=yt[s];let T=st.get(x);T===void 0&&(T=[],st.set(x,T)),T.push(h)}const g=[];try{for(const[s,h]of st){const x=h.reduce((T,U)=>T.add(U));g.push({g1:x,g2:s})}return g.push({g1:w.ProjectivePoint.BASE.negate(),g2:ft}),a.eql(V(g),a.ONE)}catch{return!1}}return w.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:ut,getPublicKeyForShortSignatures:I,sign:F,signShortSignature:Y,verify:$,verifyBatch:at,verifyShortSignature:G,aggregatePublicKeys:Q,aggregateSignatures:et,aggregateShortSignatures:_t,millerLoopBatch:j,pairing:rt,pairingBatch:V,G1:w,G2:A,Signature:D,ShortSignature:W,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:a},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:k}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Id=BigInt(0),Qr=BigInt(1),He=BigInt(2),yo=BigInt(3);function Gs(t,e,r,n,i=1,a){const f=BigInt(a===void 0?n:a),o=r**BigInt(n),y=[];for(let w=0;w<i;w++){const N=BigInt(w+1),A=[];for(let R=0,S=Qr;R<n;R++){const b=(N*S-N)/f%o;A.push(t.pow(e,b)),S*=r}y.push(A)}return y}function Bd(t,e,r){const n=e.pow(r,(t.ORDER-Qr)/yo),i=e.pow(r,(t.ORDER-Qr)/He);function a(R,S){const b=e.mul(e.frobeniusMap(R,1),n),q=e.mul(e.frobeniusMap(S,1),i);return[b,q]}const f=e.pow(r,(t.ORDER**He-Qr)/yo),o=e.pow(r,(t.ORDER**He-Qr)/He);if(!e.eql(o,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function y(R,S){return[e.mul(R,f),e.neg(S)]}const w=R=>(S,b)=>{const q=b.toAffine(),M=R(q.x,q.y);return S.fromAffine({x:M[0],y:M[1]})},N=w(a),A=w(y);return{psi:a,psi2:y,G2psi:N,G2psi2:A,PSI_X:n,PSI_Y:i,PSI2_X:f,PSI2_Y:o}}function Ud(t){const{ORDER:e}=t,r=Jn(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=gd(e),a=r.div(r.ONE,He),f=Gs(r,n,r.ORDER,2)[0],o=({c0:I,c1:F},{c0:Y,c1:$})=>({c0:r.add(I,Y),c1:r.add(F,$)}),y=({c0:I,c1:F},{c0:Y,c1:$})=>({c0:r.sub(I,Y),c1:r.sub(F,$)}),w=({c0:I,c1:F},Y)=>{if(typeof Y=="bigint")return{c0:r.mul(I,Y),c1:r.mul(F,Y)};const{c0:$,c1:G}=Y;let Q=r.mul(I,$),et=r.mul(F,G);const _t=r.sub(Q,et),at=r.sub(r.mul(r.add(I,F),r.add($,G)),r.add(Q,et));return{c0:_t,c1:at}},N=({c0:I,c1:F})=>{const Y=r.add(I,F),$=r.sub(I,F),G=r.add(I,I);return{c0:r.mul(Y,$),c1:r.mul(G,F)}},A=I=>{if(I.length!==2)throw new Error("Invalid tuple");const F=I.map(Y=>r.create(Y));return{c0:F[0],c1:F[1]}},R=e*e,S=A(t.FP2_NONRESIDUE),b={ORDER:R,NONRESIDUE:S,BITS:Vn(R),BYTES:Math.ceil(Vn(R)/8),MASK:xi(Vn(R)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:I=>I,isValid:({c0:I,c1:F})=>typeof I=="bigint"&&typeof F=="bigint",is0:({c0:I,c1:F})=>r.is0(I)&&r.is0(F),eql:({c0:I,c1:F},{c0:Y,c1:$})=>r.eql(I,Y)&&r.eql(F,$),neg:({c0:I,c1:F})=>({c0:r.neg(I),c1:r.neg(F)}),pow:(I,F)=>vi(b,I,F),invertBatch:I=>Ni(b,I),add:o,sub:y,mul:w,sqr:N,addN:o,subN:y,mulN:w,sqrN:N,div:(I,F)=>b.mul(I,typeof F=="bigint"?r.inv(r.create(F)):b.inv(F)),inv:({c0:I,c1:F})=>{const Y=r.inv(r.create(I*I+F*F));return{c0:r.mul(Y,r.create(I)),c1:r.mul(Y,r.create(-F))}},sqrt:I=>{if(t.Fp2sqrt)return t.Fp2sqrt(I);const{c0:F,c1:Y}=I;if(r.is0(Y))return r.eql(i(r,F),r.ONE)?b.create({c0:r.sqrt(F),c1:r.ZERO}):b.create({c0:r.ZERO,c1:r.sqrt(r.div(F,n))});const $=r.sqrt(r.sub(r.sqr(F),r.mul(r.sqr(Y),n)));let G=r.mul(r.add($,F),a);const Q=i(r,G);!r.is0(Q)&&!r.eql(Q,r.ONE)&&(G=r.sub(G,$));const et=r.sqrt(G),_t=b.create({c0:et,c1:r.div(r.mul(Y,a),et)});if(!b.eql(b.sqr(_t),I))throw new Error("Cannot find square root");const at=_t,X=b.neg(at),{re:lt,im:E}=b.reim(at),{re:ct,im:ft}=b.reim(X);return E>ft||E===ft&&lt>ct?at:X},isOdd:I=>{const{re:F,im:Y}=b.reim(I),$=F%He,G=F===Id,Q=Y%He;return BigInt($||G&&Q)==Qr},fromBytes(I){if(I.length!==b.BYTES)throw new Error(`fromBytes wrong length=${I.length}`);return{c0:r.fromBytes(I.subarray(0,r.BYTES)),c1:r.fromBytes(I.subarray(r.BYTES))}},toBytes:({c0:I,c1:F})=>zt(r.toBytes(I),r.toBytes(F)),cmov:({c0:I,c1:F},{c0:Y,c1:$},G)=>({c0:r.cmov(I,Y,G),c1:r.cmov(F,$,G)}),reim:({c0:I,c1:F})=>({re:I,im:F}),mulByNonresidue:({c0:I,c1:F})=>b.mul({c0:I,c1:F},S),mulByB:t.Fp2mulByB,fromBigTuple:A,frobeniusMap:({c0:I,c1:F},Y)=>({c0:I,c1:r.mul(F,f[Y%2])})},q=({c0:I,c1:F,c2:Y},{c0:$,c1:G,c2:Q})=>({c0:b.add(I,$),c1:b.add(F,G),c2:b.add(Y,Q)}),M=({c0:I,c1:F,c2:Y},{c0:$,c1:G,c2:Q})=>({c0:b.sub(I,$),c1:b.sub(F,G),c2:b.sub(Y,Q)}),z=({c0:I,c1:F,c2:Y},$)=>{if(typeof $=="bigint")return{c0:b.mul(I,$),c1:b.mul(F,$),c2:b.mul(Y,$)};const{c0:G,c1:Q,c2:et}=$,_t=b.mul(I,G),at=b.mul(F,Q),X=b.mul(Y,et);return{c0:b.add(_t,b.mulByNonresidue(b.sub(b.mul(b.add(F,Y),b.add(Q,et)),b.add(at,X)))),c1:b.add(b.sub(b.mul(b.add(I,F),b.add(G,Q)),b.add(_t,at)),b.mulByNonresidue(X)),c2:b.sub(b.add(at,b.mul(b.add(I,Y),b.add(G,et))),b.add(_t,X))}},j=({c0:I,c1:F,c2:Y})=>{let $=b.sqr(I),G=b.mul(b.mul(I,F),He),Q=b.mul(b.mul(F,Y),He),et=b.sqr(Y);return{c0:b.add(b.mulByNonresidue(Q),$),c1:b.add(b.mulByNonresidue(et),G),c2:b.sub(b.sub(b.add(b.add(G,b.sqr(b.add(b.sub(I,F),Y))),Q),$),et)}},[V,rt]=Gs(b,S,r.ORDER,6,2,3),k={ORDER:b.ORDER,BITS:3*b.BITS,BYTES:3*b.BYTES,MASK:xi(3*b.BITS),ZERO:{c0:b.ZERO,c1:b.ZERO,c2:b.ZERO},ONE:{c0:b.ONE,c1:b.ZERO,c2:b.ZERO},create:I=>I,isValid:({c0:I,c1:F,c2:Y})=>b.isValid(I)&&b.isValid(F)&&b.isValid(Y),is0:({c0:I,c1:F,c2:Y})=>b.is0(I)&&b.is0(F)&&b.is0(Y),neg:({c0:I,c1:F,c2:Y})=>({c0:b.neg(I),c1:b.neg(F),c2:b.neg(Y)}),eql:({c0:I,c1:F,c2:Y},{c0:$,c1:G,c2:Q})=>b.eql(I,$)&&b.eql(F,G)&&b.eql(Y,Q),sqrt:so,div:(I,F)=>k.mul(I,typeof F=="bigint"?r.inv(r.create(F)):k.inv(F)),pow:(I,F)=>vi(k,I,F),invertBatch:I=>Ni(k,I),add:q,sub:M,mul:z,sqr:j,addN:q,subN:M,mulN:z,sqrN:j,inv:({c0:I,c1:F,c2:Y})=>{let $=b.sub(b.sqr(I),b.mulByNonresidue(b.mul(Y,F))),G=b.sub(b.mulByNonresidue(b.sqr(Y)),b.mul(I,F)),Q=b.sub(b.sqr(F),b.mul(I,Y)),et=b.inv(b.add(b.mulByNonresidue(b.add(b.mul(Y,G),b.mul(F,Q))),b.mul(I,$)));return{c0:b.mul(et,$),c1:b.mul(et,G),c2:b.mul(et,Q)}},fromBytes:I=>{if(I.length!==k.BYTES)throw new Error(`fromBytes wrong length=${I.length}`);return{c0:b.fromBytes(I.subarray(0,b.BYTES)),c1:b.fromBytes(I.subarray(b.BYTES,2*b.BYTES)),c2:b.fromBytes(I.subarray(2*b.BYTES))}},toBytes:({c0:I,c1:F,c2:Y})=>zt(b.toBytes(I),b.toBytes(F),b.toBytes(Y)),cmov:({c0:I,c1:F,c2:Y},{c0:$,c1:G,c2:Q},et)=>({c0:b.cmov(I,$,et),c1:b.cmov(F,G,et),c2:b.cmov(Y,Q,et)}),fromBigSix:I=>{if(!Array.isArray(I)||I.length!==6)throw new Error("Invalid Fp6 usage");return{c0:b.fromBigTuple(I.slice(0,2)),c1:b.fromBigTuple(I.slice(2,4)),c2:b.fromBigTuple(I.slice(4,6))}},frobeniusMap:({c0:I,c1:F,c2:Y},$)=>({c0:b.frobeniusMap(I,$),c1:b.mul(b.frobeniusMap(F,$),V[$%6]),c2:b.mul(b.frobeniusMap(Y,$),rt[$%6])}),mulByFp2:({c0:I,c1:F,c2:Y},$)=>({c0:b.mul(I,$),c1:b.mul(F,$),c2:b.mul(Y,$)}),mulByNonresidue:({c0:I,c1:F,c2:Y})=>({c0:b.mulByNonresidue(Y),c1:I,c2:F}),mul1:({c0:I,c1:F,c2:Y},$)=>({c0:b.mulByNonresidue(b.mul(Y,$)),c1:b.mul(I,$),c2:b.mul(F,$)}),mul01({c0:I,c1:F,c2:Y},$,G){let Q=b.mul(I,$),et=b.mul(F,G);return{c0:b.add(b.mulByNonresidue(b.sub(b.mul(b.add(F,Y),G),et)),Q),c1:b.sub(b.sub(b.mul(b.add($,G),b.add(I,F)),Q),et),c2:b.add(b.sub(b.mul(b.add(I,Y),$),Q),et)}}},W=Gs(b,S,r.ORDER,12,1,6)[0],D=({c0:I,c1:F},{c0:Y,c1:$})=>({c0:k.add(I,Y),c1:k.add(F,$)}),J=({c0:I,c1:F},{c0:Y,c1:$})=>({c0:k.sub(I,Y),c1:k.sub(F,$)}),nt=({c0:I,c1:F},Y)=>{if(typeof Y=="bigint")return{c0:k.mul(I,Y),c1:k.mul(F,Y)};let{c0:$,c1:G}=Y,Q=k.mul(I,$),et=k.mul(F,G);return{c0:k.add(Q,k.mulByNonresidue(et)),c1:k.sub(k.mul(k.add(I,F),k.add($,G)),k.add(Q,et))}},tt=({c0:I,c1:F})=>{let Y=k.mul(I,F);return{c0:k.sub(k.sub(k.mul(k.add(k.mulByNonresidue(F),I),k.add(I,F)),Y),k.mulByNonresidue(Y)),c1:k.add(Y,Y)}};function dt(I,F){const Y=b.sqr(I),$=b.sqr(F);return{first:b.add(b.mulByNonresidue($),Y),second:b.sub(b.sub(b.sqr(b.add(I,F)),Y),$)}}const ut={ORDER:b.ORDER,BITS:2*b.BITS,BYTES:2*b.BYTES,MASK:xi(2*b.BITS),ZERO:{c0:k.ZERO,c1:k.ZERO},ONE:{c0:k.ONE,c1:k.ZERO},create:I=>I,isValid:({c0:I,c1:F})=>k.isValid(I)&&k.isValid(F),is0:({c0:I,c1:F})=>k.is0(I)&&k.is0(F),neg:({c0:I,c1:F})=>({c0:k.neg(I),c1:k.neg(F)}),eql:({c0:I,c1:F},{c0:Y,c1:$})=>k.eql(I,Y)&&k.eql(F,$),sqrt:so,inv:({c0:I,c1:F})=>{let Y=k.inv(k.sub(k.sqr(I),k.mulByNonresidue(k.sqr(F))));return{c0:k.mul(I,Y),c1:k.neg(k.mul(F,Y))}},div:(I,F)=>ut.mul(I,typeof F=="bigint"?r.inv(r.create(F)):ut.inv(F)),pow:(I,F)=>vi(ut,I,F),invertBatch:I=>Ni(ut,I),add:D,sub:J,mul:nt,sqr:tt,addN:D,subN:J,mulN:nt,sqrN:tt,fromBytes:I=>{if(I.length!==ut.BYTES)throw new Error(`fromBytes wrong length=${I.length}`);return{c0:k.fromBytes(I.subarray(0,k.BYTES)),c1:k.fromBytes(I.subarray(k.BYTES))}},toBytes:({c0:I,c1:F})=>zt(k.toBytes(I),k.toBytes(F)),cmov:({c0:I,c1:F},{c0:Y,c1:$},G)=>({c0:k.cmov(I,Y,G),c1:k.cmov(F,$,G)}),fromBigTwelve:I=>({c0:k.fromBigSix(I.slice(0,6)),c1:k.fromBigSix(I.slice(6,12))}),frobeniusMap(I,F){const{c0:Y,c1:$,c2:G}=k.frobeniusMap(I.c1,F),Q=W[F%12];return{c0:k.frobeniusMap(I.c0,F),c1:k.create({c0:b.mul(Y,Q),c1:b.mul($,Q),c2:b.mul(G,Q)})}},mulByFp2:({c0:I,c1:F},Y)=>({c0:k.mulByFp2(I,Y),c1:k.mulByFp2(F,Y)}),conjugate:({c0:I,c1:F})=>({c0:I,c1:k.neg(F)}),mul014:({c0:I,c1:F},Y,$,G)=>{let Q=k.mul01(I,Y,$),et=k.mul1(F,G);return{c0:k.add(k.mulByNonresidue(et),Q),c1:k.sub(k.sub(k.mul01(k.add(F,I),Y,b.add($,G)),Q),et)}},mul034:({c0:I,c1:F},Y,$,G)=>{const Q=k.create({c0:b.mul(I.c0,Y),c1:b.mul(I.c1,Y),c2:b.mul(I.c2,Y)}),et=k.mul01(F,$,G),_t=k.mul01(k.add(I,F),b.add(Y,$),G);return{c0:k.add(k.mulByNonresidue(et),Q),c1:k.sub(_t,k.add(Q,et))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:b,Fp6:k,Fp4Square:dt,Fp12:ut}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ce=BigInt(0),Xi=BigInt(1),Jt=BigInt(2),hi=BigInt(3),kn=BigInt(4),cr=BigInt("0xd201000000010000"),Fd=Vn(cr),{Fp:mt,Fp2:bt,Fp6:_a,Fp4Square:js,Fp12:It}=Ud({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[Xi,Xi],Fp2mulByB:({c0:t,c1:e})=>{const r=mt.mul(t,kn),n=mt.mul(e,kn);return{c0:mt.sub(r,n),c1:mt.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:a,c1:f,c2:o}=e,{first:y,second:w}=js(r,f),{first:N,second:A}=js(a,i),{first:R,second:S}=js(n,o),b=bt.mulByNonresidue(S);return{c0:_a.create({c0:bt.add(bt.mul(bt.sub(y,r),Jt),y),c1:bt.add(bt.mul(bt.sub(N,n),Jt),N),c2:bt.add(bt.mul(bt.sub(R,i),Jt),R)}),c1:_a.create({c0:bt.add(bt.mul(bt.add(b,a),Jt),b),c1:bt.add(bt.mul(bt.add(w,f),Jt),w),c2:bt.add(bt.mul(bt.add(A,o),Jt),A)})}},Fp12cyclotomicExp(t,e){let r=It.ONE;for(let n=Fd-1;n>=0;n--)r=It._cyclotomicSquare(r),ld(e,n)&&(r=It.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=cr,r=It.div(It.frobeniusMap(t,6),t),n=It.mul(It.frobeniusMap(r,2),r),i=It.conjugate(It._cyclotomicExp(n,e)),a=It.mul(It.conjugate(It._cyclotomicSquare(n)),i),f=It.conjugate(It._cyclotomicExp(a,e)),o=It.conjugate(It._cyclotomicExp(f,e)),y=It.mul(It.conjugate(It._cyclotomicExp(o,e)),It._cyclotomicSquare(i)),w=It.conjugate(It._cyclotomicExp(y,e)),N=It.frobeniusMap(It.mul(i,o),2),A=It.frobeniusMap(It.mul(f,n),3),R=It.frobeniusMap(It.mul(y,It.conjugate(n)),1),S=It.mul(It.mul(w,It.conjugate(a)),n);return It.mul(It.mul(It.mul(N,A),R),S)}}),mo=Jn(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),Pd=mu(bt,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>bt.fromBigTuple(e.map(BigInt))))),Vd=mu(mt,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),kd=Eu(bt,{A:bt.create({c0:mt.create(ce),c1:mt.create(BigInt(240))}),B:bt.create({c0:mt.create(BigInt(1012)),c1:mt.create(BigInt(1012))}),Z:bt.create({c0:mt.create(BigInt(-2)),c1:mt.create(BigInt(-1))})}),Cd=Eu(mt,{A:mt.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:mt.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:mt.create(BigInt(11))}),{G2psi:go,G2psi2:Md}=Bd(mt,bt,bt.div(bt.ONE,bt.NONRESIDUE)),Hs=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:mt.ORDER,m:2,k:128,expand:"xmd",hash:Ta}),Ji=Ln(mt.toBytes(ce),{infinity:!0,compressed:!0});function pi(t){t=t.slice();const e=t[0]&224,r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Ln(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function wo(t){t.assertValidity();const e=t.equals(ye.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return Ji.slice();const i=mt.ORDER,a=!!(n*Jt/i);return Ln(ee(r,mt.BYTES),{compressed:!0,sort:a})}function bo(t){t.assertValidity();const e=mt.BYTES;if(t.equals(ye.G2.ProjectivePoint.ZERO))return zt(Ji,ee(ce,e));const{x:r,y:n}=t.toAffine(),{re:i,im:a}=bt.reim(r),{re:f,im:o}=bt.reim(n),w=!!((o>ce?o*Jt:f*Jt)/mt.ORDER&Xi),N=i;return zt(Ln(ee(a,e),{sort:w,compressed:!0}),ee(N,e))}const ye=Ad({fields:{Fp:mt,Fp2:bt,Fp6:_a,Fp12:It,Fr:mo},G1:{Fp:mt,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:mt.ZERO,b:kn,htfDefaults:{...Hs,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(mt.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(cr).negate().multiplyUnsafe(cr).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(cr).add(e),mapToCurve:t=>{const{x:e,y:r}=Cd(mt.create(t[0]));return Vd(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=pi(t);if(i.length===48&&e){const a=mt.ORDER,f=Oe(i),o=mt.create(f&mt.MASK);if(r){if(o!==ce)throw new Error("G1: non-empty compressed point at infinity");return{x:ce,y:ce}}const y=mt.add(mt.pow(o,hi),mt.create(ye.params.G1b));let w=mt.sqrt(y);if(!w)throw new Error("Invalid compressed G1 point");return w*Jt/a!==BigInt(n)&&(w=mt.neg(w)),{x:mt.create(o),y:mt.create(w)}}else if(i.length===96&&!e){const a=Oe(i.subarray(0,mt.BYTES)),f=Oe(i.subarray(mt.BYTES));if(r){if(a!==ce||f!==ce)throw new Error("G1: non-empty point at infinity");return ye.G1.ProjectivePoint.ZERO.toAffine()}return{x:mt.create(a),y:mt.create(f)}}else throw new Error("Invalid point G1, expected 48/96 bytes")},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:a}=e.toAffine();if(r){if(n)return Ji.slice();const f=mt.ORDER,o=!!(a*Jt/f);return Ln(ee(i,mt.BYTES),{compressed:!0,sort:o})}else return n?zt(new Uint8Array([64]),new Uint8Array(2*mt.BYTES-1)):zt(ee(i,mt.BYTES),ee(a,mt.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=pi(fe("signatureHex",t,48)),i=mt.ORDER,a=Oe(n);if(e)return ye.G1.ProjectivePoint.ZERO;const f=mt.create(a&mt.MASK),o=mt.add(mt.pow(f,hi),mt.create(ye.params.G1b));let y=mt.sqrt(o);if(!y)throw new Error("Invalid compressed G1 point");const w=BigInt(r);y*Jt/i!==w&&(y=mt.neg(y));const N=ye.G1.ProjectivePoint.fromAffine({x:f,y});return N.assertValidity(),N},toRawBytes(t){return wo(t)},toHex(t){return Cr(wo(t))}}},G2:{Fp:bt,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:bt.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:bt.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:bt.ZERO,b:bt.fromBigTuple([kn,kn]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Hs},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=kd(bt.fromBigTuple(t));return Pd(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(cr).negate().equals(go(t,e)),clearCofactor:(t,e)=>{const r=cr;let n=e.multiplyUnsafe(r).negate(),i=go(t,e),a=e.double();return a=Md(t,a),a=a.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),a=a.add(i),a=a.subtract(n),a.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=pi(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("Invalid encoding flag: "+(t[0]&224));const a=mt.BYTES,f=(o,y,w)=>Oe(o.slice(y,w));if(i.length===96&&e){const o=ye.params.G2b,y=mt.ORDER;if(r){if(i.reduce((q,M)=>q!==0?M+1:M,0)>0)throw new Error("Invalid compressed G2 point");return{x:bt.ZERO,y:bt.ZERO}}const w=f(i,0,a),N=f(i,a,2*a),A=bt.create({c0:mt.create(N),c1:mt.create(w)}),R=bt.add(bt.pow(A,hi),o);let S=bt.sqrt(R);const b=S.c1===ce?S.c0*Jt/y:S.c1*Jt/y?Xi:ce;return S=n&&b>0?S:bt.neg(S),{x:A,y:S}}else if(i.length===192&&!e){if(r){if(i.reduce((A,R)=>A!==0?R+1:R,0)>0)throw new Error("Invalid uncompressed G2 point");return{x:bt.ZERO,y:bt.ZERO}}const o=f(i,0,a),y=f(i,a,2*a),w=f(i,2*a,3*a),N=f(i,3*a,4*a);return{x:bt.fromBigTuple([y,o]),y:bt.fromBigTuple([N,w])}}else throw new Error("Invalid point G2, expected 96/192 bytes")},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=mt,a=e.equals(t.ZERO),{x:f,y:o}=e.toAffine();if(r){if(a)return zt(Ji,ee(ce,n));const y=!!(o.c1===ce?o.c0*Jt/i:o.c1*Jt/i);return zt(Ln(ee(f.c1,n),{compressed:!0,sort:y}),ee(f.c0,n))}else{if(a)return zt(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:y,im:w}=bt.reim(f),{re:N,im:A}=bt.reim(o);return zt(ee(w,n),ee(y,n),ee(A,n),ee(N,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=pi(fe("signatureHex",t)),i=mt.ORDER,a=n.length/2;if(a!==48&&a!==96)throw new Error("Invalid compressed signature length, must be 96 or 192");const f=Oe(n.slice(0,a)),o=Oe(n.slice(a));if(e)return ye.G2.ProjectivePoint.ZERO;const y=mt.create(f&mt.MASK),w=mt.create(o),N=bt.create({c0:w,c1:y}),A=bt.add(bt.pow(N,hi),ye.params.G2b);let R=bt.sqrt(A);if(!R)throw new Error("Failed to find a square root");const{re:S,im:b}=bt.reim(R),q=BigInt(r),M=b>ce&&b*Jt/i!==q,z=b===ce&&S*Jt/i!==q;(M||z)&&(R=bt.neg(R));const j=ye.G2.ProjectivePoint.fromAffine({x:N,y:R});return j.assertValidity(),j},toRawBytes(t){return bo(t)},toHex(t){return Cr(bo(t))}}},params:{ateLoopSize:cr,r:mo.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Hs,hash:Ta,randomBytes:Zo});function $d(t,e,r){const n=typeof t=="string"?t:Mt(t),i=typeof e=="string"?e:Mt(e),a=typeof r=="string"?r:Mt(r);return ye.verifyShortSignature(i,a,n)}const xu=t=>Xt(new cn(t)),Ma=t=>{const e=xu(t);return new Date(Number(e)/1e6)};var qd=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Dd=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ti;class Ce extends Gt{constructor(e){super(`Invalid certificate: ${e}`)}}var he;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(he||(he={}));function Ld(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class Fr{constructor(e,r,n,i,a=5,f=!1){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=a,Ti.set(this,!1),qd(this,Ti,f,"f"),this.cert=ze(new Uint8Array(e))}static async create(e){const r=Fr.createUnverified(e);return await r.verify(),r}static createUnverified(e){let r=e.blsVerify;return r||(r=$d),new Fr(e.certificate,e.rootKey,e.canisterId,r,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return an(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await Oi(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=jd(r),a=Re(Sn("ic-state-root"),e);let f=!1;const o=ge(this.lookup(["time"]));if(!o)throw new Ce("Certificate does not contain a time");if(!Dd(this,Ti,"f")){const w=this._maxAgeInMinutes*60*1e3,N=Date.now(),A=N-w,R=N+3e5,S=Ma(o);if(S.getTime()<A)throw new Ce(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+S.toISOString()+" Current time: "+new Date(N).toISOString());if(S.getTime()>R)throw new Ce("Certificate is signed more than 5 minutes in the future. Certificate time: "+S.toISOString()+" Current time: "+new Date(N).toISOString())}try{f=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(a))}catch{f=!1}if(!f)throw new Ce("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const r=await Fr.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new Ce("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==C0&&!vu({canisterId:this._canisterId,subnetId:Nt.fromUint8Array(new Uint8Array(e.subnet_id)),tree:r.cert.tree}))throw new Ce(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Mt(e.subnet_id)}`);const n=ge(r.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${Mt(e.subnet_id)}`);return n}}Ti=new WeakMap;const vn=We("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Gd=96;function jd(t){const e=vn.byteLength+Gd;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,vn.byteLength);if(!zn(r,vn))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${vn}, but get ${r}`);return t.slice(vn.byteLength)}function ge(t){if(t.status===Yt.Found){if(t.value instanceof ArrayBuffer)return t.value;if(t.value instanceof Uint8Array)return t.value.buffer}}async function Oi(t){switch(t[0]){case he.Empty:return Se(Sn("ic-hashtree-empty"));case he.Pruned:return t[1];case he.Leaf:return Se(Re(Sn("ic-hashtree-leaf"),t[1]));case he.Labeled:return Se(Re(Sn("ic-hashtree-labeled"),t[1],await Oi(t[2])));case he.Fork:return Se(Re(Sn("ic-hashtree-fork"),await Oi(t[1]),await Oi(t[2])));default:throw new Error("unreachable")}}function Sn(t){const e=new Uint8Array([t.length]),r=new TextEncoder().encode(t);return Re(e,r)}var Yt;(function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"})(Yt||(Yt={}));var Ke;(function(t){t.Less="less",t.Greater="greater"})(Ke||(Ke={}));function an(t,e){if(t.length===0)switch(e[0]){case he.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Yt.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Yt.Found,value:e[1].buffer}:{status:Yt.Found,value:e[1]}}default:return{status:Yt.Found,value:e}}const r=typeof t[0]=="string"?new TextEncoder().encode(t[0]):t[0],n=Si(r,e);switch(n.status){case Yt.Found:return an(t.slice(1),n.value);case Ke.Greater:case Ke.Less:return{status:Yt.Absent};default:return n}}function ya(t){switch(t[0]){case he.Empty:return[];case he.Fork:return ya(t[1]).concat(ya(t[2]));default:return[t]}}function Si(t,e){switch(e[0]){case he.Labeled:return Ld(t,e[1])?{status:Ke.Greater}:zn(t,e[1])?{status:Yt.Found,value:e[2]}:{status:Ke.Less};case he.Fork:const r=Si(t,e[1]);switch(r.status){case Ke.Greater:{const n=Si(t,e[2]);return n.status===Ke.Less?{status:Yt.Absent}:n}case Yt.Unknown:{let n=Si(t,e[2]);return n.status===Ke.Less?{status:Yt.Unknown}:n}default:return r}case he.Pruned:return{status:Yt.Unknown};default:return{status:Yt.Absent}}}function vu(t){const{canisterId:e,subnetId:r,tree:n}=t,i=an(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Yt.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return ze(i.value).map(y=>[Nt.fromUint8Array(y[0]),Nt.fromUint8Array(y[1])]).some(y=>y[0].ltEq(e)&&y[1].gtEq(e))}class Hd{constructor(e,r,n){this.key=e,this.path=r,this.decodeStrategy=n}}const Nu=async t=>{const{agent:e,paths:r}=t,n=Nt.from(t.canisterId),i=[...new Set(r)],a=i.map(y=>ma(y,n)),f=new Map,o=i.map((y,w)=>(async()=>{var N;try{const A=await e.readState(n,{paths:[a[w]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const R=await Fr.create({certificate:A.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),S=(M,z)=>{if(z==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const j=Tu(A.certificate,n,e.rootKey);return{path:z,data:j}}else return{path:z,data:ge(M.lookup(ma(z,n)))}},{path:b,data:q}=S(R,i[w]);if(!q)console.warn(`Expected to find result for path ${b}, but instead found nothing.`),typeof b=="string"?f.set(b,null):f.set(b.key,null);else switch(b){case"time":{f.set(b,Ma(q));break}case"controllers":{f.set(b,zd(q));break}case"module_hash":{f.set(b,Eo(q));break}case"subnet":{f.set(b,q);break}case"candid":{f.set(b,new TextDecoder().decode(q));break}default:if(typeof b!="string"&&"key"in b&&"path"in b)switch(b.decodeStrategy){case"raw":f.set(b.key,q);break;case"leb128":{f.set(b.key,xu(q));break}case"cbor":{f.set(b.key,Ou(q));break}case"hex":{f.set(b.key,Eo(q));break}case"utf-8":f.set(b.key,Kd(q))}}}catch(A){if(!((N=A?.message)===null||N===void 0)&&N.includes("Invalid certificate"))throw new Gt(A.message);typeof y!="string"&&"key"in y&&"path"in y?f.set(y.key,null):f.set(y,null),console.group(),console.warn(`Expected to find result for path ${y}, but instead found nothing.`),console.warn(A),console.groupEnd()}})());return await Promise.all(o),f},Tu=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=ze(new Uint8Array(t)),i=n.tree;let a=n.delegation,f;if(a&&a.subnet_id?f=Nt.fromUint8Array(new Uint8Array(a.subnet_id)):!a&&typeof r<"u"?(f=Nt.selfAuthenticating(new Uint8Array(r)),a={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}):(f=Nt.selfAuthenticating(Nt.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),a={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}),!vu({canisterId:e,subnetId:f,tree:i}))throw new Error("Canister not in range");const y=an(["subnet",a.subnet_id,"node"],i);if(y.status!==Yt.Found)throw new Error("Node not found");if(y.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const w=ya(y.value),N=new Map;return w.forEach(A=>{const R=Nt.from(new Uint8Array(A[1])).toText(),S=an(["public_key"],A[2]);if(S.status!==Yt.Found)throw new Error("Public key not found");const b=S.value;if(b.byteLength!==44)throw new Error("Invalid public key length");N.set(R,b)}),{subnetId:Nt.fromUint8Array(new Uint8Array(a.subnet_id)).toText(),nodeKeys:N}},ma=(t,e)=>{const r=new TextEncoder,n=a=>new DataView(r.encode(a).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof ArrayBuffer){const a=t.path,f=typeof a=="string"?n(a):a;return[n("canister"),i,n("metadata"),f]}else return t.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},Eo=t=>Mt(t),Ou=t=>ze(t),Kd=t=>new TextDecoder().decode(t),zd=t=>Ou(t).map(r=>Nt.fromUint8Array(new Uint8Array(r))),Yd=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:Hd,encodePath:ma,fetchNodeKeys:Tu,request:Nu},Symbol.toStringTag,{value:"Module"})),_i=BigInt(2**32-1),ga=BigInt(32);function Su(t,e=!1){return e?{h:Number(t&_i),l:Number(t>>ga&_i)}:{h:Number(t>>ga&_i)|0,l:Number(t&_i)|0}}function Wd(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:a,l:f}=Su(t[i],e);[r[i],n[i]]=[a,f]}return[r,n]}const Zd=(t,e)=>BigInt(t>>>0)<<ga|BigInt(e>>>0),Xd=(t,e,r)=>t>>>r,Jd=(t,e,r)=>t<<32-r|e>>>r,Qd=(t,e,r)=>t>>>r|e<<32-r,t0=(t,e,r)=>t<<32-r|e>>>r,e0=(t,e,r)=>t<<64-r|e>>>r-32,r0=(t,e,r)=>t>>>r-32|e<<64-r,n0=(t,e)=>e,i0=(t,e)=>t,s0=(t,e,r)=>t<<r|e>>>32-r,a0=(t,e,r)=>e<<r|t>>>32-r,o0=(t,e,r)=>e<<r-32|t>>>64-r,c0=(t,e,r)=>t<<r-32|e>>>64-r;function u0(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const l0=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),f0=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,d0=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),h0=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,p0=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),_0=(t,e,r,n,i,a)=>e+r+n+i+a+(t/2**32|0)|0,Ot={fromBig:Su,split:Wd,toBig:Zd,shrSH:Xd,shrSL:Jd,rotrSH:Qd,rotrSL:t0,rotrBH:e0,rotrBL:r0,rotr32H:n0,rotr32L:i0,rotlSH:s0,rotlSL:a0,rotlBH:o0,rotlBL:c0,add:u0,add3L:l0,add3H:f0,add4L:d0,add4H:h0,add5H:_0,add5L:p0},[y0,m0]=Ot.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),er=new Uint32Array(80),rr=new Uint32Array(80);class g0 extends Xo{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:a,Cl:f,Dh:o,Dl:y,Eh:w,El:N,Fh:A,Fl:R,Gh:S,Gl:b,Hh:q,Hl:M}=this;return[e,r,n,i,a,f,o,y,w,N,A,R,S,b,q,M]}set(e,r,n,i,a,f,o,y,w,N,A,R,S,b,q,M){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=f|0,this.Dh=o|0,this.Dl=y|0,this.Eh=w|0,this.El=N|0,this.Fh=A|0,this.Fl=R|0,this.Gh=S|0,this.Gl=b|0,this.Hh=q|0,this.Hl=M|0}process(e,r){for(let V=0;V<16;V++,r+=4)er[V]=e.getUint32(r),rr[V]=e.getUint32(r+=4);for(let V=16;V<80;V++){const rt=er[V-15]|0,k=rr[V-15]|0,W=Ot.rotrSH(rt,k,1)^Ot.rotrSH(rt,k,8)^Ot.shrSH(rt,k,7),D=Ot.rotrSL(rt,k,1)^Ot.rotrSL(rt,k,8)^Ot.shrSL(rt,k,7),J=er[V-2]|0,nt=rr[V-2]|0,tt=Ot.rotrSH(J,nt,19)^Ot.rotrBH(J,nt,61)^Ot.shrSH(J,nt,6),dt=Ot.rotrSL(J,nt,19)^Ot.rotrBL(J,nt,61)^Ot.shrSL(J,nt,6),ut=Ot.add4L(D,dt,rr[V-7],rr[V-16]),I=Ot.add4H(ut,W,tt,er[V-7],er[V-16]);er[V]=I|0,rr[V]=ut|0}let{Ah:n,Al:i,Bh:a,Bl:f,Ch:o,Cl:y,Dh:w,Dl:N,Eh:A,El:R,Fh:S,Fl:b,Gh:q,Gl:M,Hh:z,Hl:j}=this;for(let V=0;V<80;V++){const rt=Ot.rotrSH(A,R,14)^Ot.rotrSH(A,R,18)^Ot.rotrBH(A,R,41),k=Ot.rotrSL(A,R,14)^Ot.rotrSL(A,R,18)^Ot.rotrBL(A,R,41),W=A&S^~A&q,D=R&b^~R&M,J=Ot.add5L(j,k,D,m0[V],rr[V]),nt=Ot.add5H(J,z,rt,W,y0[V],er[V]),tt=J|0,dt=Ot.rotrSH(n,i,28)^Ot.rotrBH(n,i,34)^Ot.rotrBH(n,i,39),ut=Ot.rotrSL(n,i,28)^Ot.rotrBL(n,i,34)^Ot.rotrBL(n,i,39),I=n&a^n&o^a&o,F=i&f^i&y^f&y;z=q|0,j=M|0,q=S|0,M=b|0,S=A|0,b=R|0,{h:A,l:R}=Ot.add(w|0,N|0,nt|0,tt|0),w=o|0,N=y|0,o=a|0,y=f|0,a=n|0,f=i|0;const Y=Ot.add3L(tt,ut,F);n=Ot.add3H(Y,nt,dt,I),i=Y|0}({h:n,l:i}=Ot.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l:f}=Ot.add(this.Bh|0,this.Bl|0,a|0,f|0),{h:o,l:y}=Ot.add(this.Ch|0,this.Cl|0,o|0,y|0),{h:w,l:N}=Ot.add(this.Dh|0,this.Dl|0,w|0,N|0),{h:A,l:R}=Ot.add(this.Eh|0,this.El|0,A|0,R|0),{h:S,l:b}=Ot.add(this.Fh|0,this.Fl|0,S|0,b|0),{h:q,l:M}=Ot.add(this.Gh|0,this.Gl|0,q|0,M|0),{h:z,l:j}=Ot.add(this.Hh|0,this.Hl|0,z|0,j|0),this.set(n,i,a,f,o,y,w,N,A,R,S,b,q,M,z,j)}roundClean(){er.fill(0),rr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const w0=Na(()=>new g0);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xe=BigInt(0),le=BigInt(1),yi=BigInt(2),b0=BigInt(8),E0={zip215:!0};function x0(t){const e=bu(t);return Xn(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function v0(t){const e=x0(t),{Fp:r,n,prehash:i,hash:a,randomBytes:f,nByteLength:o,h:y}=e,w=yi<<BigInt(o*8)-le,N=r.create,A=Jn(e.n,e.nBitLength),R=e.uvRatio||(($,G)=>{try{return{isValid:!0,value:r.sqrt($*r.inv(G))}}catch{return{isValid:!1,value:xe}}}),S=e.adjustScalarBytes||($=>$),b=e.domain||(($,G,Q)=>{if(Fn("phflag",Q),G.length||Q)throw new Error("Contexts/pre-hash are not supported");return $});function q($,G){fr("coordinate "+$,G,xe,w)}function M($){if(!($ instanceof V))throw new Error("ExtendedPoint expected")}const z=qn(($,G)=>{const{ex:Q,ey:et,ez:_t}=$,at=$.is0();G==null&&(G=at?b0:r.inv(_t));const X=N(Q*G),lt=N(et*G),E=N(_t*G);if(at)return{x:xe,y:le};if(E!==le)throw new Error("invZ was invalid");return{x:X,y:lt}}),j=qn($=>{const{a:G,d:Q}=e;if($.is0())throw new Error("bad point: ZERO");const{ex:et,ey:_t,ez:at,et:X}=$,lt=N(et*et),E=N(_t*_t),ct=N(at*at),ft=N(ct*ct),yt=N(lt*G),it=N(ct*N(yt+E)),st=N(ft+N(Q*N(lt*E)));if(it!==st)throw new Error("bad point: equation left != right (1)");const g=N(et*_t),s=N(at*X);if(g!==s)throw new Error("bad point: equation left != right (2)");return!0});class V{constructor(G,Q,et,_t){this.ex=G,this.ey=Q,this.ez=et,this.et=_t,q("x",G),q("y",Q),q("z",et),q("t",_t),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(G){if(G instanceof V)throw new Error("extended point not allowed");const{x:Q,y:et}=G||{};return q("x",Q),q("y",et),new V(Q,et,le,N(Q*et))}static normalizeZ(G){const Q=r.invertBatch(G.map(et=>et.ez));return G.map((et,_t)=>et.toAffine(Q[_t])).map(V.fromAffine)}static msm(G,Q){return wu(V,A,G,Q)}_setWindowSize(G){W.setWindowSize(this,G)}assertValidity(){j(this)}equals(G){M(G);const{ex:Q,ey:et,ez:_t}=this,{ex:at,ey:X,ez:lt}=G,E=N(Q*lt),ct=N(at*_t),ft=N(et*lt),yt=N(X*_t);return E===ct&&ft===yt}is0(){return this.equals(V.ZERO)}negate(){return new V(N(-this.ex),this.ey,this.ez,N(-this.et))}double(){const{a:G}=e,{ex:Q,ey:et,ez:_t}=this,at=N(Q*Q),X=N(et*et),lt=N(yi*N(_t*_t)),E=N(G*at),ct=Q+et,ft=N(N(ct*ct)-at-X),yt=E+X,it=yt-lt,st=E-X,g=N(ft*it),s=N(yt*st),h=N(ft*st),x=N(it*yt);return new V(g,s,x,h)}add(G){M(G);const{a:Q,d:et}=e,{ex:_t,ey:at,ez:X,et:lt}=this,{ex:E,ey:ct,ez:ft,et:yt}=G;if(Q===BigInt(-1)){const v=N((at-_t)*(ct+E)),B=N((at+_t)*(ct-E)),L=N(B-v);if(L===xe)return this.double();const Z=N(X*yi*yt),ot=N(lt*yi*ft),pt=ot+Z,gt=B+v,_=ot-Z,l=N(pt*L),d=N(gt*_),O=N(pt*_),C=N(L*gt);return new V(l,d,C,O)}const it=N(_t*E),st=N(at*ct),g=N(lt*et*yt),s=N(X*ft),h=N((_t+at)*(E+ct)-it-st),x=s-g,T=s+g,U=N(st-Q*it),p=N(h*x),c=N(T*U),u=N(h*U),m=N(x*T);return new V(p,c,m,u)}subtract(G){return this.add(G.negate())}wNAF(G){return W.wNAFCached(this,G,V.normalizeZ)}multiply(G){const Q=G;fr("scalar",Q,le,n);const{p:et,f:_t}=this.wNAF(Q);return V.normalizeZ([et,_t])[0]}multiplyUnsafe(G){const Q=G;return fr("scalar",Q,xe,n),Q===xe?k:this.equals(k)||Q===le?this:this.equals(rt)?this.wNAF(Q).p:W.unsafeLadder(this,Q)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return W.unsafeLadder(this,n).is0()}toAffine(G){return z(this,G)}clearCofactor(){const{h:G}=e;return G===le?this:this.multiplyUnsafe(G)}static fromHex(G,Q=!1){const{d:et,a:_t}=e,at=r.BYTES;G=fe("pointHex",G,at),Fn("zip215",Q);const X=G.slice(),lt=G[at-1];X[at-1]=lt&-129;const E=Pn(X),ct=Q?w:r.ORDER;fr("pointHex.y",E,xe,ct);const ft=N(E*E),yt=N(ft-le),it=N(et*ft-_t);let{isValid:st,value:g}=R(yt,it);if(!st)throw new Error("Point.fromHex: invalid y coordinate");const s=(g&le)===le,h=(lt&128)!==0;if(!Q&&g===xe&&h)throw new Error("Point.fromHex: x=0 and x_0=1");return h!==s&&(g=N(-g)),V.fromAffine({x:g,y:E})}static fromPrivateKey(G){return nt(G).point}toRawBytes(){const{x:G,y:Q}=this.toAffine(),et=Wi(Q,r.BYTES);return et[et.length-1]|=G&le?128:0,et}toHex(){return Cr(this.toRawBytes())}}V.BASE=new V(e.Gx,e.Gy,le,N(e.Gx*e.Gy)),V.ZERO=new V(xe,le,le,xe);const{BASE:rt,ZERO:k}=V,W=gu(V,o*8);function D($){return Lt($,n)}function J($){return D(Pn($))}function nt($){const G=o;$=fe("private key",$,G);const Q=fe("hashed private key",a($),2*G),et=S(Q.slice(0,G)),_t=Q.slice(G,2*G),at=J(et),X=rt.multiply(at),lt=X.toRawBytes();return{head:et,prefix:_t,scalar:at,point:X,pointBytes:lt}}function tt($){return nt($).pointBytes}function dt($=new Uint8Array,...G){const Q=zt(...G);return J(a(b(Q,fe("context",$),!!i)))}function ut($,G,Q={}){$=fe("message",$),i&&($=i($));const{prefix:et,scalar:_t,pointBytes:at}=nt(G),X=dt(Q.context,et,$),lt=rt.multiply(X).toRawBytes(),E=dt(Q.context,lt,at,$),ct=D(X+E*_t);fr("signature.s",ct,xe,n);const ft=zt(lt,Wi(ct,r.BYTES));return fe("result",ft,o*2)}const I=E0;function F($,G,Q,et=I){const{context:_t,zip215:at}=et,X=r.BYTES;$=fe("signature",$,2*X),G=fe("message",G),at!==void 0&&Fn("zip215",at),i&&(G=i(G));const lt=Pn($.slice(X,2*X));let E,ct,ft;try{E=V.fromHex(Q,at),ct=V.fromHex($.slice(0,X),at),ft=rt.multiplyUnsafe(lt)}catch{return!1}if(!at&&E.isSmallOrder())return!1;const yt=dt(_t,ct.toRawBytes(),E.toRawBytes(),G);return ct.add(E.multiplyUnsafe(yt)).subtract(ft).clearCofactor().equals(V.ZERO)}return rt._setWindowSize(8),{CURVE:e,getPublicKey:tt,sign:ut,verify:F,ExtendedPoint:V,utils:{getExtendedPublicKey:nt,randomPrivateKey:()=>f(r.BYTES),precompute($=8,G=V.BASE){return G._setWindowSize($),G.multiply(BigInt(3)),G}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $a=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),xo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const N0=BigInt(1),vo=BigInt(2);BigInt(3);const T0=BigInt(5),O0=BigInt(8);function S0(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),a=$a,o=t*t%a*t%a,y=Be(o,vo,a)*o%a,w=Be(y,N0,a)*t%a,N=Be(w,T0,a)*w%a,A=Be(N,e,a)*N%a,R=Be(A,r,a)*A%a,S=Be(R,n,a)*R%a,b=Be(S,i,a)*S%a,q=Be(b,i,a)*S%a,M=Be(q,e,a)*N%a;return{pow_p_5_8:Be(M,vo,a)*t%a,b2:o}}function R0(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function A0(t,e){const r=$a,n=Lt(e*e*e,r),i=Lt(n*n*e,r),a=S0(t*i).pow_p_5_8;let f=Lt(t*n*a,r);const o=Lt(e*f*f,r),y=f,w=Lt(f*xo,r),N=o===t,A=o===Lt(-t,r),R=o===Lt(-t*xo,r);return N&&(f=y),(A||R)&&(f=w),yd(f,r)&&(f=Lt(-f,r)),{isValid:N||A,value:f}}const I0=Jn($a,void 0,!0),B0={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:I0,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:O0,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:w0,randomBytes:Zo,adjustScalarBytes:R0,uvRatio:A0},Hr=v0(B0);var No=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},oe=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ne,Rn,Ru,Au;class U0{constructor(e={}){ne.set(this,void 0),Rn.set(this,void 0),this[Ru]=this.entries.bind(this),this[Au]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=e,i=Date.now();No(this,ne,new Map([...r].map(([a,f])=>[a,{value:f,timestamp:i}])),"f"),No(this,Rn,n,"f")}prune(){const e=Date.now();for(const[r,n]of oe(this,ne,"f").entries())e-n.timestamp>oe(this,Rn,"f")&&oe(this,ne,"f").delete(r);return this}set(e,r){this.prune();const n={value:r,timestamp:Date.now()};return oe(this,ne,"f").set(e,n),this}get(e){const r=oe(this,ne,"f").get(e);if(r!==void 0){if(Date.now()-r.timestamp>oe(this,Rn,"f")){oe(this,ne,"f").delete(e);return}return r.value}}clear(){oe(this,ne,"f").clear()}entries(){const e=oe(this,ne,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=oe(this,ne,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return oe(this,ne,"f").keys()}forEach(e,r){for(const[n,i]of oe(this,ne,"f").entries())e.call(r,i.value,n,this)}has(e){return oe(this,ne,"f").has(e)}delete(e){return oe(this,ne,"f").delete(e)}get size(){return oe(this,ne,"f").size}}ne=new WeakMap,Rn=new WeakMap,Ru=Symbol.iterator,Au=Symbol.toStringTag;const To=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Oo=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},wa=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw new Error("Invalid length 0");if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},F0=(t,e)=>{const r=wa(t,e);if(r===1)return t[e];if(r===2)return t[e+1];if(r===3)return(t[e+1]<<8)+t[e+2];if(r===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Qi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function Iu(t,e){const r=2+To(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const a=new Uint8Array(1+To(n)+n);return a[i++]=48,i+=Oo(a,i,n),a.set(e,i),i+=e.byteLength,a[i++]=3,i+=Oo(a,i,t.byteLength+1),a[i++]=0,a.set(new Uint8Array(t),i),a}const Bu=(t,e)=>{let r=0;const n=(o,y)=>{if(i[r++]!==o)throw new Error("Expected: "+y)},i=new Uint8Array(t);if(n(48,"sequence"),r+=wa(i,r),!zn(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const a=F0(i,r)-1;r+=wa(i,r),n(0,"0 padding");const f=i.slice(r);if(a!==f.length)throw new Error(`DER payload mismatch: Expected length ${a} actual length ${f.length}`);return f};var So=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Ro=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ri,Ai;let Uu=class An{constructor(e){if(Ri.set(this,void 0),Ai.set(this,void 0),e.byteLength!==An.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");So(this,Ri,e,"f"),So(this,Ai,An.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new An(e)}static fromDer(e){return new An(this.derDecode(e))}static derEncode(e){return Iu(e,Qi).buffer}static derDecode(e){const r=Bu(e,Qi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return Ro(this,Ri,"f")}get derKey(){return Ro(this,Ai,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Ri=new WeakMap,Ai=new WeakMap;Uu.RAW_KEY_LENGTH=32;class P0{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(r=>r!==e)}notify(e,...r){this.observers.forEach(n=>n(e,...r))}}class V0 extends P0{constructor(){super()}print(e,...r){this.notify({message:e,level:"info"},...r)}warn(e,...r){this.notify({message:e,level:"warn"},...r)}error(e,r,...n){this.notify({message:e,level:"error",error:r},...n)}}var Ue=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},re=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Pe,Ii,Bi,Ui,Fi,Pi,Vi,ki,Kr;const Fu=.5,Pu=1.5,Vu=500,ku=6e4,Cu=9e5,Mu=10;class _s{constructor(e=_s.default){Pe.set(this,void 0),Ii.set(this,void 0),Bi.set(this,void 0),Ui.set(this,void 0),Fi.set(this,void 0),Pi.set(this,void 0),Vi.set(this,void 0),ki.set(this,void 0),Kr.set(this,0);const{initialInterval:r=Vu,randomizationFactor:n=Fu,multiplier:i=Pu,maxInterval:a=ku,maxElapsedTime:f=Cu,maxIterations:o=Mu,date:y=Date}=e;Ue(this,Pe,r,"f"),Ue(this,Ii,n,"f"),Ue(this,Bi,i,"f"),Ue(this,Ui,a,"f"),Ue(this,ki,y,"f"),Ue(this,Fi,y.now(),"f"),Ue(this,Pi,f,"f"),Ue(this,Vi,o,"f")}get ellapsedTimeInMsec(){return re(this,ki,"f").now()-re(this,Fi,"f")}get currentInterval(){return re(this,Pe,"f")}get count(){return re(this,Kr,"f")}get randomValueFromInterval(){const e=re(this,Ii,"f")*re(this,Pe,"f"),r=re(this,Pe,"f")-e,n=re(this,Pe,"f")+e;return Math.random()*(n-r)+r}incrementCurrentInterval(){var e;return Ue(this,Pe,Math.min(re(this,Pe,"f")*re(this,Bi,"f"),re(this,Ui,"f")),"f"),Ue(this,Kr,(e=re(this,Kr,"f"),e++,e),"f"),re(this,Pe,"f")}next(){return this.ellapsedTimeInMsec>=re(this,Pi,"f")||re(this,Kr,"f")>=re(this,Vi,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Pe=new WeakMap,Ii=new WeakMap,Bi=new WeakMap,Ui=new WeakMap,Fi=new WeakMap,Pi=new WeakMap,Vi=new WeakMap,ki=new WeakMap,Kr=new WeakMap;_s.default={initialInterval:Vu,randomizationFactor:Fu,multiplier:Pu,maxInterval:ku,maxElapsedTime:Cu,maxIterations:Mu,date:Date};var te=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ht=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ie,Tr,en,Ve,Ge,tn,In,zr,Ne,Te,Or,Sr,Bn,Yr,Wr,Rr,Br,$u,Ci,Mi,Ar,je;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(je||(je={}));const mi=60*1e3,k0="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",C0="aaaaa-aa",M0="ic0.app",$0=".ic0.app",q0="icp0.io",D0=".icp0.io",L0="icp-api.io",G0=".icp-api.io";class Ks extends Gt{constructor(e){super(e),this.message=e}}class gi extends Gt{constructor(e){super(e),this.message=e}}function j0(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw new Ks("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw new Ks("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new Ks("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function H0(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,a=i?.hostname;let f;a&&typeof a=="string"&&(n.some(o=>a.endsWith(o))?f=a:f=r.find(o=>a.endsWith(o))),i&&f?e=new URL(`${i.protocol}//${f}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class Ur{constructor(e={}){var r,n;ie.add(this),Tr.set(this,null),en.set(this,!1),Ve.set(this,void 0),Ge.set(this,void 0),tn.set(this,void 0),In.set(this,void 0),zr.set(this,0),Ne.set(this,void 0),Te.set(this,void 0),Or.set(this,void 0),Sr.set(this,void 0),this._isAgent=!0,this.config={},Bn.set(this,0),this.log=new V0,Yr.set(this,[]),Wr.set(this,[]),Rr.set(this,new U0({expirationTime:5*60*1e3})),Br.set(this,!0),Mi.set(this,(f,o)=>{if(ht(this,Br,"f")===!1)return f;if(!o)throw new Ce("Invalid signature from replica signed query: no matching node key found.");const{status:y,signatures:w=[],requestId:N}=f,A=new TextEncoder().encode("\vic-response");for(const R of w){const{timestamp:S,identity:b}=R,q=Nt.fromUint8Array(b).toText();let M;if(y==="replied"){const{reply:k}=f;M=Yi({status:y,reply:k,timestamp:BigInt(S),request_id:N})}else if(y==="rejected"){const{reject_code:k,reject_message:W,error_code:D}=f;M=Yi({status:y,reject_code:k,reject_message:W,error_code:D,timestamp:BigInt(S),request_id:N})}else throw new Error(`Unknown status: ${y}`);const z=Re(A,new Uint8Array(M)),j=o?.nodeKeys.get(q);if(!j)throw new Ce("Invalid signature from replica signed query: no matching node key found.");const V=Uu.fromDer(j).rawKey;if(Hr.verify(R.signature,new Uint8Array(z),new Uint8Array(V)))return f;throw new Ce(`Invalid signature from replica ${q} signed query.`)}return f}),this.config=e,te(this,Ge,e.fetch||j0()||fetch.bind(global),"f"),te(this,tn,e.fetchOptions,"f"),te(this,In,e.callOptions,"f"),te(this,en,(r=e.shouldFetchRootKey)!==null&&r!==void 0?r:!1,"f"),e.rootKey?this.rootKey=e.rootKey:ht(this,en,"f")?this.rootKey=null:this.rootKey=We(k0);const i=H0(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&te(this,Br,e.verifyQuerySignatures,"f"),te(this,Te,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const a=()=>new _s({maxIterations:ht(this,Te,"f")});if(te(this,Or,e.backoffStrategy||a,"f"),this.host.hostname.endsWith($0)?this.host.hostname=M0:this.host.hostname.endsWith(D0)?this.host.hostname=q0:this.host.hostname.endsWith(G0)&&(this.host.hostname=L0),e.credentials){const{name:f,password:o}=e.credentials;te(this,Ne,`${f}${o?":"+o:""}`,"f")}if(te(this,Ve,Promise.resolve(e.identity||new $n),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Gt(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Gt(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);te(this,Sr,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",no(ha)),e.useQueryNonces&&this.addTransform("query",no(ha)),e.logToConsole&&this.log.subscribe(f=>{f.level==="error"?console.error(f.message):f.level==="warn"?console.warn(f.message):console.log(f.message)})}get waterMark(){return ht(this,Bn,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const r=Ur.createSync(e),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(e){var r;try{return"config"in e?await Ur.create(e.config):await Ur.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(r=e._identity)!==null&&r!==void 0?r:void 0})}catch{throw new Gt("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,r,n=r.priority||0){if(e==="update"){const i=ht(this,Wr,"f").findIndex(a=>(a.priority||0)<n);ht(this,Wr,"f").splice(i>=0?i:ht(this,Wr,"f").length,0,Object.assign(r,{priority:n}))}else if(e==="query"){const i=ht(this,Yr,"f").findIndex(a=>(a.priority||0)<n);ht(this,Yr,"f").splice(i>=0?i:ht(this,Yr,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!ht(this,Ve,"f"))throw new gi("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ht(this,Ve,"f")).getPrincipal()}async call(e,r,n){var i,a;await ht(this,ie,"m",Ar).call(this);const f=(i=r.callSync)!==null&&i!==void 0?i:!0,o=await(n!==void 0?await n:await ht(this,Ve,"f"));if(!o)throw new gi("This identity has expired due this application's security policy. Please refresh your authentication.");const y=Nt.from(e),w=r.effectiveCanisterId?Nt.from(r.effectiveCanisterId):y,N=o.getPrincipal()||Nt.anonymous();let A=new fi(ht(this,Sr,"f")*mi);Math.abs(ht(this,zr,"f"))>1e3*30&&(A=new fi(ht(this,Sr,"f")*mi+ht(this,zr,"f")));const R={request_type:da.Call,canister_id:y,method_name:r.methodName,arg:r.arg,sender:N,ingress_expiry:A};let S=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,Ne,"f")?{Authorization:"Basic "+btoa(ht(this,Ne,"f"))}:{})},endpoint:"call",body:R});const b=S.body.nonce?q(S.body.nonce):void 0;R.nonce=b;function q(V){return new Uint8Array(V)}S=await o.transformRequest(S);const M=Ms(S.body),z=ht(this,Or,"f").call(this),j=Mn(R);try{const V=()=>(this.log.print(`fetching "/api/v3/canister/${w.toText()}/call" with request:`,S),ht(this,Ge,"f").call(this,""+new URL(`/api/v3/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,In,"f")),S.request),{body:M}))),rt=()=>(this.log.print(`fetching "/api/v2/canister/${w.toText()}/call" with request:`,S),ht(this,Ge,"f").call(this,""+new URL(`/api/v2/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,In,"f")),S.request),{body:M}))),W=await ht(this,ie,"m",Ci).call(this,{request:f?V:rt,backoff:z,tries:0}),D=await W.arrayBuffer(),J=W.status===200&&D.byteLength>0?ze(D):null;if(J&&"certificate"in J){const nt=await this.parseTimeFromResponse({certificate:J.certificate});te(this,Bn,nt,"f")}return{requestId:j,response:{ok:W.ok,status:W.status,statusText:W.statusText,body:J,headers:On(W.headers)},requestDetails:R}}catch(V){if(V.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},r),{callSync:!1}),n);const rt=`Error while making call: ${(a=V.message)!==null&&a!==void 0?a:String(V)}`,k=new sd(rt,V,Mt(j),Mt(S.body.sender_pubkey),Mt(S.body.sender_sig),String(S.body.content.ingress_expiry._value));throw this.log.error(rt,k),k}}async query(e,r,n){var i,a,f,o;await ht(this,ie,"m",Ar).call(this);const y=ht(this,Or,"f").call(this),w=r.effectiveCanisterId?Nt.from(r.effectiveCanisterId):Nt.from(e);this.log.print(`ecid ${w.toString()}`),this.log.print(`canisterId ${e.toString()}`);let N,A;const R=await(n!==void 0?n:ht(this,Ve,"f"));if(!R)throw new gi("This identity has expired due this application's security policy. Please refresh your authentication.");const S=Nt.from(e),b=R?.getPrincipal()||Nt.anonymous(),q={request_type:"query",canister_id:S,method_name:r.methodName,arg:r.arg,sender:b,ingress_expiry:new fi(ht(this,Sr,"f")*mi)},M=Mn(q);N=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,Ne,"f")?{Authorization:"Basic "+btoa(ht(this,Ne,"f"))}:{})},endpoint:"read",body:q}),N=await R?.transformRequest(N);const z=Ms(N.body),j={canister:S.toText(),ecid:w,transformedRequest:N,body:z,requestId:M,backoff:y,tries:0},V=async()=>({requestDetails:q,query:await ht(this,ie,"m",$u).call(this,j)}),rt=async()=>{if(!ht(this,Br,"f"))return;const k=ht(this,Rr,"f").get(w.toString());return k||(await this.fetchSubnetKeys(w.toString()),ht(this,Rr,"f").get(w.toString()))};try{const[k,W]=await Promise.all([V(),rt()]);A=k;const{requestDetails:D,query:J}=A,nt=Object.assign(Object.assign({},J),{requestDetails:D});if(this.log.print("Query response:",nt),!ht(this,Br,"f"))return nt;try{return ht(this,Mi,"f").call(this,nt,W)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ht(this,Rr,"f").delete(e.toString()),await this.fetchSubnetKeys(w.toString());const dt=ht(this,Rr,"f").get(e.toString());if(!dt)throw new Ce("Invalid signature from replica signed query: no matching node key found.");return ht(this,Mi,"f").call(this,nt,dt)}}catch(k){const W=`Error while making call: ${(i=k.message)!==null&&i!==void 0?i:String(k)}`,D=new ad(W,k,String(M),Mt((a=N?.body)===null||a===void 0?void 0:a.sender_pubkey),Mt((f=N?.body)===null||f===void 0?void 0:f.sender_sig),String((o=N?.body)===null||o===void 0?void 0:o.content.ingress_expiry._value));throw this.log.error(W,D),D}}async createReadStateRequest(e,r){await ht(this,ie,"m",Ar).call(this);const n=await(r!==void 0?await r:await ht(this,Ve,"f"));if(!n)throw new gi("This identity has expired due this application's security policy. Please refresh your authentication.");const i=n?.getPrincipal()||Nt.anonymous(),a=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,Ne,"f")?{Authorization:"Basic "+btoa(ht(this,Ne,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new fi(ht(this,Sr,"f")*mi)}});return n?.transformRequest(a)}async readState(e,r,n,i){var a,f,o,y;function w(q){for(const M of q.paths){const[z,j]=M,V=new TextEncoder().encode("request_status");if(zn(z,V))return j}}const N=w(r);await ht(this,ie,"m",Ar).call(this);const A=typeof e=="string"?Nt.fromText(e):e,R=i??await this.createReadStateRequest(r,n),S=Ms(R.body);this.log.print(`fetching "/api/v2/canister/${A}/read_state" with request:`,R);const b=ht(this,Or,"f").call(this);try{const q=await ht(this,ie,"m",Ci).call(this,{request:()=>ht(this,Ge,"f").call(this,""+new URL(`/api/v2/canister/${A.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,tn,"f")),R.request),{body:S})),backoff:b,tries:0});if(!q.ok)throw new Error(`Server returned an error:
  Code: ${q.status} (${q.statusText})
  Body: ${await q.text()}
`);const M=ze(await q.arrayBuffer());this.log.print("Read state response:",M);const z=await this.parseTimeFromResponse(M);return z>0&&(this.log.print("Read state response time:",z),te(this,Bn,z,"f")),M}catch(q){const M=`Caught exception while attempting to read state: ${(a=q.message)!==null&&a!==void 0?a:String(q)}`,z=new od(M,q,String(N),Mt((f=R?.body)===null||f===void 0?void 0:f.sender_pubkey),Mt((o=R?.body)===null||o===void 0?void 0:o.sender_sig),String((y=R?.body)===null||y===void 0?void 0:y.content.ingress_expiry._value));throw this.log.error(M,z),z}}async parseTimeFromResponse(e){let r;if(e.certificate){const n=ze(e.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=an(["time"],r);if(i.status!==Yt.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const a=Ma(Oa(i.value));return this.log.print("Time from response:",a),this.log.print("Time from response in milliseconds:",Number(a)),Number(a)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await ht(this,ie,"m",Ar).call(this);const r=await ll(()=>Promise.resolve().then(()=>Yd),void 0,import.meta.url),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=Ur.createSync({identity:new $n,host:this.host.toString(),fetch:ht(this,Ge,"f"),retryTimes:0}),f=(await r.request({canisterId:e??Nt.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");f&&(te(this,zr,Number(f)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${ht(this,zr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=ht(this,Ne,"f")?{Authorization:"Basic "+btoa(ht(this,Ne,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=ht(this,Or,"f").call(this),n=await ht(this,ie,"m",Ci).call(this,{backoff:r,request:()=>ht(this,Ge,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},ht(this,tn,"f"))),tries:0});return ze(await n.arrayBuffer())}async fetchRootKey(){let e;return ht(this,Tr,"f")?e=await ht(this,Tr,"f"):(te(this,Tr,new Promise((r,n)=>{this.status().then(i=>{const a=i.root_key;this.rootKey=a,r(a)}).catch(n)}),"f"),e=await ht(this,Tr,"f")),te(this,Tr,null,"f"),e}invalidateIdentity(){te(this,Ve,null,"f")}replaceIdentity(e){te(this,Ve,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await ht(this,ie,"m",Ar).call(this);const r=Nt.from(e),i=(await Nu({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ht(this,Rr,"f").set(r.toText(),i),i}_transform(e){let r=Promise.resolve(e);if(e.endpoint==="call")for(const n of ht(this,Wr,"f"))r=r.then(i=>n(i).then(a=>a||i));else for(const n of ht(this,Yr,"f"))r=r.then(i=>n(i).then(a=>a||i));return r}}Tr=new WeakMap,en=new WeakMap,Ve=new WeakMap,Ge=new WeakMap,tn=new WeakMap,In=new WeakMap,zr=new WeakMap,Ne=new WeakMap,Te=new WeakMap,Or=new WeakMap,Sr=new WeakMap,Bn=new WeakMap,Yr=new WeakMap,Wr=new WeakMap,Rr=new WeakMap,Br=new WeakMap,Mi=new WeakMap,ie=new WeakSet,$u=async function t(e){var r,n;const{ecid:i,transformedRequest:a,body:f,requestId:o,backoff:y,tries:w}=e,N=w===0?0:y.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:w,backoff:y,delay:N}),N===null)throw new Gt(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,Te,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);N>0&&await new Promise(b=>setTimeout(b,N));let A;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,a);const b=await ht(this,Ge,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,tn,"f")),a.request),{body:f}));if(b.status===200){const q=ze(await b.arrayBuffer());A=Object.assign(Object.assign({},q),{httpDetails:{ok:b.ok,status:b.status,statusText:b.statusText,headers:On(b.headers)},requestId:o})}else throw new $s(`Gateway returned an error:
  Code: ${b.status} (${b.statusText})
  Body: ${await b.text()}
`,{ok:b.ok,status:b.status,statusText:b.statusText,headers:On(b.headers)})}catch(b){if(w<ht(this,Te,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${b}
  Retrying query.`),await ht(this,ie,"m",t).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw b}const R=(n=(r=A.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!ht(this,Br,"f"))return A;if(!R)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const S=Number(BigInt(R)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:S}),Number(this.waterMark)>S){const b=new Gt("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",b,{timestamp:R,waterMark:this.waterMark}),w<ht(this,Te,"f"))return await ht(this,ie,"m",t).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw new Gt(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,Te,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return A},Ci=async function t(e){const{request:r,backoff:n,tries:i}=e,a=i===0?0:n.next();if(a===null)throw new Gt(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,Te,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);a>0&&await new Promise(w=>setTimeout(w,a));let f;try{f=await r()}catch(w){if(ht(this,Te,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${w}
  Retrying request.`),await ht(this,ie,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw w}if(f.ok)return f;const o=await f.clone().text(),y=`Server returned an error:
  Code: ${f.status} (${f.statusText})
  Body: ${o}
`;if(f.status===404&&f.url.includes("api/v3"))throw new $s("v3 api not supported. Fall back to v2",{ok:f.ok,status:f.status,statusText:f.statusText,headers:On(f.headers)});if(i<ht(this,Te,"f"))return await ht(this,ie,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new $s(y,{ok:f.ok,status:f.status,statusText:f.statusText,headers:On(f.headers)})},Ar=async function(){if(!this.rootKey)if(this.rootKey===null&&ht(this,en,"f"))await this.fetchRootKey();else throw new Gt(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ht(this,en,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Ao;(function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"})(Ao||(Ao={}));function Io(){const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}const K0=5*60*1e3;function qu(){return X0(Y0(z0(),1e3),Z0(1e3,1.2),W0(K0))}function z0(){let t=!0;return async()=>t?(t=!1,!0):!1}function Y0(t,e){return async(r,n,i)=>{if(await t(r,n,i))return new Promise(a=>setTimeout(a,e))}}function W0(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:
  Request ID: ${Mt(n)}
  Request status: ${i}
`)}}function Z0(t,e){let r=t;return()=>new Promise(n=>setTimeout(()=>{r*=e,n()},r))}function X0(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}async function Du(t,e,r,n=qu(),i,a){var f;const o=[new TextEncoder().encode("request_status"),r],y=i??await((f=t.createReadStateRequest)===null||f===void 0?void 0:f.call(t,{paths:[o]})),w=await t.readState(e,{paths:[o]},void 0,y);if(t.rootKey==null)throw new Error("Agent root key not initialized before polling");const N=await Fr.create({certificate:w.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:a}),A=ge(N.lookup([...o,new TextEncoder().encode("status")]));let R;switch(typeof A>"u"?R=je.Unknown:R=new TextDecoder().decode(A),R){case je.Replied:return{reply:ge(N.lookup([...o,"reply"])),certificate:N};case je.Received:case je.Unknown:case je.Processing:return await n(e,r,R),Du(t,e,r,n,y,a);case je.Rejected:{const S=new Uint8Array(ge(N.lookup([...o,"reject_code"])))[0],b=new TextDecoder().decode(ge(N.lookup([...o,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${Mt(r)}
  Reject code: ${S}
  Reject text: ${b}
`)}case je.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${Mt(r)}
`)}throw new Error("unreachable")}const J0=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,a=i,f=t.Nat32,o=t.Record({start_height:f,end_height:t.Opt(f),network:e}),y=t.Vec(t.Nat8),w=t.Record({tip_height:f,block_headers:t.Vec(y)}),N=t.Record({network:e}),A=t.Nat64,R=t.Vec(A),S=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),b=t.Vec(t.Nat8),q=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),M=t.Record({height:t.Nat32,value:i,outpoint:q}),z=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:f,tip_block_hash:b,utxos:t.Vec(M)}),j=t.Record({transaction:t.Vec(t.Nat8),network:e}),V=t.Principal,rt=t.Record({canister_id:V,num_requested_changes:t.Opt(t.Nat64)}),k=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),W=t.Vec(t.Nat8),D=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:W}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),J=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:k,details:D}),nt=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(J),total_num_changes:t.Nat64}),tt=t.Record({canister_id:V}),dt=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),ut=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:dt,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),I=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:ut,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),F=t.Record({canister_id:V}),Y=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(dt),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),$=t.Record({settings:t.Opt(Y),sender_canister_version:t.Opt(t.Nat64)}),G=t.Record({canister_id:V}),Q=t.Record({canister_id:V}),et=t.Record({canister_id:V,snapshot_id:W}),_t=t.Record({canister_id:V}),at=t.Variant({secp256k1:t.Null}),X=t.Record({key_id:t.Record({name:t.Text,curve:at}),canister_id:t.Opt(V),derivation_path:t.Vec(t.Vec(t.Nat8))}),lt=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),E=t.Record({canister_id:V}),ct=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),ft=t.Record({canister_log_records:t.Vec(ct)}),yt=t.Record({value:t.Text,name:t.Text}),it=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(yt)}),st=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:it})],[it],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(yt)}),g=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),s=t.Record({hash:t.Vec(t.Nat8)}),h=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:g,chunk_hashes_list:t.Vec(s),target_canister:V,store_canister:t.Opt(V),sender_canister_version:t.Opt(t.Nat64)}),x=t.Vec(t.Nat8),T=t.Record({arg:t.Vec(t.Nat8),wasm_module:x,mode:g,canister_id:V,sender_canister_version:t.Opt(t.Nat64)}),U=t.Record({canister_id:V}),p=t.Record({id:W,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),c=t.Vec(p),u=t.Record({canister_id:V,sender_canister_version:t.Opt(t.Nat64),snapshot_id:W}),m=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),v=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),B=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(v)})),L=t.Record({settings:t.Opt(Y),specified_id:t.Opt(V),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),Z=t.Record({canister_id:V}),ot=t.Record({canister_id:V,amount:t.Nat}),pt=t.Vec(t.Nat8),gt=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),_=t.Record({key_id:t.Record({algorithm:gt,name:t.Text}),canister_id:t.Opt(V),derivation_path:t.Vec(t.Vec(t.Nat8))}),l=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),d=t.Record({key_id:t.Record({name:t.Text,curve:at}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),O=t.Record({signature:t.Vec(t.Nat8)}),C=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),K=t.Record({aux:t.Opt(C),key_id:t.Record({algorithm:gt,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),H=t.Record({signature:t.Vec(t.Nat8)}),wt=t.Record({canister_id:V}),vt=t.Record({canister_id:V}),xt=t.Record({canister_id:V}),Et=t.Vec(s),At=t.Record({subnet_id:t.Principal}),Ut=t.Record({replica_version:t.Text}),br=t.Record({replace_snapshot:t.Opt(W),canister_id:V}),Er=p,xr=t.Record({canister_id:V,sender_canister_version:t.Opt(t.Nat64)}),vr=t.Record({canister_id:t.Principal,settings:Y,sender_canister_version:t.Opt(t.Nat64)}),be=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),pe=s;return t.Service({bitcoin_get_balance:t.Func([n],[a],[]),bitcoin_get_block_headers:t.Func([o],[w],[]),bitcoin_get_current_fee_percentiles:t.Func([N],[R],[]),bitcoin_get_utxos:t.Func([S],[z],[]),bitcoin_send_transaction:t.Func([j],[],[]),canister_info:t.Func([rt],[nt],[]),canister_status:t.Func([tt],[I],[]),clear_chunk_store:t.Func([F],[],[]),create_canister:t.Func([$],[G],[]),delete_canister:t.Func([Q],[],[]),delete_canister_snapshot:t.Func([et],[],[]),deposit_cycles:t.Func([_t],[],[]),ecdsa_public_key:t.Func([X],[lt],[]),fetch_canister_logs:t.Func([E],[ft],["query"]),http_request:t.Func([st],[it],[]),install_chunked_code:t.Func([h],[],[]),install_code:t.Func([T],[],[]),list_canister_snapshots:t.Func([U],[c],[]),load_canister_snapshot:t.Func([u],[],[]),node_metrics_history:t.Func([m],[B],[]),provisional_create_canister_with_cycles:t.Func([L],[Z],[]),provisional_top_up_canister:t.Func([ot],[],[]),raw_rand:t.Func([],[pt],[]),schnorr_public_key:t.Func([_],[l],[]),sign_with_ecdsa:t.Func([d],[O],[]),sign_with_schnorr:t.Func([K],[H],[]),start_canister:t.Func([wt],[],[]),stop_canister:t.Func([vt],[],[]),stored_chunks:t.Func([xt],[Et],[]),subnet_info:t.Func([At],[Ut],[]),take_canister_snapshot:t.Func([br],[Er],[]),uninstall_code:t.Func([xr],[],[]),update_settings:t.Func([vr],[],[]),upload_chunk:t.Func([be],[pe],[])})};class Lu extends Gt{constructor(e,r,n,i){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(a=>`  "${a}": ${JSON.stringify(i[a])}`)].join(`
`)),this.canisterId=e,this.methodName=r,this.type=n,this.props=i}}class Q0 extends Lu{constructor(e,r,n){var i;super(e,r,"query",{Status:n.status,Code:(i=ra[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class Bo extends Lu{constructor(e,r,n,i,a,f,o){super(e,r,"update",Object.assign({"Request ID":Mt(n)},i.body?Object.assign(Object.assign({},o?{"Error code":o}:{}),{"Reject code":String(a),"Reject message":f}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=a,this.reject_message=f,this.error_code=o}}const me=Symbol.for("ic-agent-metadata");class Gn{constructor(e){this[me]=Object.freeze(e)}static agentOf(e){return e[me].config.agent}static interfaceOf(e){return e[me].service}static canisterIdOf(e){return Nt.from(e[me].config.canisterId)}static async install(e,r){const n=e.mode===void 0?{install:null}:e.mode,i=e.arg?[...new Uint8Array(e.arg)]:[],a=[...new Uint8Array(e.module)],f=typeof r.canisterId=="string"?Nt.fromText(r.canisterId):r.canisterId;await Uo(r).install_code({mode:n,arg:i,wasm_module:a,canister_id:f,sender_canister_version:[]})}static async createCanister(e,r){function n(a){return[{controllers:a.controllers?[a.controllers]:[],compute_allocation:a.compute_allocation?[a.compute_allocation]:[],freezing_threshold:a.freezing_threshold?[a.freezing_threshold]:[],memory_allocation:a.memory_allocation?[a.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await Uo(e||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(e,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(e,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(e,r){const n=e({IDL:ef});class i extends Gn{constructor(f){if(!f.canisterId)throw new Gt(`Canister ID is required, but received ${typeof f.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const o=typeof f.canisterId=="string"?Nt.fromText(f.canisterId):f.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Gu),f),{canisterId:o}),service:n});for(const[y,w]of n._fields)r?.httpDetails&&w.annotations.push(ba),r?.certificate&&w.annotations.push(ju),this[y]=th(this,y,w,f.blsVerify)}}return i}static createActor(e,r){if(!r.canisterId)throw new Gt(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(r)}static createActorWithHttpDetails(e,r){return new(this.createActorClass(e,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(e,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,n))(r)}}function Gr(t,e){const r=dc(t,Ko.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Gu={pollingStrategyFactory:qu},ba="http-details",ju="certificate";function th(t,e,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(f,...o)=>{var y,w;f=Object.assign(Object.assign({},f),(w=(y=t[me].config).queryTransform)===null||w===void 0?void 0:w.call(y,e,o,Object.assign(Object.assign({},t[me].config),f)));const N=f.agent||t[me].config.agent||Io(),A=Nt.from(f.canisterId||t[me].config.canisterId),R=ia(r.argTypes,o),S=await N.query(A,{methodName:e,arg:R,effectiveCanisterId:f.effectiveCanisterId}),b=Object.assign(Object.assign({},S.httpDetails),{requestDetails:S.requestDetails});switch(S.status){case"rejected":throw new Q0(A,e,S);case"replied":return r.annotations.includes(ba)?{httpDetails:b,result:Gr(r.retTypes,S.reply.arg)}:Gr(r.retTypes,S.reply.arg)}}:i=async(f,...o)=>{var y,w;f=Object.assign(Object.assign({},f),(w=(y=t[me].config).callTransform)===null||w===void 0?void 0:w.call(y,e,o,Object.assign(Object.assign({},t[me].config),f)));const N=f.agent||t[me].config.agent||Io(),{canisterId:A,effectiveCanisterId:R,pollingStrategyFactory:S}=Object.assign(Object.assign(Object.assign({},Gu),t[me].config),f),b=Nt.from(A),q=R!==void 0?Nt.from(R):b,M=ia(r.argTypes,o),{requestId:z,response:j,requestDetails:V}=await N.call(b,{methodName:e,arg:M,effectiveCanisterId:q});let rt,k;if(j.body&&j.body.certificate){if(N.rootKey==null)throw new Error("Agent is missing root key");const nt=j.body.certificate;k=await Fr.create({certificate:Hi(nt),rootKey:N.rootKey,canisterId:Nt.from(A),blsVerify:n});const tt=[new TextEncoder().encode("request_status"),z];switch(new TextDecoder().decode(ge(k.lookup([...tt,"status"])))){case"replied":rt=ge(k.lookup([...tt,"reply"]));break;case"rejected":{const ut=new Uint8Array(ge(k.lookup([...tt,"reject_code"])))[0],I=new TextDecoder().decode(ge(k.lookup([...tt,"reject_message"]))),F=ge(k.lookup([...tt,"error_code"])),Y=F?new TextDecoder().decode(F):void 0;throw new Bo(b,e,z,j,ut,I,Y)}}}else if(j.body&&"reject_message"in j.body){const{reject_code:nt,reject_message:tt,error_code:dt}=j.body;throw new Bo(b,e,z,j,nt,tt,dt)}if(j.status===202){const nt=S(),tt=await Du(N,q,z,nt,n);k=tt.certificate,rt=tt.reply}const W=r.annotations.includes(ba),D=r.annotations.includes(ju),J=Object.assign(Object.assign({},j),{requestDetails:V});if(rt!==void 0)return W&&D?{httpDetails:J,certificate:k,result:Gr(r.retTypes,rt)}:D?{certificate:k,result:Gr(r.retTypes,rt)}:W?{httpDetails:J,result:Gr(r.retTypes,rt)}:Gr(r.retTypes,rt);if(r.retTypes.length===0)return W?{httpDetails:j,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const a=(...f)=>i({},...f);return a.withOptions=f=>(...o)=>i(f,...o),a}function Uo(t){function e(r,n){if(t.effectiveCanisterId)return{effectiveCanisterId:Nt.from(t.effectiveCanisterId)};const i=n[0];let a=Nt.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(a=Nt.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(a=Nt.from(i.canister_id)),{effectiveCanisterId:a}}return Gn.createActor(J0,Object.assign(Object.assign(Object.assign({},t),{canisterId:Nt.fromHex("")}),{callTransform:e,queryTransform:e}))}var ts=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ur=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},$i,qi,Zr,Xr;function Fo(t){return t!==null&&typeof t=="object"}class Ye{constructor(e){if($i.set(this,void 0),qi.set(this,void 0),e.byteLength!==Ye.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");ts(this,$i,e,"f"),ts(this,qi,Ye.derEncode(e),"f")}static from(e){if(typeof e=="string"){const r=We(e);return this.fromRaw(r)}else if(Fo(e)){const r=e;if(Fo(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw(Oa(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Ye(e)}static fromDer(e){return new Ye(this.derDecode(e))}static derEncode(e){const r=Iu(e,Qi).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(e){const r=Bu(e,Qi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return ur(this,$i,"f")}get derKey(){return ur(this,qi,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}$i=new WeakMap,qi=new WeakMap;Ye.RAW_KEY_LENGTH=32;class pr extends Fa{constructor(e,r){super(),Zr.set(this,void 0),Xr.set(this,void 0),ts(this,Zr,Ye.from(e),"f"),ts(this,Xr,new Uint8Array(r),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=Hr.utils.randomPrivateKey()),zn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(e)[i];const n=Hr.getPublicKey(r);return pr.fromKeyPair(n,r)}static fromParsedJson(e){const[r,n]=e;return new pr(Ye.fromDer(We(r)),We(n))}static fromJSON(e){const r=JSON.parse(e);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,r){return new pr(Ye.fromRaw(e),r)}static fromSecretKey(e){const r=Hr.getPublicKey(new Uint8Array(e));return pr.fromKeyPair(r,e)}toJSON(){return[Mt(ur(this,Zr,"f").toDer()),Mt(ur(this,Xr,"f"))]}getKeyPair(){return{secretKey:ur(this,Xr,"f"),publicKey:ur(this,Zr,"f")}}getPublicKey(){return ur(this,Zr,"f")}async sign(e){const r=new Uint8Array(e),n=Un(Hr.sign(r,ur(this,Xr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,r,n){const[i,a,f]=[e,r,n].map(o=>(typeof o=="string"&&(o=We(o)),o instanceof Uint8Array&&(o=o.buffer),new Uint8Array(o)));return Hr.verify(a,i,f)}}Zr=new WeakMap,Xr=new WeakMap;class qa extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,qa.prototype)}}function Po(t){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new qa("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class es extends Fa{constructor(e,r,n){super(),this._keyPair=e,this._derKey=r,this._subtleCrypto=n}static async generate(e){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},a=Po(i),f=await a.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),o=await a.exportKey("spki",f.publicKey);return new this(f,o,a)}static async fromKeyPair(e,r){const n=Po(r),i=await n.exportKey("spki",e.publicKey);return new es(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return e},r}async sign(e){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,e)}}var eh=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Nn=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ar;class rh{constructor(e){ar.set(this,void 0),eh(this,ar,e,"f")}get rawKey(){return Nn(this,ar,"f").rawKey}get derKey(){return Nn(this,ar,"f").derKey}toDer(){return Nn(this,ar,"f").toDer()}getPublicKey(){return Nn(this,ar,"f")}getPrincipal(){return Nt.from(Nn(this,ar,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}ar=new WeakMap;var nh=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ih=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},sh=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Di;const ah=new TextEncoder().encode("ic-request-auth-delegation"),oh=new TextEncoder().encode(`
ic-request`);function zs(t){if(typeof t!="string"||t.length<64)throw new Error("Invalid public key.");return We(t)}class Da{constructor(e,r,n){this.pubkey=e,this.expiration=r,this.targets=n}toCBOR(){return de.value.map(Object.assign({pubkey:de.value.bytes(this.pubkey),expiration:de.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:de.value.array(this.targets.map(e=>de.value.bytes(e.toUint8Array())))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Mt(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function ch(t,e,r,n){const i=new Da(e.toDer(),BigInt(+r)*BigInt(1e6),n),a=new Uint8Array([...ah,...new Uint8Array(Mn(Object.assign({},i)))]),f=await t.sign(a);return{delegation:i,signature:f}}class rs{constructor(e,r){this.delegations=e,this.publicKey=r}static async create(e,r,n=new Date(Date.now()+15*60*1e3),i={}){var a,f;const o=await ch(e,r,n,i.targets);return new rs([...((a=i.previous)===null||a===void 0?void 0:a.delegations)||[],o],((f=i.previous)===null||f===void 0?void 0:f.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:r,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(a=>{const{delegation:f,signature:o}=a,{pubkey:y,expiration:w,targets:N}=f;if(N!==void 0&&!Array.isArray(N))throw new Error("Invalid targets.");return{delegation:new Da(zs(y),BigInt("0x"+w),N&&N.map(A=>{if(typeof A!="string")throw new Error("Invalid target.");return Nt.fromHex(A)})),signature:zs(o)}});return new this(i,zs(r))}static fromDelegations(e,r){return new this(e,r)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:r,signature:n}=e,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:Mt(r.pubkey)},i&&{targets:i.map(a=>a.toHex())}),signature:Mt(n)}}),publicKey:Mt(this.publicKey)}}}class Vo extends Fa{constructor(e,r){super(),this._inner=e,this._delegation=r}static fromDelegation(e,r){return new this(e,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:r}=e,n=sh(e,["body"]),i=await Mn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(new Uint8Array([...oh,...new Uint8Array(i)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class ns extends rh{constructor(e,r){super(e),Di.set(this,void 0),nh(this,Di,r,"f")}get delegation(){return ih(this,Di,"f")}static fromDelegation(e,r){return new ns(e,r)}}Di=new WeakMap;function uh(t,e){for(const{delegation:n}of t.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[];for(const n of r){const i=n.toText();for(const{delegation:a}of t.delegations){if(a.targets===void 0)continue;let f=!0;for(const o of a.targets)if(o.toText()===i){f=!1;break}if(f)return!1}}return!0}var ko;(function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(ko||(ko={}));const Co=["mousedown","mousemove","keydown","touchstart","wheel"];class Mo{constructor(e={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const a=this._resetTimer.bind(this);window.addEventListener("load",a,!0),Co.forEach(function(o){document.addEventListener(o,a,!0)});const f=(o,y)=>{let w;return(...N)=>{const A=this,R=function(){w=void 0,o.apply(A,N)};clearTimeout(w),w=window.setTimeout(R,y)}};if(e?.captureScroll){const o=f(a,(r=e?.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",o,!0)}a()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);Co.forEach(function(r){document.removeEventListener(r,e,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const lh=(t,e)=>e.some(r=>t instanceof r);let $o,qo;function fh(){return $o||($o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dh(){return qo||(qo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hu=new WeakMap,Ea=new WeakMap,Ku=new WeakMap,Ys=new WeakMap,La=new WeakMap;function hh(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",f)},a=()=>{r(yr(t.result)),i()},f=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",f)});return e.then(r=>{r instanceof IDBCursor&&Hu.set(r,t)}).catch(()=>{}),La.set(e,t),e}function ph(t){if(Ea.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",f),t.removeEventListener("abort",f)},a=()=>{r(),i()},f=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",f),t.addEventListener("abort",f)});Ea.set(t,e)}let xa={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ea.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ku.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return yr(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _h(t){xa=t(xa)}function yh(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Ws(this),e,...r);return Ku.set(n,e.sort?e.sort():[e]),yr(n)}:dh().includes(t)?function(...e){return t.apply(Ws(this),e),yr(Hu.get(this))}:function(...e){return yr(t.apply(Ws(this),e))}}function mh(t){return typeof t=="function"?yh(t):(t instanceof IDBTransaction&&ph(t),lh(t,fh())?new Proxy(t,xa):t)}function yr(t){if(t instanceof IDBRequest)return hh(t);if(Ys.has(t))return Ys.get(t);const e=mh(t);return e!==t&&(Ys.set(t,e),La.set(e,t)),e}const Ws=t=>La.get(t);function gh(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const f=indexedDB.open(t,e),o=yr(f);return n&&f.addEventListener("upgradeneeded",y=>{n(yr(f.result),y.oldVersion,y.newVersion,yr(f.transaction),y)}),r&&f.addEventListener("blocked",y=>r(y.oldVersion,y.newVersion,y)),o.then(y=>{a&&y.addEventListener("close",()=>a()),i&&y.addEventListener("versionchange",w=>i(w.oldVersion,w.newVersion,w))}).catch(()=>{}),o}const wh=["get","getKey","getAll","getAllKeys","count"],bh=["put","add","delete","clear"],Zs=new Map;function Do(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zs.get(e))return Zs.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=bh.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||wh.includes(r)))return;const a=async function(f,...o){const y=this.transaction(f,i?"readwrite":"readonly");let w=y.store;return n&&(w=w.index(o.shift())),(await Promise.all([w[r](...o),i&&y.done]))[0]};return Zs.set(e,a),a}_h(t=>({...t,get:(e,r,n)=>Do(e,r)||t.get(e,r,n),has:(e,r)=>!!Do(e,r)||t.has(e,r)}));const zu="auth-client-db",Yu="ic-keyval",Eh=async(t=zu,e=Yu,r)=>(Wu&&(localStorage!=null&&localStorage.getItem(hr))&&(localStorage.removeItem(hr),localStorage.removeItem(lr)),await gh(t,r,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function xh(t,e,r){return await t.get(e,r)}async function vh(t,e,r,n){return await t.put(e,n,r)}async function Nh(t,e,r){return await t.delete(e,r)}class Ga{constructor(e,r){this._db=e,this._storeName=r}static async create(e){const{dbName:r=zu,storeName:n=Yu,version:i=Rh}=e??{},a=await Eh(r,n,i);return new Ga(a,n)}async set(e,r){return await vh(this._db,this._storeName,e,r)}async get(e){var r;return(r=await xh(this._db,this._storeName,e))!==null&&r!==void 0?r:null}async remove(e){return await Nh(this._db,this._storeName,e)}}var Th=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Oh=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Li;const lr="identity",hr="delegation",Sh="iv",Rh=1,Wu=typeof window<"u";class Ah{constructor(e="ic-",r){this.prefix=e,this._localStorage=r}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,r){return this._getLocalStorage().setItem(this.prefix+e,r),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class Ih{constructor(e){Li.set(this,void 0),Th(this,Li,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}Ga.create(Oh(this,Li,"f")).then(r=>{this.initializedDb=r,e(r)})})}async get(e){return await(await this._db).get(e)}async set(e,r){await(await this._db).set(e,r)}async remove(e){await(await this._db).remove(e)}}Li=new WeakMap;const Bh="https://identity.ic0.app",Uh="#authorize",Xs="ECDSA",Js="Ed25519",Fh=500,Ph="UserInterrupt";class Xp{constructor(e,r,n,i,a,f,o,y){this._identity=e,this._key=r,this._chain=n,this._storage=i,this.idleManager=a,this._createOptions=f,this._idpWindow=o,this._eventHandler=y,this._registerDefaultIdleCallback()}static async create(e={}){var r,n,i;const a=(r=e.storage)!==null&&r!==void 0?r:new Ih,f=(n=e.keyType)!==null&&n!==void 0?n:Xs;let o=null;if(e.identity)o=e.identity;else{let A=await a.get(lr);if(!A&&Wu)try{const R=new Ah,S=await R.get(hr),b=await R.get(lr);S&&b&&f===Xs&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await a.set(hr,S),await a.set(lr,b),A=S,await R.remove(hr),await R.remove(lr))}catch(R){console.error("error while attempting to recover localstorage: "+R)}if(A)try{typeof A=="object"?f===Js&&typeof A=="string"?o=await pr.fromJSON(A):o=await es.fromKeyPair(A):typeof A=="string"&&(o=pr.fromJSON(A))}catch{}}let y=new $n,w=null;if(o)try{const A=await a.get(hr);if(typeof A=="object"&&A!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?y=e.identity:A&&(w=rs.fromJSON(A),uh(w)?"toDer"in o?y=ns.fromDelegation(o,w):y=Vo.fromDelegation(o,w):(await Qs(a),o=null))}catch(A){console.error(A),await Qs(a),o=null}let N;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?N=void 0:(w||e.identity)&&(N=Mo.create(e.idleOptions)),o||(f===Js?(o=await pr.generate(),await a.set(lr,JSON.stringify(o.toJSON()))):(e.storage&&f===Xs&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${Js}' as the key type, as it can serialize to a string`),o=await es.generate(),await a.set(lr,o.getKeyPair()))),new this(y,o,w,a,N,e)}_registerDefaultIdleCallback(){var e,r;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!n?.onIdle&&!n?.disableDefaultIdleCallback&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,r){var n,i;const a=e.delegations.map(w=>({delegation:new Da(w.delegation.pubkey,w.delegation.expiration,w.delegation.targets),signature:w.signature.buffer})),f=rs.fromDelegations(a,e.userPublicKey.buffer),o=this._key;if(!o)return;this._chain=f,"toDer"in o?this._identity=ns.fromDelegation(o,this._chain):this._identity=Vo.fromDelegation(o,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const y=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!y?.disableIdle&&(this.idleManager=Mo.create(y),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(hr,JSON.stringify(this._chain.toJSON())),r?.(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var r,n,i,a;const f=BigInt(8)*BigInt(36e11),o=new URL(((r=e?.identityProvider)===null||r===void 0?void 0:r.toString())||Bh);o.hash=Uh,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(o,Object.assign({maxTimeToLive:(i=e?.maxTimeToLive)!==null&&i!==void 0?i:f},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(a=window.open(o.toString(),"idpWindow",e?.windowOpenerFeatures))!==null&&a!==void 0?a:void 0;const y=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Ph,e?.onError):setTimeout(y,Fh))};y()}_getEventHandler(e,r){return async n=>{var i,a,f;if(n.origin!==e.origin)return;const o=n.data;switch(o.kind){case"authorize-ready":{const y=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r?.maxTimeToLive,allowPinAuthentication:r?.allowPinAuthentication,derivationOrigin:(a=r?.derivationOrigin)===null||a===void 0?void 0:a.toString()},r?.customValues);(f=this._idpWindow)===null||f===void 0||f.postMessage(y,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(o,r?.onSuccess)}catch(y){this._handleFailure(y.message,r?.onError)}break;case"authorize-client-failure":this._handleFailure(o.text,r?.onError);break}}}_handleFailure(e,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r?.(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await Qs(this._storage),this._identity=new $n,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function Qs(t){await t.remove(lr),await t.remove(hr),await t.remove(Sh)}var Vh=(t=>(t[t.FractionalMoreThan8Decimals=0]="FractionalMoreThan8Decimals",t[t.InvalidFormat=1]="InvalidFormat",t[t.FractionalTooManyDecimals=2]="FractionalTooManyDecimals",t))(Vh||{});BigInt(1e8);var Zu=class{constructor(t,e,r){this.id=t,this.service=e,this.certifiedService=r,this.caller=({certified:n=!0})=>n?this.certifiedService:this.service}get canisterId(){return this.id}},Xu=t=>t==null,va=t=>!Xu(t),kh=()=>Ur.createSync({host:"https://icp-api.io",identity:new $n}),Jp=async({identity:t,host:e,fetchRootKey:r=!1,verifyQuerySignatures:n=!1,retryTimes:i})=>await Ur.create({identity:t,...va(e)&&{host:e},verifyQuerySignatures:n,...va(i)&&{retryTimes:i},shouldFetchRootKey:r}),Ju=({options:{canisterId:t,serviceOverride:e,certifiedServiceOverride:r,agent:n,callTransform:i,queryTransform:a},idlFactory:f,certifiedIdlFactory:o})=>{let y=n??kh(),w=e??Gn.createActor(f,{agent:y,canisterId:t,callTransform:i,queryTransform:a}),N=r??Gn.createActor(o,{agent:y,canisterId:t,callTransform:i,queryTransform:a});return{service:w,certifiedService:N,agent:y,canisterId:t}},Ch=class extends Error{},Lo=t=>{if(t<0||t>100)throw new Ch(`${t} is not a valid percentage number.`)},Go="abcdefghijklmnopqrstuvwxyz234567",jn=Object.create(null);for(let t=0;t<Go.length;t++)jn[Go[t]]=t;jn[0]=jn.o;jn[1]=jn.i;var Pt=t=>va(t)?[t]:[],jr=t=>t?.[0],Mh=({IDL:t})=>{let e=t.Rec(),r=t.Rec(),n=t.Rec(),i=t.Record({num_blocks_to_archive:t.Opt(t.Nat64),max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Opt(t.Nat64),more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Opt(t.Principal)}),a=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),f=t.Vec(t.Nat8),o=t.Record({owner:t.Principal,subaccount:t.Opt(f)}),y=t.Variant({SetTo:o,Unset:t.Null}),w=t.Record({icrc2:t.Bool}),N=t.Record({change_archive_options:t.Opt(i),token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(t.Nat),metadata:t.Opt(t.Vec(t.Tuple(t.Text,a))),change_fee_collector:t.Opt(y),max_memo_length:t.Opt(t.Nat16),token_name:t.Opt(t.Text),feature_flags:t.Opt(w)}),A=t.Record({decimals:t.Opt(t.Nat8),token_symbol:t.Text,transfer_fee:t.Nat,metadata:t.Vec(t.Tuple(t.Text,a)),minting_account:o,initial_balances:t.Vec(t.Tuple(o,t.Nat)),fee_collector_account:t.Opt(o),archive_options:t.Record({num_blocks_to_archive:t.Nat64,max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Nat64,more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Principal}),max_memo_length:t.Opt(t.Nat16),token_name:t.Text,feature_flags:t.Opt(w)});t.Variant({Upgrade:t.Opt(N),Init:A});let R=t.Nat,S=t.Record({block_range_end:R,canister_id:t.Principal,block_range_start:R}),b=t.Record({start:R,length:t.Nat}),q=t.Vec(t.Tuple(t.Text,n));n.fill(t.Variant({Int:t.Int,Map:q,Nat:t.Nat,Nat64:t.Nat64,Blob:t.Vec(t.Nat8),Text:t.Text,Array:t.Vec(n)}));let M=n,z=t.Record({blocks:t.Vec(M)}),j=t.Func([b],[z],[]),V=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),first_index:R,blocks:t.Vec(M),chain_length:t.Nat64,archived_blocks:t.Vec(t.Record({callback:j,start:R,length:t.Nat}))}),rt=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),hash_tree:t.Vec(t.Nat8)}),k=t.Nat,W=t.Record({start:k,length:t.Nat}),D=t.Nat64,J=t.Record({from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,spender:t.Opt(o)}),nt=t.Record({to:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat}),tt=t.Record({fee:t.Opt(t.Nat),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(D),spender:o}),dt=t.Record({to:o,fee:t.Opt(t.Nat),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,spender:t.Opt(o)}),ut=t.Record({burn:t.Opt(J),kind:t.Text,mint:t.Opt(nt),approve:t.Opt(tt),timestamp:D,transfer:t.Opt(dt)}),I=t.Record({transactions:t.Vec(ut)}),F=t.Func([W],[I],[]),Y=t.Record({first_index:k,log_length:t.Nat,transactions:t.Vec(ut),archived_transactions:t.Vec(t.Record({callback:F,start:k,length:t.Nat}))}),$=t.Nat,G=t.Record({url:t.Text,name:t.Text}),Q=t.Record({to:o,fee:t.Opt($),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(f),created_at_time:t.Opt(D),amount:$}),et=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:$}),Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:$}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,InsufficientFunds:t.Record({balance:$})}),_t=t.Variant({Ok:R,Err:et}),at=t.Record({utc_offset_minutes:t.Opt(t.Int16),language:t.Text}),X=t.Record({metadata:at,device_spec:t.Opt(t.Variant({GenericDisplay:t.Null,LineDisplay:t.Record({characters_per_line:t.Nat16,lines_per_page:t.Nat16})}))}),lt=t.Record({arg:t.Vec(t.Nat8),method:t.Text,user_preferences:X}),E=t.Variant({LineDisplayMessage:t.Record({pages:t.Vec(t.Record({lines:t.Vec(t.Text)}))}),GenericDisplayMessage:t.Text}),ct=t.Record({metadata:at,consent_message:E}),ft=t.Record({description:t.Text}),yt=t.Variant({GenericError:t.Record({description:t.Text,error_code:t.Nat}),InsufficientPayment:ft,UnsupportedCanisterCall:ft,ConsentMessageUnavailable:ft}),it=t.Variant({Ok:ct,Err:yt}),st=t.Record({account:o,spender:o}),g=t.Record({allowance:t.Nat,expires_at:t.Opt(D)}),s=t.Record({fee:t.Opt(t.Nat),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(D),spender:o}),h=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:t.Nat}),AllowanceChanged:t.Record({current_allowance:t.Nat}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,Expired:t.Record({ledger_time:D}),InsufficientFunds:t.Record({balance:t.Nat})}),x=t.Variant({Ok:R,Err:h}),T=t.Record({to:o,fee:t.Opt($),spender_subaccount:t.Opt(f),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:$}),U=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:$}),BadBurn:t.Record({min_burn_amount:$}),Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:$}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,InsufficientFunds:t.Record({balance:$})}),p=t.Variant({Ok:R,Err:U}),c=t.Record({from:t.Opt(t.Principal)}),u=t.Vec(t.Record({end:t.Nat,canister_id:t.Principal,start:t.Nat}));r.fill(t.Variant({Int:t.Int,Map:t.Vec(t.Tuple(t.Text,r)),Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text,Array:t.Vec(r)})),e.fill(t.Record({log_length:t.Nat,blocks:t.Vec(t.Record({id:t.Nat,block:r})),archived_blocks:t.Vec(t.Record({args:t.Vec(b),callback:t.Func([t.Vec(b)],[e],[])}))}));let m=t.Record({certificate:t.Vec(t.Nat8),hash_tree:t.Vec(t.Nat8)});return t.Service({archives:t.Func([],[t.Vec(S)],[]),get_blocks:t.Func([b],[V],[]),get_data_certificate:t.Func([],[rt],[]),get_transactions:t.Func([W],[Y],[]),icrc10_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],[]),icrc1_balance_of:t.Func([o],[$],[]),icrc1_decimals:t.Func([],[t.Nat8],[]),icrc1_fee:t.Func([],[$],[]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,a))],[]),icrc1_minting_account:t.Func([],[t.Opt(o)],[]),icrc1_name:t.Func([],[t.Text],[]),icrc1_supported_standards:t.Func([],[t.Vec(G)],[]),icrc1_symbol:t.Func([],[t.Text],[]),icrc1_total_supply:t.Func([],[$],[]),icrc1_transfer:t.Func([Q],[_t],[]),icrc21_canister_call_consent_message:t.Func([lt],[it],[]),icrc2_allowance:t.Func([st],[g],[]),icrc2_approve:t.Func([s],[x],[]),icrc2_transfer_from:t.Func([T],[p],[]),icrc3_get_archives:t.Func([c],[u],[]),icrc3_get_blocks:t.Func([t.Vec(b)],[e],[]),icrc3_get_tip_certificate:t.Func([],[t.Opt(m)],[]),icrc3_supported_block_types:t.Func([],[t.Vec(t.Record({url:t.Text,block_type:t.Text}))],[]),is_ledger_ready:t.Func([],[t.Bool],[])})},$h=({IDL:t})=>{let e=t.Rec(),r=t.Rec(),n=t.Rec(),i=t.Record({num_blocks_to_archive:t.Opt(t.Nat64),max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Opt(t.Nat64),more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Opt(t.Principal)}),a=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),f=t.Vec(t.Nat8),o=t.Record({owner:t.Principal,subaccount:t.Opt(f)}),y=t.Variant({SetTo:o,Unset:t.Null}),w=t.Record({icrc2:t.Bool}),N=t.Record({change_archive_options:t.Opt(i),token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(t.Nat),metadata:t.Opt(t.Vec(t.Tuple(t.Text,a))),change_fee_collector:t.Opt(y),max_memo_length:t.Opt(t.Nat16),token_name:t.Opt(t.Text),feature_flags:t.Opt(w)}),A=t.Record({decimals:t.Opt(t.Nat8),token_symbol:t.Text,transfer_fee:t.Nat,metadata:t.Vec(t.Tuple(t.Text,a)),minting_account:o,initial_balances:t.Vec(t.Tuple(o,t.Nat)),fee_collector_account:t.Opt(o),archive_options:t.Record({num_blocks_to_archive:t.Nat64,max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Nat64,more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Principal}),max_memo_length:t.Opt(t.Nat16),token_name:t.Text,feature_flags:t.Opt(w)});t.Variant({Upgrade:t.Opt(N),Init:A});let R=t.Nat,S=t.Record({block_range_end:R,canister_id:t.Principal,block_range_start:R}),b=t.Record({start:R,length:t.Nat}),q=t.Vec(t.Tuple(t.Text,n));n.fill(t.Variant({Int:t.Int,Map:q,Nat:t.Nat,Nat64:t.Nat64,Blob:t.Vec(t.Nat8),Text:t.Text,Array:t.Vec(n)}));let M=n,z=t.Record({blocks:t.Vec(M)}),j=t.Func([b],[z],["query"]),V=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),first_index:R,blocks:t.Vec(M),chain_length:t.Nat64,archived_blocks:t.Vec(t.Record({callback:j,start:R,length:t.Nat}))}),rt=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),hash_tree:t.Vec(t.Nat8)}),k=t.Nat,W=t.Record({start:k,length:t.Nat}),D=t.Nat64,J=t.Record({from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,spender:t.Opt(o)}),nt=t.Record({to:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat}),tt=t.Record({fee:t.Opt(t.Nat),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(D),spender:o}),dt=t.Record({to:o,fee:t.Opt(t.Nat),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,spender:t.Opt(o)}),ut=t.Record({burn:t.Opt(J),kind:t.Text,mint:t.Opt(nt),approve:t.Opt(tt),timestamp:D,transfer:t.Opt(dt)}),I=t.Record({transactions:t.Vec(ut)}),F=t.Func([W],[I],["query"]),Y=t.Record({first_index:k,log_length:t.Nat,transactions:t.Vec(ut),archived_transactions:t.Vec(t.Record({callback:F,start:k,length:t.Nat}))}),$=t.Nat,G=t.Record({url:t.Text,name:t.Text}),Q=t.Record({to:o,fee:t.Opt($),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(f),created_at_time:t.Opt(D),amount:$}),et=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:$}),Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:$}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,InsufficientFunds:t.Record({balance:$})}),_t=t.Variant({Ok:R,Err:et}),at=t.Record({utc_offset_minutes:t.Opt(t.Int16),language:t.Text}),X=t.Record({metadata:at,device_spec:t.Opt(t.Variant({GenericDisplay:t.Null,LineDisplay:t.Record({characters_per_line:t.Nat16,lines_per_page:t.Nat16})}))}),lt=t.Record({arg:t.Vec(t.Nat8),method:t.Text,user_preferences:X}),E=t.Variant({LineDisplayMessage:t.Record({pages:t.Vec(t.Record({lines:t.Vec(t.Text)}))}),GenericDisplayMessage:t.Text}),ct=t.Record({metadata:at,consent_message:E}),ft=t.Record({description:t.Text}),yt=t.Variant({GenericError:t.Record({description:t.Text,error_code:t.Nat}),InsufficientPayment:ft,UnsupportedCanisterCall:ft,ConsentMessageUnavailable:ft}),it=t.Variant({Ok:ct,Err:yt}),st=t.Record({account:o,spender:o}),g=t.Record({allowance:t.Nat,expires_at:t.Opt(D)}),s=t.Record({fee:t.Opt(t.Nat),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(D),spender:o}),h=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:t.Nat}),AllowanceChanged:t.Record({current_allowance:t.Nat}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,Expired:t.Record({ledger_time:D}),InsufficientFunds:t.Record({balance:t.Nat})}),x=t.Variant({Ok:R,Err:h}),T=t.Record({to:o,fee:t.Opt($),spender_subaccount:t.Opt(f),from:o,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(D),amount:$}),U=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:$}),BadBurn:t.Record({min_burn_amount:$}),Duplicate:t.Record({duplicate_of:R}),BadFee:t.Record({expected_fee:$}),CreatedInFuture:t.Record({ledger_time:D}),TooOld:t.Null,InsufficientFunds:t.Record({balance:$})}),p=t.Variant({Ok:R,Err:U}),c=t.Record({from:t.Opt(t.Principal)}),u=t.Vec(t.Record({end:t.Nat,canister_id:t.Principal,start:t.Nat}));r.fill(t.Variant({Int:t.Int,Map:t.Vec(t.Tuple(t.Text,r)),Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text,Array:t.Vec(r)})),e.fill(t.Record({log_length:t.Nat,blocks:t.Vec(t.Record({id:t.Nat,block:r})),archived_blocks:t.Vec(t.Record({args:t.Vec(b),callback:t.Func([t.Vec(b)],[e],["query"])}))}));let m=t.Record({certificate:t.Vec(t.Nat8),hash_tree:t.Vec(t.Nat8)});return t.Service({archives:t.Func([],[t.Vec(S)],["query"]),get_blocks:t.Func([b],[V],["query"]),get_data_certificate:t.Func([],[rt],["query"]),get_transactions:t.Func([W],[Y],["query"]),icrc10_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],["query"]),icrc1_balance_of:t.Func([o],[$],["query"]),icrc1_decimals:t.Func([],[t.Nat8],["query"]),icrc1_fee:t.Func([],[$],["query"]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,a))],["query"]),icrc1_minting_account:t.Func([],[t.Opt(o)],["query"]),icrc1_name:t.Func([],[t.Text],["query"]),icrc1_supported_standards:t.Func([],[t.Vec(G)],["query"]),icrc1_symbol:t.Func([],[t.Text],["query"]),icrc1_total_supply:t.Func([],[$],["query"]),icrc1_transfer:t.Func([Q],[_t],[]),icrc21_canister_call_consent_message:t.Func([lt],[it],[]),icrc2_allowance:t.Func([st],[g],["query"]),icrc2_approve:t.Func([s],[x],[]),icrc2_transfer_from:t.Func([T],[p],[]),icrc3_get_archives:t.Func([c],[u],["query"]),icrc3_get_blocks:t.Func([t.Vec(b)],[e],["query"]),icrc3_get_tip_certificate:t.Func([],[t.Opt(m)],["query"]),icrc3_supported_block_types:t.Func([],[t.Vec(t.Record({url:t.Text,block_type:t.Text}))],["query"]),is_ledger_ready:t.Func([],[t.Bool],["query"])})},qh=({from_subaccount:t,fee:e,created_at_time:r,memo:n,...i})=>({...i,fee:Pt(e),memo:Pt(n),from_subaccount:Pt(t),created_at_time:Pt(r)}),Dh=({spender_subaccount:t,fee:e,created_at_time:r,memo:n,...i})=>({...i,fee:Pt(e),memo:Pt(n),spender_subaccount:Pt(t),created_at_time:Pt(r)}),Lh=({fee:t,created_at_time:e,memo:r,from_subaccount:n,expected_allowance:i,expires_at:a,...f})=>({...f,fee:Pt(t),memo:Pt(r),from_subaccount:Pt(n),created_at_time:Pt(e),expected_allowance:Pt(i),expires_at:Pt(a)}),Gh=({userPreferences:{metadata:{utcOffsetMinutes:t,language:e},deriveSpec:r},...n})=>({...n,user_preferences:{metadata:{language:e,utc_offset_minutes:Pt(t)},device_spec:Xu(r)?Pt():Pt("GenericDisplay"in r?{GenericDisplay:null}:{LineDisplay:{characters_per_line:r.LineDisplay.charactersPerLine,lines_per_page:r.LineDisplay.linesPerPage}})}}),ta=class extends Error{constructor({msg:t,errorType:e}){super(t),this.errorType=e}},jh=class extends Error{constructor(t,e){super(),this.message=t,this.error_code=e}},ys=class extends Error{},Hh=class extends ys{},Kh=class extends ys{},zh=class extends ys{},Yh=t=>"GenericError"in t?new jh(t.GenericError.description,t.GenericError.error_code):"InsufficientPayment"in t?new Hh(t.InsufficientPayment.description):"UnsupportedCanisterCall"in t?new Kh(t.UnsupportedCanisterCall.description):"ConsentMessageUnavailable"in t?new zh(t.ConsentMessageUnavailable.description):new ys(`Unknown error type ${JSON.stringify(t)}`),e_=class Qu extends Zu{constructor(){super(...arguments),this.metadata=e=>this.caller(e).icrc1_metadata(),this.transactionFee=e=>this.caller(e).icrc1_fee(),this.balance=e=>this.caller({certified:e.certified}).icrc1_balance_of({owner:e.owner,subaccount:Pt(e.subaccount)}),this.transfer=async e=>{let r=await this.caller({certified:!0}).icrc1_transfer(qh(e));if("Err"in r)throw new ta({errorType:r.Err,msg:"Failed to transfer"});return r.Ok},this.totalTokensSupply=e=>this.caller(e).icrc1_total_supply(),this.transferFrom=async e=>{let r=await this.caller({certified:!0}).icrc2_transfer_from(Dh(e));if("Err"in r)throw new ta({errorType:r.Err,msg:"Failed to transfer from"});return r.Ok},this.approve=async e=>{let r=await this.caller({certified:!0}).icrc2_approve(Lh(e));if("Err"in r)throw new ta({errorType:r.Err,msg:"Failed to entitle the spender to transfer the amount"});return r.Ok},this.allowance=async e=>{let{certified:r,...n}=e;return this.caller({certified:r}).icrc2_allowance({...n})},this.consentMessage=async e=>{let{icrc21_canister_call_consent_message:r}=this.caller({certified:!0}),n=await r(Gh(e));if("Err"in n)throw Yh(n.Err);return n.Ok}}static create(e){let{service:r,certifiedService:n,canisterId:i}=Ju({options:e,idlFactory:$h,certifiedIdlFactory:Mh});return new Qu(i,r,n)}},Wh=(t=>(t.SYMBOL="icrc1:symbol",t.NAME="icrc1:name",t.DECIMALS="icrc1:decimals",t.FEE="icrc1:fee",t.LOGO="icrc1:logo",t))(Wh||{}),Zh={};const Xh=fl(zl);var ue={};Object.defineProperty(ue,"__esModule",{value:!0});ue.bufFromBufLike=ue.uint8ToBuf=ue.PipeArrayBuffer=ue.fromHexString=ue.toHexString=ue.concat=void 0;function Jh(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}ue.concat=Jh;function Qh(t){return new Uint8Array(t).reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"")}ue.toHexString=Qh;function tp(t){var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(r=>parseInt(r,16)))}ue.fromHexString=tp;class ep{constructor(e,r=e?.byteLength||0){this._buffer=is(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}get buffer(){return is(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const r=this._view.subarray(0,e);return this._view=this._view.subarray(e),r.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const r=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(e){const r=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+e);n.set(this._view),this._buffer=r,this._view=n}}ue.PipeArrayBuffer=ep;function Gi(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}ue.uint8ToBuf=Gi;function is(t){return t instanceof Uint8Array?Gi(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Gi(new Uint8Array(t)):"buffer"in t?is(t.buffer):Gi(new Uint8Array(t))}ue.bufFromBufLike=is;var ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.idlLabelToId=void 0;function rp(t){const r=new TextEncoder().encode(t);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function np(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return rp(t)}ms.idlLabelToId=np;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.readIntLE=Dt.readUIntLE=Dt.writeIntLE=Dt.writeUIntLE=Dt.slebDecode=Dt.slebEncode=Dt.lebDecode=Dt.lebEncode=Dt.safeReadUint8=Dt.safeRead=void 0;const ja=ue;function tl(){throw new Error("unexpected end of buffer")}function el(t,e){return t.byteLength<e&&tl(),t.read(e)}Dt.safeRead=el;function ss(t){const e=t.readUint8();return e===void 0&&tl(),e}Dt.safeReadUint8=ss;function ip(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new ja.PipeArrayBuffer(new ArrayBuffer(e),0);for(;;){const n=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}Dt.lebEncode=ip;function rl(t){let e=BigInt(1),r=BigInt(0),n;do n=ss(t),r+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return r}Dt.lebDecode=rl;function sp(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new ja.PipeArrayBuffer(new ArrayBuffer(r),0);for(;;){const a=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&a&64||!e&&t===BigInt(0)&&!(a&64)){n.write(new Uint8Array([a]));break}else n.write(new Uint8Array([a|128]))}function i(a){const f=a%BigInt(128);return Number(e?BigInt(128)-f-BigInt(1):f)}return n.buffer}Dt.slebEncode=sp;function ap(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(e[r]&64))return rl(t);break}const n=new Uint8Array(el(t,r+1));let i=BigInt(0);for(let a=n.byteLength-1;a>=0;a--)i=i*BigInt(128)+BigInt(128-(n[a]&127)-1);return-i-BigInt(1)}Dt.slebDecode=ap;function op(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return nl(t,e)}Dt.writeUIntLE=op;function nl(t,e){t=BigInt(t);const r=new ja.PipeArrayBuffer(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),a=BigInt(0),f=Number(t%i);for(r.write(new Uint8Array([f]));++n<e;)t<0&&a===BigInt(0)&&f!==0&&(a=BigInt(1)),f=Number((t/i-a)%BigInt(256)),r.write(new Uint8Array([f])),i*=BigInt(256);return r.buffer}Dt.writeIntLE=nl;function il(t,e){let r=BigInt(ss(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const a=BigInt(ss(t));r=r+n*a}return r}Dt.readUIntLE=il;function cp(t,e){let r=il(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}Dt.readIntLE=cp;var on={};Object.defineProperty(on,"__esModule",{value:!0});on.iexp2=on.ilog2=void 0;function up(t){const e=BigInt(t);if(t<=0)throw new RangeError("Input must be positive");return e.toString(2).length-1}on.ilog2=up;function lp(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}on.iexp2=lp;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Variant=t.Record=t.Opt=t.Vec=t.Tuple=t.Principal=t.Nat64=t.Nat32=t.Nat16=t.Nat8=t.Int64=t.Int32=t.Int16=t.Int8=t.Float64=t.Float32=t.Nat=t.Int=t.Text=t.Null=t.Bool=t.Unknown=t.Reserved=t.Empty=t.decode=t.encode=t.ServiceClass=t.FuncClass=t.PrincipalClass=t.RecClass=t.VariantClass=t.TupleClass=t.RecordClass=t.OptClass=t.VecClass=t.FixedNatClass=t.FixedIntClass=t.FloatClass=t.NatClass=t.IntClass=t.TextClass=t.ReservedClass=t.NullClass=t.BoolClass=t.UnknownClass=t.EmptyClass=t.ConstructType=t.PrimitiveType=t.Type=t.Visitor=void 0,t.Service=t.Func=t.Rec=void 0;const e=Xh,r=ue,n=ms,i=Dt,a=on,f="DIDL",o=400;function y(g,s,h){return g.map((x,T)=>h(x,s[T]))}class w{constructor(){this._typs=[],this._idx=new Map}has(s){return this._idx.has(s.name)}add(s,h){const x=this._typs.length;this._idx.set(s.name,x),this._typs.push(h)}merge(s,h){const x=this._idx.get(s.name),T=this._idx.get(h);if(x===void 0)throw new Error("Missing type index for "+s);if(T===void 0)throw new Error("Missing type index for "+h);this._typs[x]=this._typs[T],this._typs.splice(T,1),this._idx.delete(h)}encode(){const s=(0,i.lebEncode)(this._typs.length),h=(0,r.concat)(...this._typs);return(0,r.concat)(s,h)}indexOf(s){if(!this._idx.has(s))throw new Error("Missing type index for "+s);return(0,i.slebEncode)(this._idx.get(s)||0)}}class N{visitType(s,h){throw new Error("Not implemented")}visitPrimitive(s,h){return this.visitType(s,h)}visitEmpty(s,h){return this.visitPrimitive(s,h)}visitBool(s,h){return this.visitPrimitive(s,h)}visitNull(s,h){return this.visitPrimitive(s,h)}visitReserved(s,h){return this.visitPrimitive(s,h)}visitText(s,h){return this.visitPrimitive(s,h)}visitNumber(s,h){return this.visitPrimitive(s,h)}visitInt(s,h){return this.visitNumber(s,h)}visitNat(s,h){return this.visitNumber(s,h)}visitFloat(s,h){return this.visitPrimitive(s,h)}visitFixedInt(s,h){return this.visitNumber(s,h)}visitFixedNat(s,h){return this.visitNumber(s,h)}visitPrincipal(s,h){return this.visitPrimitive(s,h)}visitConstruct(s,h){return this.visitType(s,h)}visitVec(s,h,x){return this.visitConstruct(s,x)}visitOpt(s,h,x){return this.visitConstruct(s,x)}visitRecord(s,h,x){return this.visitConstruct(s,x)}visitTuple(s,h,x){const T=h.map((U,p)=>[`_${p}_`,U]);return this.visitRecord(s,T,x)}visitVariant(s,h,x){return this.visitConstruct(s,x)}visitRec(s,h,x){return this.visitConstruct(h,x)}visitFunc(s,h){return this.visitConstruct(s,h)}visitService(s,h){return this.visitConstruct(s,h)}}t.Visitor=N;class A{display(){return this.name}valueToString(s){return et(s)}buildTypeTable(s){s.has(this)||this._buildTypeTableImpl(s)}}t.Type=A;class R extends A{checkType(s){if(this.name!==s.name)throw new Error(`type mismatch: type on the wire ${s.name}, expect type ${this.name}`);return s}_buildTypeTableImpl(s){}}t.PrimitiveType=R;class S extends A{checkType(s){if(s instanceof F){const h=s.getType();if(typeof h>"u")throw new Error("type mismatch with uninitialized type");return h}throw new Error(`type mismatch: type on the wire ${s.name}, expect type ${this.name}`)}encodeType(s){return s.indexOf(this.name)}}t.ConstructType=S;class b extends R{accept(s,h){return s.visitEmpty(this,h)}covariant(s){throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return(0,i.slebEncode)(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}t.EmptyClass=b;class q extends A{checkType(s){throw new Error("Method not implemented for unknown.")}accept(s,h){throw s.visitType(this,h)}covariant(s){throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(s,h){let x=h.decodeValue(s,h);Object(x)!==x&&(x=Object(x));let T;return h instanceof F?T=()=>h.getType():T=()=>h,Object.defineProperty(x,"type",{value:T,writable:!0,enumerable:!1,configurable:!0}),x}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}t.UnknownClass=q;class M extends R{accept(s,h){return s.visitBool(this,h)}covariant(s){if(typeof s=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return new Uint8Array([s?1:0])}encodeType(){return(0,i.slebEncode)(-2)}decodeValue(s,h){switch(this.checkType(h),(0,i.safeReadUint8)(s)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}t.BoolClass=M;class z extends R{accept(s,h){return s.visitNull(this,h)}covariant(s){if(s===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return(0,i.slebEncode)(-1)}decodeValue(s,h){return this.checkType(h),null}get name(){return"null"}}t.NullClass=z;class j extends R{accept(s,h){return s.visitReserved(this,h)}covariant(s){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return(0,i.slebEncode)(-16)}decodeValue(s,h){return h.name!==this.name&&h.decodeValue(s,h),null}get name(){return"reserved"}}t.ReservedClass=j;class V extends R{accept(s,h){return s.visitText(this,h)}covariant(s){if(typeof s=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=new TextEncoder().encode(s),x=(0,i.lebEncode)(h.byteLength);return(0,r.concat)(x,h)}encodeType(){return(0,i.slebEncode)(-15)}decodeValue(s,h){this.checkType(h);const x=(0,i.lebDecode)(s),T=(0,i.safeRead)(s,Number(x));return new TextDecoder("utf8",{fatal:!0}).decode(T)}get name(){return"text"}valueToString(s){return'"'+s+'"'}}t.TextClass=V;class rt extends R{accept(s,h){return s.visitInt(this,h)}covariant(s){if(typeof s=="bigint"||Number.isInteger(s))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return(0,i.slebEncode)(s)}encodeType(){return(0,i.slebEncode)(-4)}decodeValue(s,h){return this.checkType(h),(0,i.slebDecode)(s)}get name(){return"int"}valueToString(s){return s.toString()}}t.IntClass=rt;class k extends R{accept(s,h){return s.visitNat(this,h)}covariant(s){if(typeof s=="bigint"&&s>=BigInt(0)||Number.isInteger(s)&&s>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return(0,i.lebEncode)(s)}encodeType(){return(0,i.slebEncode)(-3)}decodeValue(s,h){return this.checkType(h),(0,i.lebDecode)(s)}get name(){return"nat"}valueToString(s){return s.toString()}}t.NatClass=k;class W extends R{constructor(s){if(super(),this._bits=s,s!==32&&s!==64)throw new Error("not a valid float type")}accept(s,h){return s.visitFloat(this,h)}covariant(s){if(typeof s=="number"||s instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=new ArrayBuffer(this._bits/8),x=new DataView(h);return this._bits===32?x.setFloat32(0,s,!0):x.setFloat64(0,s,!0),h}encodeType(){const s=this._bits===32?-13:-14;return(0,i.slebEncode)(s)}decodeValue(s,h){this.checkType(h);const x=(0,i.safeRead)(s,this._bits/8),T=new DataView(x);return this._bits===32?T.getFloat32(0,!0):T.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(s){return s.toString()}}t.FloatClass=W;class D extends R{constructor(s){super(),this._bits=s}accept(s,h){return s.visitFixedInt(this,h)}covariant(s){const h=(0,a.iexp2)(this._bits-1)*BigInt(-1),x=(0,a.iexp2)(this._bits-1)-BigInt(1);let T=!1;if(typeof s=="bigint")T=s>=h&&s<=x;else if(Number.isInteger(s)){const U=BigInt(s);T=U>=h&&U<=x}else T=!1;if(T)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return(0,i.writeIntLE)(s,this._bits/8)}encodeType(){const s=Math.log2(this._bits)-3;return(0,i.slebEncode)(-9-s)}decodeValue(s,h){this.checkType(h);const x=(0,i.readIntLE)(s,this._bits/8);return this._bits<=32?Number(x):x}get name(){return`int${this._bits}`}valueToString(s){return s.toString()}}t.FixedIntClass=D;class J extends R{constructor(s){super(),this._bits=s}accept(s,h){return s.visitFixedNat(this,h)}covariant(s){const h=(0,a.iexp2)(this._bits);let x=!1;if(typeof s=="bigint"&&s>=BigInt(0)?x=s<h:Number.isInteger(s)&&s>=0?x=BigInt(s)<h:x=!1,x)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return(0,i.writeUIntLE)(s,this._bits/8)}encodeType(){const s=Math.log2(this._bits)-3;return(0,i.slebEncode)(-5-s)}decodeValue(s,h){this.checkType(h);const x=(0,i.readUIntLE)(s,this._bits/8);return this._bits<=32?Number(x):x}get name(){return`nat${this._bits}`}valueToString(s){return s.toString()}}t.FixedNatClass=J;class nt extends S{constructor(s){super(),this._type=s,this._blobOptimization=!1,s instanceof J&&s._bits===8&&(this._blobOptimization=!0)}accept(s,h){return s.visitVec(this,this._type,h)}covariant(s){const h=this._type instanceof J?this._type._bits:this._type instanceof D?this._type._bits:0;if(ArrayBuffer.isView(s)&&h==s.BYTES_PER_ELEMENT*8||Array.isArray(s)&&s.every((x,T)=>{try{return this._type.covariant(x)}catch(U){throw new Error(`Invalid ${this.display()} argument: 

index ${T} -> ${U.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=(0,i.lebEncode)(s.length);if(this._blobOptimization)return(0,r.concat)(h,new Uint8Array(s));if(ArrayBuffer.isView(s))return(0,r.concat)(h,new Uint8Array(s.buffer));const x=new r.PipeArrayBuffer(new ArrayBuffer(h.byteLength+s.length),0);x.write(h);for(const T of s){const U=this._type.encodeValue(T);x.write(new Uint8Array(U))}return x.buffer}_buildTypeTableImpl(s){this._type.buildTypeTable(s);const h=(0,i.slebEncode)(-19),x=this._type.encodeType(s);s.add(this,(0,r.concat)(h,x))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof nt))throw new Error("Not a vector type");const T=Number((0,i.lebDecode)(s));if(this._type instanceof J){if(this._type._bits==8)return new Uint8Array(s.read(T));if(this._type._bits==16)return new Uint16Array(s.read(T*2));if(this._type._bits==32)return new Uint32Array(s.read(T*4));if(this._type._bits==64)return new BigUint64Array(s.read(T*8))}if(this._type instanceof D){if(this._type._bits==8)return new Int8Array(s.read(T));if(this._type._bits==16)return new Int16Array(s.read(T*2));if(this._type._bits==32)return new Int32Array(s.read(T*4));if(this._type._bits==64)return new BigInt64Array(s.read(T*8))}const U=[];for(let p=0;p<T;p++)U.push(this._type.decodeValue(s,x._type));return U}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(s){return"vec {"+s.map(x=>this._type.valueToString(x)).join("; ")+"}"}}t.VecClass=nt;class tt extends S{constructor(s){super(),this._type=s}accept(s,h){return s.visitOpt(this,this._type,h)}covariant(s){try{if(Array.isArray(s)&&(s.length===0||s.length===1&&this._type.covariant(s[0])))return!0}catch(h){throw new Error(`Invalid ${this.display()} argument: ${et(s)} 

-> ${h.message}`)}throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){return s.length===0?new Uint8Array([0]):(0,r.concat)(new Uint8Array([1]),this._type.encodeValue(s[0]))}_buildTypeTableImpl(s){this._type.buildTypeTable(s);const h=(0,i.slebEncode)(-18),x=this._type.encodeType(s);s.add(this,(0,r.concat)(h,x))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof tt))throw new Error("Not an option type");switch((0,i.safeReadUint8)(s)){case 0:return[];case 1:return[this._type.decodeValue(s,x._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(s){return s.length===0?"null":`opt ${this._type.valueToString(s[0])}`}}t.OptClass=tt;class dt extends S{constructor(s={}){super(),this._fields=Object.entries(s).sort((h,x)=>(0,n.idlLabelToId)(h[0])-(0,n.idlLabelToId)(x[0]))}accept(s,h){return s.visitRecord(this,this._fields,h)}tryAsTuple(){const s=[];for(let h=0;h<this._fields.length;h++){const[x,T]=this._fields[h];if(x!==`_${h}_`)return null;s.push(T)}return s}covariant(s){if(typeof s=="object"&&this._fields.every(([h,x])=>{if(!s.hasOwnProperty(h))throw new Error(`Record is missing key "${h}".`);try{return x.covariant(s[h])}catch(T){throw new Error(`Invalid ${this.display()} argument: 

field ${h} -> ${T.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=this._fields.map(([T])=>s[T]),x=y(this._fields,h,([,T],U)=>T.encodeValue(U));return(0,r.concat)(...x)}_buildTypeTableImpl(s){this._fields.forEach(([U,p])=>p.buildTypeTable(s));const h=(0,i.slebEncode)(-20),x=(0,i.lebEncode)(this._fields.length),T=this._fields.map(([U,p])=>(0,r.concat)((0,i.lebEncode)((0,n.idlLabelToId)(U)),p.encodeType(s)));s.add(this,(0,r.concat)(h,x,(0,r.concat)(...T)))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof dt))throw new Error("Not a record type");const T={};let U=0,p=0;for(;p<x._fields.length;){const[c,u]=x._fields[p];if(U>=this._fields.length){u.decodeValue(s,u),p++;continue}const[m,v]=this._fields[U],B=(0,n.idlLabelToId)(this._fields[U][0]),L=(0,n.idlLabelToId)(c);if(B===L)T[m]=v.decodeValue(s,u),U++,p++;else if(L>B)if(v instanceof tt||v instanceof j)T[m]=[],U++;else throw new Error("Cannot find required field "+m);else u.decodeValue(s,u),p++}for(const[c,u]of this._fields.slice(U))if(u instanceof tt||u instanceof j)T[c]=[];else throw new Error("Cannot find required field "+c);return T}get name(){return`record {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}display(){return`record {${this._fields.map(([h,x])=>h+":"+x.display()).join("; ")}}`}valueToString(s){const h=this._fields.map(([T])=>s[T]);return`record {${y(this._fields,h,([T,U],p)=>T+"="+U.valueToString(p)).join("; ")}}`}}t.RecordClass=dt;class ut extends dt{constructor(s){const h={};s.forEach((x,T)=>h["_"+T+"_"]=x),super(h),this._components=s}accept(s,h){return s.visitTuple(this,this._components,h)}covariant(s){if(Array.isArray(s)&&s.length>=this._fields.length&&this._components.every((h,x)=>{try{return h.covariant(s[x])}catch(T){throw new Error(`Invalid ${this.display()} argument: 

index ${x} -> ${T.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=y(this._components,s,(x,T)=>x.encodeValue(T));return(0,r.concat)(...h)}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof ut))throw new Error("not a tuple type");if(x._components.length<this._components.length)throw new Error("tuple mismatch");const T=[];for(const[U,p]of x._components.entries())U>=this._components.length?p.decodeValue(s,p):T.push(this._components[U].decodeValue(s,p));return T}display(){return`record {${this._components.map(h=>h.display()).join("; ")}}`}valueToString(s){return`record {${y(this._components,s,(x,T)=>x.valueToString(T)).join("; ")}}`}}t.TupleClass=ut;class I extends S{constructor(s={}){super(),this._fields=Object.entries(s).sort((h,x)=>(0,n.idlLabelToId)(h[0])-(0,n.idlLabelToId)(x[0]))}accept(s,h){return s.visitVariant(this,this._fields,h)}covariant(s){if(typeof s=="object"&&Object.entries(s).length===1&&this._fields.every(([h,x])=>{try{return!s.hasOwnProperty(h)||x.covariant(s[h])}catch(T){throw new Error(`Invalid ${this.display()} argument: 

variant ${h} -> ${T.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){for(let h=0;h<this._fields.length;h++){const[x,T]=this._fields[h];if(s.hasOwnProperty(x)){const U=(0,i.lebEncode)(h),p=T.encodeValue(s[x]);return(0,r.concat)(U,p)}}throw Error("Variant has no data: "+s)}_buildTypeTableImpl(s){this._fields.forEach(([,U])=>{U.buildTypeTable(s)});const h=(0,i.slebEncode)(-21),x=(0,i.lebEncode)(this._fields.length),T=this._fields.map(([U,p])=>(0,r.concat)((0,i.lebEncode)((0,n.idlLabelToId)(U)),p.encodeType(s)));s.add(this,(0,r.concat)(h,x,...T))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof I))throw new Error("Not a variant type");const T=Number((0,i.lebDecode)(s));if(T>=x._fields.length)throw Error("Invalid variant index: "+T);const[U,p]=x._fields[T];for(const[c,u]of this._fields)if((0,n.idlLabelToId)(U)===(0,n.idlLabelToId)(c)){const m=u.decodeValue(s,p);return{[c]:m}}throw new Error("Cannot find field hash "+U)}get name(){return`variant {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}display(){return`variant {${this._fields.map(([h,x])=>h+(x.name==="null"?"":`:${x.display()}`)).join("; ")}}`}valueToString(s){for(const[h,x]of this._fields)if(s.hasOwnProperty(h)){const T=x.valueToString(s[h]);return T==="null"?`variant {${h}}`:`variant {${h}=${T}}`}throw new Error("Variant has no data: "+s)}}t.VariantClass=I;class F extends S{constructor(){super(...arguments),this._id=F._counter++,this._type=void 0}accept(s,h){if(!this._type)throw Error("Recursive type uninitialized.");return s.visitRec(this,this._type,h)}fill(s){this._type=s}getType(){return this._type}covariant(s){if(this._type&&this._type.covariant(s))return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(s)}_buildTypeTableImpl(s){if(!this._type)throw Error("Recursive type uninitialized.");s.add(this,new Uint8Array([])),this._type.buildTypeTable(s),s.merge(this,this._type.name)}decodeValue(s,h){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(s,h)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(s){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(s)}}t.RecClass=F,F._counter=0;function Y(g){if((0,i.safeReadUint8)(g)!==1)throw new Error("Cannot decode principal");const h=Number((0,i.lebDecode)(g));return e.Principal.fromUint8Array(new Uint8Array((0,i.safeRead)(g,h)))}class $ extends R{accept(s,h){return s.visitPrincipal(this,h)}covariant(s){if(s&&s._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=s.toUint8Array(),x=(0,i.lebEncode)(h.byteLength);return(0,r.concat)(new Uint8Array([1]),x,h)}encodeType(){return(0,i.slebEncode)(-24)}decodeValue(s,h){return this.checkType(h),Y(s)}get name(){return"principal"}valueToString(s){return`${this.name} "${s.toText()}"`}}t.PrincipalClass=$;class G extends S{constructor(s,h,x=[]){super(),this.argTypes=s,this.retTypes=h,this.annotations=x}static argsToString(s,h){if(s.length!==h.length)throw new Error("arity mismatch");return"("+s.map((x,T)=>x.valueToString(h[T])).join(", ")+")"}accept(s,h){return s.visitFunc(this,h)}covariant(s){if(Array.isArray(s)&&s.length===2&&s[0]&&s[0]._isPrincipal&&typeof s[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue([s,h]){const x=s.toUint8Array(),T=(0,i.lebEncode)(x.byteLength),U=(0,r.concat)(new Uint8Array([1]),T,x),p=new TextEncoder().encode(h),c=(0,i.lebEncode)(p.byteLength);return(0,r.concat)(new Uint8Array([1]),U,c,p)}_buildTypeTableImpl(s){this.argTypes.forEach(m=>m.buildTypeTable(s)),this.retTypes.forEach(m=>m.buildTypeTable(s));const h=(0,i.slebEncode)(-22),x=(0,i.lebEncode)(this.argTypes.length),T=(0,r.concat)(...this.argTypes.map(m=>m.encodeType(s))),U=(0,i.lebEncode)(this.retTypes.length),p=(0,r.concat)(...this.retTypes.map(m=>m.encodeType(s))),c=(0,i.lebEncode)(this.annotations.length),u=(0,r.concat)(...this.annotations.map(m=>this.encodeAnnotation(m)));s.add(this,(0,r.concat)(h,x,T,U,p,c,u))}decodeValue(s){if((0,i.safeReadUint8)(s)!==1)throw new Error("Cannot decode function reference");const x=Y(s),T=Number((0,i.lebDecode)(s)),U=(0,i.safeRead)(s,T),c=new TextDecoder("utf8",{fatal:!0}).decode(U);return[x,c]}get name(){const s=this.argTypes.map(T=>T.name).join(", "),h=this.retTypes.map(T=>T.name).join(", "),x=" "+this.annotations.join(" ");return`(${s}) -> (${h})${x}`}valueToString([s,h]){return`func "${s.toText()}".${h}`}display(){const s=this.argTypes.map(T=>T.display()).join(", "),h=this.retTypes.map(T=>T.display()).join(", "),x=" "+this.annotations.join(" ");return`(${s}) → (${h})${x}`}encodeAnnotation(s){if(s==="query")return new Uint8Array([1]);if(s==="oneway")return new Uint8Array([2]);if(s==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}t.FuncClass=G;class Q extends S{constructor(s){super(),this._fields=Object.entries(s).sort((h,x)=>h[0]<x[0]?-1:h[0]>x[0]?1:0)}accept(s,h){return s.visitService(this,h)}covariant(s){if(s&&s._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${et(s)}`)}encodeValue(s){const h=s.toUint8Array(),x=(0,i.lebEncode)(h.length);return(0,r.concat)(new Uint8Array([1]),x,h)}_buildTypeTableImpl(s){this._fields.forEach(([U,p])=>p.buildTypeTable(s));const h=(0,i.slebEncode)(-23),x=(0,i.lebEncode)(this._fields.length),T=this._fields.map(([U,p])=>{const c=new TextEncoder().encode(U),u=(0,i.lebEncode)(c.length);return(0,r.concat)(u,c,p.encodeType(s))});s.add(this,(0,r.concat)(h,x,...T))}decodeValue(s){return Y(s)}get name(){return`service {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}valueToString(s){return`service "${s.toText()}"`}}t.ServiceClass=Q;function et(g){const s=JSON.stringify(g,(h,x)=>typeof x=="bigint"?`BigInt(${x})`:x);return s&&s.length>o?s.substring(0,o-3)+"...":s}function _t(g,s){if(s.length<g.length)throw Error("Wrong number of message arguments");const h=new w;g.forEach(u=>u.buildTypeTable(h));const x=new TextEncoder().encode(f),T=h.encode(),U=(0,i.lebEncode)(s.length),p=(0,r.concat)(...g.map(u=>u.encodeType(h))),c=(0,r.concat)(...y(g,s,(u,m)=>{try{u.covariant(m)}catch(v){throw new Error(v.message+`

`)}return u.encodeValue(m)}));return(0,r.concat)(x,T,U,p,c)}t.encode=_t;function at(g,s){const h=new r.PipeArrayBuffer(s);if(s.byteLength<f.length)throw new Error("Message length smaller than magic number");const x=(0,i.safeRead)(h,f.length),T=new TextDecoder().decode(x);if(T!==f)throw new Error("Wrong magic number: "+JSON.stringify(T));function U(Z){const ot=[],pt=Number((0,i.lebDecode)(Z));for(let l=0;l<pt;l++){const d=Number((0,i.slebDecode)(Z));switch(d){case-18:case-19:{const O=Number((0,i.slebDecode)(Z));ot.push([d,O]);break}case-20:case-21:{const O=[];let C=Number((0,i.lebDecode)(Z)),K;for(;C--;){const H=Number((0,i.lebDecode)(Z));if(H>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof K=="number"&&K>=H)throw new Error("field id collision or not sorted");K=H;const wt=Number((0,i.slebDecode)(Z));O.push([H,wt])}ot.push([d,O]);break}case-22:{const O=[];let C=Number((0,i.lebDecode)(Z));for(;C--;)O.push(Number((0,i.slebDecode)(Z)));const K=[];let H=Number((0,i.lebDecode)(Z));for(;H--;)K.push(Number((0,i.slebDecode)(Z)));const wt=[];let vt=Number((0,i.lebDecode)(Z));for(;vt--;)switch(Number((0,i.lebDecode)(Z))){case 1:{wt.push("query");break}case 2:{wt.push("oneway");break}case 3:{wt.push("composite_query");break}default:throw new Error("unknown annotation")}ot.push([d,[O,K,wt]]);break}case-23:{let O=Number((0,i.lebDecode)(Z));const C=[];for(;O--;){const K=Number((0,i.lebDecode)(Z)),H=new TextDecoder().decode((0,i.safeRead)(Z,K)),wt=(0,i.slebDecode)(Z);C.push([H,wt])}ot.push([d,C]);break}default:throw new Error("Illegal op_code: "+d)}}const gt=[],_=Number((0,i.lebDecode)(Z));for(let l=0;l<_;l++)gt.push(Number((0,i.slebDecode)(Z)));return[ot,gt]}const[p,c]=U(h);if(c.length<g.length)throw new Error("Wrong number of return values");const u=p.map(Z=>yt());function m(Z){if(Z<-24)throw new Error("future value not supported");if(Z<0)switch(Z){case-1:return t.Null;case-2:return t.Bool;case-3:return t.Nat;case-4:return t.Int;case-5:return t.Nat8;case-6:return t.Nat16;case-7:return t.Nat32;case-8:return t.Nat64;case-9:return t.Int8;case-10:return t.Int16;case-11:return t.Int32;case-12:return t.Int64;case-13:return t.Float32;case-14:return t.Float64;case-15:return t.Text;case-16:return t.Reserved;case-17:return t.Empty;case-24:return t.Principal;default:throw new Error("Illegal op_code: "+Z)}if(Z>=p.length)throw new Error("type index out of range");return u[Z]}function v(Z){switch(Z[0]){case-19:{const ot=m(Z[1]);return lt(ot)}case-18:{const ot=m(Z[1]);return E(ot)}case-20:{const ot={};for(const[_,l]of Z[1]){const d=`_${_}_`;ot[d]=m(l)}const pt=ct(ot),gt=pt.tryAsTuple();return Array.isArray(gt)?X(...gt):pt}case-21:{const ot={};for(const[pt,gt]of Z[1]){const _=`_${pt}_`;ot[_]=m(gt)}return ft(ot)}case-22:{const[ot,pt,gt]=Z[1];return it(ot.map(_=>m(_)),pt.map(_=>m(_)),gt)}case-23:{const ot={},pt=Z[1];for(const[gt,_]of pt){let l=m(_);if(l instanceof F&&(l=l.getType()),!(l instanceof G))throw new Error("Illegal service definition: services can only contain functions");ot[gt]=l}return st(ot)}default:throw new Error("Illegal op_code: "+Z[0])}}p.forEach((Z,ot)=>{if(Z[0]===-22){const pt=v(Z);u[ot].fill(pt)}}),p.forEach((Z,ot)=>{if(Z[0]!==-22){const pt=v(Z);u[ot].fill(pt)}});const B=c.map(Z=>m(Z)),L=g.map((Z,ot)=>Z.decodeValue(h,B[ot]));for(let Z=g.length;Z<B.length;Z++)B[Z].decodeValue(h,B[Z]);if(h.byteLength>0)throw new Error("decode: Left-over bytes");return L}t.decode=at,t.Empty=new b,t.Reserved=new j,t.Unknown=new q,t.Bool=new M,t.Null=new z,t.Text=new V,t.Int=new rt,t.Nat=new k,t.Float32=new W(32),t.Float64=new W(64),t.Int8=new D(8),t.Int16=new D(16),t.Int32=new D(32),t.Int64=new D(64),t.Nat8=new J(8),t.Nat16=new J(16),t.Nat32=new J(32),t.Nat64=new J(64),t.Principal=new $;function X(...g){return new ut(g)}t.Tuple=X;function lt(g){return new nt(g)}t.Vec=lt;function E(g){return new tt(g)}t.Opt=E;function ct(g){return new dt(g)}t.Record=ct;function ft(g){return new I(g)}t.Variant=ft;function yt(){return new F}t.Rec=yt;function it(g,s,h=[]){return new G(g,s,h)}t.Func=it;function st(g){return new Q(g)}t.Service=st})(Zh);var Le=class extends Error{},fp=({IDL:t})=>{let e=t.Record({last_spawned_timestamp_seconds:t.Opt(t.Nat64),last_reset_timestamp_seconds:t.Opt(t.Nat64),requires_periodic_tasks:t.Opt(t.Bool)}),r=t.Record({archive_wasm_hash:t.Vec(t.Nat8),root_wasm_hash:t.Vec(t.Nat8),swap_wasm_hash:t.Vec(t.Nat8),ledger_wasm_hash:t.Vec(t.Nat8),governance_wasm_hash:t.Vec(t.Nat8),index_wasm_hash:t.Vec(t.Nat8)}),n=t.Record({versions:t.Vec(r)}),i=t.Record({upgrade_steps:t.Opt(n),response_timestamp_seconds:t.Opt(t.Nat64),requested_timestamp_seconds:t.Opt(t.Nat64)}),a=t.Record({validator_canister_id:t.Opt(t.Principal),target_canister_id:t.Opt(t.Principal),validator_method_name:t.Opt(t.Text),target_method_name:t.Opt(t.Text)}),f=t.Variant({NativeNervousSystemFunction:t.Record({}),GenericNervousSystemFunction:a}),o=t.Record({id:t.Nat64,name:t.Text,description:t.Opt(t.Text),function_type:t.Opt(f)}),y=t.Record({not_dissolving_neurons_e8s_buckets:t.Vec(t.Tuple(t.Nat64,t.Float64)),garbage_collectable_neurons_count:t.Nat64,neurons_with_invalid_stake_count:t.Nat64,not_dissolving_neurons_count_buckets:t.Vec(t.Tuple(t.Nat64,t.Nat64)),neurons_with_less_than_6_months_dissolve_delay_count:t.Nat64,dissolved_neurons_count:t.Nat64,total_staked_e8s:t.Nat64,total_supply_governance_tokens:t.Nat64,not_dissolving_neurons_count:t.Nat64,dissolved_neurons_e8s:t.Nat64,neurons_with_less_than_6_months_dissolve_delay_e8s:t.Nat64,dissolving_neurons_count_buckets:t.Vec(t.Tuple(t.Nat64,t.Nat64)),dissolving_neurons_count:t.Nat64,dissolving_neurons_e8s_buckets:t.Vec(t.Tuple(t.Nat64,t.Float64)),timestamp_seconds:t.Nat64}),w=t.Record({current_basis_points:t.Opt(t.Int32),updated_at_timestamp_seconds:t.Opt(t.Nat64)}),N=t.Record({old_target_version:t.Opt(r),new_target_version:t.Opt(r),is_advanced_automatically:t.Opt(t.Bool)}),A=t.Record({human_readable:t.Opt(t.Text),upgrade_steps:t.Opt(n)}),R=t.Record({status:t.Opt(t.Variant({Success:t.Record({}),Timeout:t.Record({}),ExternalFailure:t.Record({}),InvalidState:t.Record({version:t.Opt(r)})})),human_readable:t.Opt(t.Text)}),S=t.Record({id:t.Nat64}),b=t.Record({current_version:t.Opt(r),expected_version:t.Opt(r),reason:t.Opt(t.Variant({UpgradeSnsToNextVersionProposal:S,BehindTargetVersion:t.Record({})}))}),q=t.Record({upgrade_steps:t.Opt(n)}),M=t.Record({human_readable:t.Opt(t.Text),old_target_version:t.Opt(r),new_target_version:t.Opt(r)}),z=t.Record({event:t.Opt(t.Variant({TargetVersionSet:N,UpgradeStepsReset:A,UpgradeOutcome:R,UpgradeStarted:b,UpgradeStepsRefreshed:q,TargetVersionReset:M})),timestamp_seconds:t.Opt(t.Nat64)}),j=t.Record({entries:t.Vec(z)}),V=t.Record({id:t.Vec(t.Nat8)}),rt=t.Record({followees:t.Vec(V)}),k=t.Record({followees:t.Vec(t.Tuple(t.Nat64,rt))}),W=t.Record({permissions:t.Vec(t.Int32)}),D=t.Record({final_reward_rate_basis_points:t.Opt(t.Nat64),initial_reward_rate_basis_points:t.Opt(t.Nat64),reward_rate_transition_duration_seconds:t.Opt(t.Nat64),round_duration_seconds:t.Opt(t.Nat64)}),J=t.Record({default_followees:t.Opt(k),max_dissolve_delay_seconds:t.Opt(t.Nat64),max_dissolve_delay_bonus_percentage:t.Opt(t.Nat64),max_followees_per_function:t.Opt(t.Nat64),automatically_advance_target_version:t.Opt(t.Bool),neuron_claimer_permissions:t.Opt(W),neuron_minimum_stake_e8s:t.Opt(t.Nat64),max_neuron_age_for_age_bonus:t.Opt(t.Nat64),initial_voting_period_seconds:t.Opt(t.Nat64),neuron_minimum_dissolve_delay_to_vote_seconds:t.Opt(t.Nat64),reject_cost_e8s:t.Opt(t.Nat64),max_proposals_to_keep_per_action:t.Opt(t.Nat32),wait_for_quiet_deadline_increase_seconds:t.Opt(t.Nat64),max_number_of_neurons:t.Opt(t.Nat64),transaction_fee_e8s:t.Opt(t.Nat64),max_number_of_proposals_with_ballots:t.Opt(t.Nat64),max_age_bonus_percentage:t.Opt(t.Nat64),neuron_grantable_permissions:t.Opt(W),voting_rewards_parameters:t.Opt(D),maturity_modulation_disabled:t.Opt(t.Bool),max_number_of_principals_per_neuron:t.Opt(t.Nat64)}),nt=t.Record({rounds_since_last_distribution:t.Opt(t.Nat64),actual_timestamp_seconds:t.Nat64,end_timestamp_seconds:t.Opt(t.Nat64),total_available_e8s_equivalent:t.Opt(t.Nat64),distributed_e8s_equivalent:t.Nat64,round:t.Nat64,settled_proposals:t.Vec(S)}),tt=t.Record({mark_failed_at_seconds:t.Nat64,checking_upgrade_lock:t.Nat64,proposal_id:t.Opt(t.Nat64),target_version:t.Opt(r)}),dt=t.Record({error_message:t.Text,error_type:t.Int32}),ut=t.Record({subaccount:t.Vec(t.Nat8)}),I=t.Record({owner:t.Opt(t.Principal),subaccount:t.Opt(ut)}),F=t.Record({human_readable:t.Opt(t.Text)}),Y=t.Record({e8s:t.Opt(t.Nat64)}),$=t.Record({xdrs_per_icp:t.Opt(F),icps_per_token:t.Opt(F),tokens:t.Opt(Y)}),G=t.Record({token:t.Opt(t.Int32),account:t.Opt(I),valuation_factors:t.Opt($),timestamp_seconds:t.Opt(t.Nat64)}),Q=t.Record({valuation:t.Opt(G)}),et=t.Record({archive_wasm_hash:t.Opt(t.Vec(t.Nat8)),root_wasm_hash:t.Opt(t.Vec(t.Nat8)),swap_wasm_hash:t.Opt(t.Vec(t.Nat8)),ledger_wasm_hash:t.Opt(t.Vec(t.Nat8)),governance_wasm_hash:t.Opt(t.Vec(t.Nat8)),index_wasm_hash:t.Opt(t.Vec(t.Nat8))}),_t=t.Record({target_version:t.Opt(et)}),at=t.Variant({TransferSnsTreasuryFunds:Q,MintSnsTokens:Q,AdvanceSnsTargetVersion:_t}),X=t.Record({vote:t.Int32,cast_timestamp_seconds:t.Nat64,voting_power:t.Nat64}),lt=t.Record({basis_points:t.Opt(t.Nat64)}),E=t.Record({no:t.Nat64,yes:t.Nat64,total:t.Nat64,timestamp_seconds:t.Nat64}),ct=t.Record({freezing_threshold:t.Opt(t.Nat64),wasm_memory_threshold:t.Opt(t.Nat64),canister_ids:t.Vec(t.Principal),reserved_cycles_limit:t.Opt(t.Nat64),log_visibility:t.Opt(t.Int32),wasm_memory_limit:t.Opt(t.Nat64),memory_allocation:t.Opt(t.Nat64),compute_allocation:t.Opt(t.Nat64)}),ft=t.Record({canister_ids:t.Vec(t.Principal)}),yt=t.Record({from_treasury:t.Int32,to_principal:t.Opt(t.Principal),to_subaccount:t.Opt(ut),memo:t.Opt(t.Nat64),amount_e8s:t.Nat64}),it=t.Record({wasm_module_hash:t.Vec(t.Nat8),chunk_hashes_list:t.Vec(t.Vec(t.Nat8)),store_canister_id:t.Opt(t.Principal)}),st=t.Record({new_canister_wasm:t.Vec(t.Nat8),mode:t.Opt(t.Int32),canister_id:t.Opt(t.Principal),chunked_canister_wasm:t.Opt(it),canister_upgrade_arg:t.Opt(t.Vec(t.Nat8))}),g=t.Record({canister_ids:t.Vec(t.Principal),new_controllers:t.Vec(t.Principal)}),s=t.Record({to_principal:t.Opt(t.Principal),to_subaccount:t.Opt(ut),memo:t.Opt(t.Nat64),amount_e8s:t.Opt(t.Nat64)}),h=t.Record({new_target:t.Opt(et)}),x=t.Record({url:t.Opt(t.Text),logo:t.Opt(t.Text),name:t.Opt(t.Text),description:t.Opt(t.Text)}),T=t.Record({function_id:t.Nat64,payload:t.Vec(t.Nat8)}),U=t.Record({token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(t.Nat64),token_logo:t.Opt(t.Text),token_name:t.Opt(t.Text)}),p=t.Record({motion_text:t.Text}),c=t.Variant({ManageNervousSystemParameters:J,AddGenericNervousSystemFunction:o,ManageDappCanisterSettings:ct,RemoveGenericNervousSystemFunction:t.Nat64,UpgradeSnsToNextVersion:t.Record({}),RegisterDappCanisters:ft,TransferSnsTreasuryFunds:yt,UpgradeSnsControlledCanister:st,DeregisterDappCanisters:g,MintSnsTokens:s,AdvanceSnsTargetVersion:h,Unspecified:t.Record({}),ManageSnsMetadata:x,ExecuteGenericNervousSystemFunction:T,ManageLedgerParameters:U,Motion:p}),u=t.Record({url:t.Text,title:t.Text,action:t.Opt(c),summary:t.Text}),m=t.Record({current_deadline_timestamp_seconds:t.Nat64}),v=t.Record({id:t.Opt(S),payload_text_rendering:t.Opt(t.Text),action:t.Nat64,failure_reason:t.Opt(dt),action_auxiliary:t.Opt(at),ballots:t.Vec(t.Tuple(t.Text,X)),minimum_yes_proportion_of_total:t.Opt(lt),reward_event_round:t.Nat64,failed_timestamp_seconds:t.Nat64,reward_event_end_timestamp_seconds:t.Opt(t.Nat64),proposal_creation_timestamp_seconds:t.Nat64,initial_voting_period_seconds:t.Nat64,reject_cost_e8s:t.Nat64,latest_tally:t.Opt(E),wait_for_quiet_deadline_increase_seconds:t.Nat64,decided_timestamp_seconds:t.Nat64,proposal:t.Opt(u),proposer:t.Opt(V),wait_for_quiet_state:t.Opt(m),minimum_yes_proportion_of_exercised:t.Opt(lt),is_eligible_for_rewards:t.Bool,executed_timestamp_seconds:t.Nat64}),B=t.Record({memo:t.Nat64,amount_e8s:t.Nat64}),L=t.Record({function_id:t.Nat64,followees:t.Vec(V)}),Z=t.Record({to_account:t.Opt(I),percentage_to_disburse:t.Nat32}),ot=t.Record({requested_setting_for_auto_stake_maturity:t.Bool}),pt=t.Record({additional_dissolve_delay_seconds:t.Nat32}),gt=t.Record({dissolve_timestamp_seconds:t.Nat64}),_=t.Variant({ChangeAutoStakeMaturity:ot,StopDissolving:t.Record({}),StartDissolving:t.Record({}),IncreaseDissolveDelay:pt,SetDissolveTimestamp:gt}),l=t.Record({operation:t.Opt(_)}),d=t.Record({vote:t.Int32,proposal:t.Opt(S)}),O=t.Record({amount_to_be_disbursed_e8s:t.Nat64,to_account:t.Opt(I)}),C=t.Record({controller:t.Opt(t.Principal),memo:t.Nat64}),K=t.Variant({MemoAndController:C,NeuronId:t.Record({})}),H=t.Record({by:t.Opt(K)}),wt=t.Record({permissions_to_remove:t.Opt(W),principal_id:t.Opt(t.Principal)}),vt=t.Record({permissions_to_add:t.Opt(W),principal_id:t.Opt(t.Principal)}),xt=t.Record({percentage_to_merge:t.Nat32}),Et=t.Record({e8s:t.Nat64}),At=t.Record({to_account:t.Opt(I),amount:t.Opt(Et)}),Ut=t.Variant({Split:B,Follow:L,DisburseMaturity:Z,Configure:l,RegisterVote:d,SyncCommand:t.Record({}),MakeProposal:u,FinalizeDisburseMaturity:O,ClaimOrRefreshNeuron:H,RemoveNeuronPermissions:wt,AddNeuronPermissions:vt,MergeMaturity:xt,Disburse:At}),br=t.Record({command:t.Opt(Ut),timestamp:t.Nat64}),Er=t.Record({principal:t.Opt(t.Principal),permission_type:t.Vec(t.Int32)}),xr=t.Variant({DissolveDelaySeconds:t.Nat64,WhenDissolvedTimestampSeconds:t.Nat64}),vr=t.Record({timestamp_of_disbursement_seconds:t.Nat64,amount_e8s:t.Nat64,account_to_disburse_to:t.Opt(I),finalize_disbursement_timestamp_seconds:t.Opt(t.Nat64)}),be=t.Record({id:t.Opt(V),staked_maturity_e8s_equivalent:t.Opt(t.Nat64),permissions:t.Vec(Er),maturity_e8s_equivalent:t.Nat64,cached_neuron_stake_e8s:t.Nat64,created_timestamp_seconds:t.Nat64,source_nns_neuron_id:t.Opt(t.Nat64),auto_stake_maturity:t.Opt(t.Bool),aging_since_timestamp_seconds:t.Nat64,dissolve_state:t.Opt(xr),voting_power_percentage_multiplier:t.Nat64,vesting_period_seconds:t.Opt(t.Nat64),disburse_maturity_in_progress:t.Vec(vr),followees:t.Vec(t.Tuple(t.Nat64,rt)),neuron_fees_e8s:t.Nat64});t.Record({root_canister_id:t.Opt(t.Principal),timers:t.Opt(e),cached_upgrade_steps:t.Opt(i),id_to_nervous_system_functions:t.Vec(t.Tuple(t.Nat64,o)),metrics:t.Opt(y),maturity_modulation:t.Opt(w),upgrade_journal:t.Opt(j),mode:t.Int32,parameters:t.Opt(J),is_finalizing_disburse_maturity:t.Opt(t.Bool),deployed_version:t.Opt(r),sns_initialization_parameters:t.Text,latest_reward_event:t.Opt(nt),pending_version:t.Opt(tt),swap_canister_id:t.Opt(t.Principal),ledger_canister_id:t.Opt(t.Principal),proposals:t.Vec(t.Tuple(t.Nat64,v)),in_flight_commands:t.Vec(t.Tuple(t.Text,br)),sns_metadata:t.Opt(x),neurons:t.Vec(t.Tuple(t.Text,be)),target_version:t.Opt(r),genesis_timestamp_seconds:t.Nat64});let pe=t.Record({principals:t.Vec(t.Principal)}),ti=t.Record({nns_neuron_hotkeys:t.Opt(pe),nns_neuron_controller:t.Opt(t.Principal),nns_neuron_id:t.Opt(t.Nat64)}),ei=t.Variant({NeuronsFund:ti,Direct:t.Record({})}),ri=t.Record({neuron_ids:t.Vec(V)}),ni=t.Record({controller:t.Opt(t.Principal),dissolve_delay_seconds:t.Opt(t.Nat64),participant:t.Opt(ei),stake_e8s:t.Opt(t.Nat64),followees:t.Opt(ri),neuron_id:t.Opt(V)}),qt=t.Record({neuron_recipes:t.Vec(ni)}),ii=t.Record({neuron_recipes:t.Opt(qt)}),si=t.Record({id:t.Opt(V),status:t.Int32}),ai=t.Record({swap_neurons:t.Vec(si)}),ln=t.Variant({Ok:ai,Err:t.Int32}),fn=t.Record({claim_swap_neurons_result:t.Opt(ln)}),dn=t.Record({maturity_modulation:t.Opt(w)}),hn=t.Record({url:t.Opt(t.Text),logo:t.Opt(t.Text),name:t.Opt(t.Text),description:t.Opt(t.Text)}),Ct=t.Record({mode:t.Opt(t.Int32)}),pn=t.Record({neuron_id:t.Opt(V)}),_n=t.Variant({Error:dt,Neuron:be}),yn=t.Record({result:t.Opt(_n)}),Nr=t.Record({proposal_id:t.Opt(S)}),mn=t.Variant({Error:dt,Proposal:v}),gn=t.Record({result:t.Opt(mn)}),wn=t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),bn=t.Record({freezing_threshold:t.Nat,wasm_memory_threshold:t.Opt(t.Nat),controllers:t.Vec(t.Principal),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Nat,compute_allocation:t.Nat}),Bt=t.Record({response_payload_bytes_total:t.Opt(t.Nat),num_instructions_total:t.Opt(t.Nat),num_calls_total:t.Opt(t.Nat),request_payload_bytes_total:t.Opt(t.Nat)}),En=t.Record({status:wn,memory_size:t.Nat,cycles:t.Nat,settings:bn,query_stats:t.Opt(Bt),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8))}),xn=t.Record({deployed_version:t.Opt(r),pending_version:t.Opt(t.Record({mark_failed_at_seconds:t.Nat64,checking_upgrade_lock:t.Nat64,proposal_id:t.Nat64,target_version:t.Opt(r)}))}),P=t.Record({sns_initialization_parameters:t.Text}),St=t.Record({timers:t.Opt(e)}),Rt=t.Record({offset:t.Opt(t.Nat64),limit:t.Opt(t.Nat64)}),Tt=t.Record({upgrade_journal:t.Opt(j),upgrade_steps:t.Opt(n),response_timestamp_seconds:t.Opt(t.Nat64),deployed_version:t.Opt(r),target_version:t.Opt(r),upgrade_journal_entry_count:t.Opt(t.Nat64)}),Xe=t.Record({reserved_ids:t.Vec(t.Nat64),functions:t.Vec(o)}),qe=t.Record({of_principal:t.Opt(t.Principal),limit:t.Nat32,start_page_at:t.Opt(V)}),oi=t.Record({neurons:t.Vec(be)}),gs=t.Record({include_reward_status:t.Vec(t.Int32),before_proposal:t.Opt(S),limit:t.Nat32,exclude_type:t.Vec(t.Nat64),include_status:t.Vec(t.Int32)}),ws=t.Record({include_ballots_by_caller:t.Opt(t.Bool),proposals:t.Vec(v)}),bs=t.Record({percentage_to_stake:t.Opt(t.Nat32)}),Es=t.Variant({Split:B,Follow:L,DisburseMaturity:Z,ClaimOrRefresh:H,Configure:l,RegisterVote:d,MakeProposal:u,StakeMaturity:bs,RemoveNeuronPermissions:wt,AddNeuronPermissions:vt,MergeMaturity:xt,Disburse:At}),xs=t.Record({subaccount:t.Vec(t.Nat8),command:t.Opt(Es)}),vs=t.Record({created_neuron_id:t.Opt(V)}),Ns=t.Record({amount_disbursed_e8s:t.Nat64,amount_deducted_e8s:t.Opt(t.Nat64)}),Ts=t.Record({refreshed_neuron_id:t.Opt(V)}),Os=t.Record({maturity_e8s:t.Nat64,staked_maturity_e8s:t.Nat64}),Ss=t.Record({merged_maturity_e8s:t.Nat64,new_stake_e8s:t.Nat64}),Rs=t.Record({transfer_block_height:t.Nat64}),As=t.Variant({Error:dt,Split:vs,Follow:t.Record({}),DisburseMaturity:Ns,ClaimOrRefresh:Ts,Configure:t.Record({}),RegisterVote:t.Record({}),MakeProposal:Nr,RemoveNeuronPermission:t.Record({}),StakeMaturity:Os,MergeMaturity:Ss,Disburse:Rs,AddNeuronPermission:t.Record({})}),Is=t.Record({command:t.Opt(As)}),Bs=t.Record({mode:t.Int32});return t.Service({claim_swap_neurons:t.Func([ii],[fn],[]),fail_stuck_upgrade_in_progress:t.Func([t.Record({})],[t.Record({})],[]),get_build_metadata:t.Func([],[t.Text],[]),get_latest_reward_event:t.Func([],[nt],[]),get_maturity_modulation:t.Func([t.Record({})],[dn],[]),get_metadata:t.Func([t.Record({})],[hn],[]),get_mode:t.Func([t.Record({})],[Ct],[]),get_nervous_system_parameters:t.Func([t.Null],[J],[]),get_neuron:t.Func([pn],[yn],[]),get_proposal:t.Func([Nr],[gn],[]),get_root_canister_status:t.Func([t.Null],[En],[]),get_running_sns_version:t.Func([t.Record({})],[xn],[]),get_sns_initialization_parameters:t.Func([t.Record({})],[P],[]),get_timers:t.Func([t.Record({})],[St],[]),get_upgrade_journal:t.Func([Rt],[Tt],[]),list_nervous_system_functions:t.Func([],[Xe],[]),list_neurons:t.Func([qe],[oi],[]),list_proposals:t.Func([gs],[ws],[]),manage_neuron:t.Func([xs],[Is],[]),reset_timers:t.Func([t.Record({})],[t.Record({})],[]),set_mode:t.Func([Bs],[t.Record({})],[])})},dp=({IDL:t})=>{let e=t.Record({last_spawned_timestamp_seconds:t.Opt(t.Nat64),last_reset_timestamp_seconds:t.Opt(t.Nat64),requires_periodic_tasks:t.Opt(t.Bool)}),r=t.Record({archive_wasm_hash:t.Vec(t.Nat8),root_wasm_hash:t.Vec(t.Nat8),swap_wasm_hash:t.Vec(t.Nat8),ledger_wasm_hash:t.Vec(t.Nat8),governance_wasm_hash:t.Vec(t.Nat8),index_wasm_hash:t.Vec(t.Nat8)}),n=t.Record({versions:t.Vec(r)}),i=t.Record({upgrade_steps:t.Opt(n),response_timestamp_seconds:t.Opt(t.Nat64),requested_timestamp_seconds:t.Opt(t.Nat64)}),a=t.Record({validator_canister_id:t.Opt(t.Principal),target_canister_id:t.Opt(t.Principal),validator_method_name:t.Opt(t.Text),target_method_name:t.Opt(t.Text)}),f=t.Variant({NativeNervousSystemFunction:t.Record({}),GenericNervousSystemFunction:a}),o=t.Record({id:t.Nat64,name:t.Text,description:t.Opt(t.Text),function_type:t.Opt(f)}),y=t.Record({not_dissolving_neurons_e8s_buckets:t.Vec(t.Tuple(t.Nat64,t.Float64)),garbage_collectable_neurons_count:t.Nat64,neurons_with_invalid_stake_count:t.Nat64,not_dissolving_neurons_count_buckets:t.Vec(t.Tuple(t.Nat64,t.Nat64)),neurons_with_less_than_6_months_dissolve_delay_count:t.Nat64,dissolved_neurons_count:t.Nat64,total_staked_e8s:t.Nat64,total_supply_governance_tokens:t.Nat64,not_dissolving_neurons_count:t.Nat64,dissolved_neurons_e8s:t.Nat64,neurons_with_less_than_6_months_dissolve_delay_e8s:t.Nat64,dissolving_neurons_count_buckets:t.Vec(t.Tuple(t.Nat64,t.Nat64)),dissolving_neurons_count:t.Nat64,dissolving_neurons_e8s_buckets:t.Vec(t.Tuple(t.Nat64,t.Float64)),timestamp_seconds:t.Nat64}),w=t.Record({current_basis_points:t.Opt(t.Int32),updated_at_timestamp_seconds:t.Opt(t.Nat64)}),N=t.Record({old_target_version:t.Opt(r),new_target_version:t.Opt(r),is_advanced_automatically:t.Opt(t.Bool)}),A=t.Record({human_readable:t.Opt(t.Text),upgrade_steps:t.Opt(n)}),R=t.Record({status:t.Opt(t.Variant({Success:t.Record({}),Timeout:t.Record({}),ExternalFailure:t.Record({}),InvalidState:t.Record({version:t.Opt(r)})})),human_readable:t.Opt(t.Text)}),S=t.Record({id:t.Nat64}),b=t.Record({current_version:t.Opt(r),expected_version:t.Opt(r),reason:t.Opt(t.Variant({UpgradeSnsToNextVersionProposal:S,BehindTargetVersion:t.Record({})}))}),q=t.Record({upgrade_steps:t.Opt(n)}),M=t.Record({human_readable:t.Opt(t.Text),old_target_version:t.Opt(r),new_target_version:t.Opt(r)}),z=t.Record({event:t.Opt(t.Variant({TargetVersionSet:N,UpgradeStepsReset:A,UpgradeOutcome:R,UpgradeStarted:b,UpgradeStepsRefreshed:q,TargetVersionReset:M})),timestamp_seconds:t.Opt(t.Nat64)}),j=t.Record({entries:t.Vec(z)}),V=t.Record({id:t.Vec(t.Nat8)}),rt=t.Record({followees:t.Vec(V)}),k=t.Record({followees:t.Vec(t.Tuple(t.Nat64,rt))}),W=t.Record({permissions:t.Vec(t.Int32)}),D=t.Record({final_reward_rate_basis_points:t.Opt(t.Nat64),initial_reward_rate_basis_points:t.Opt(t.Nat64),reward_rate_transition_duration_seconds:t.Opt(t.Nat64),round_duration_seconds:t.Opt(t.Nat64)}),J=t.Record({default_followees:t.Opt(k),max_dissolve_delay_seconds:t.Opt(t.Nat64),max_dissolve_delay_bonus_percentage:t.Opt(t.Nat64),max_followees_per_function:t.Opt(t.Nat64),automatically_advance_target_version:t.Opt(t.Bool),neuron_claimer_permissions:t.Opt(W),neuron_minimum_stake_e8s:t.Opt(t.Nat64),max_neuron_age_for_age_bonus:t.Opt(t.Nat64),initial_voting_period_seconds:t.Opt(t.Nat64),neuron_minimum_dissolve_delay_to_vote_seconds:t.Opt(t.Nat64),reject_cost_e8s:t.Opt(t.Nat64),max_proposals_to_keep_per_action:t.Opt(t.Nat32),wait_for_quiet_deadline_increase_seconds:t.Opt(t.Nat64),max_number_of_neurons:t.Opt(t.Nat64),transaction_fee_e8s:t.Opt(t.Nat64),max_number_of_proposals_with_ballots:t.Opt(t.Nat64),max_age_bonus_percentage:t.Opt(t.Nat64),neuron_grantable_permissions:t.Opt(W),voting_rewards_parameters:t.Opt(D),maturity_modulation_disabled:t.Opt(t.Bool),max_number_of_principals_per_neuron:t.Opt(t.Nat64)}),nt=t.Record({rounds_since_last_distribution:t.Opt(t.Nat64),actual_timestamp_seconds:t.Nat64,end_timestamp_seconds:t.Opt(t.Nat64),total_available_e8s_equivalent:t.Opt(t.Nat64),distributed_e8s_equivalent:t.Nat64,round:t.Nat64,settled_proposals:t.Vec(S)}),tt=t.Record({mark_failed_at_seconds:t.Nat64,checking_upgrade_lock:t.Nat64,proposal_id:t.Opt(t.Nat64),target_version:t.Opt(r)}),dt=t.Record({error_message:t.Text,error_type:t.Int32}),ut=t.Record({subaccount:t.Vec(t.Nat8)}),I=t.Record({owner:t.Opt(t.Principal),subaccount:t.Opt(ut)}),F=t.Record({human_readable:t.Opt(t.Text)}),Y=t.Record({e8s:t.Opt(t.Nat64)}),$=t.Record({xdrs_per_icp:t.Opt(F),icps_per_token:t.Opt(F),tokens:t.Opt(Y)}),G=t.Record({token:t.Opt(t.Int32),account:t.Opt(I),valuation_factors:t.Opt($),timestamp_seconds:t.Opt(t.Nat64)}),Q=t.Record({valuation:t.Opt(G)}),et=t.Record({archive_wasm_hash:t.Opt(t.Vec(t.Nat8)),root_wasm_hash:t.Opt(t.Vec(t.Nat8)),swap_wasm_hash:t.Opt(t.Vec(t.Nat8)),ledger_wasm_hash:t.Opt(t.Vec(t.Nat8)),governance_wasm_hash:t.Opt(t.Vec(t.Nat8)),index_wasm_hash:t.Opt(t.Vec(t.Nat8))}),_t=t.Record({target_version:t.Opt(et)}),at=t.Variant({TransferSnsTreasuryFunds:Q,MintSnsTokens:Q,AdvanceSnsTargetVersion:_t}),X=t.Record({vote:t.Int32,cast_timestamp_seconds:t.Nat64,voting_power:t.Nat64}),lt=t.Record({basis_points:t.Opt(t.Nat64)}),E=t.Record({no:t.Nat64,yes:t.Nat64,total:t.Nat64,timestamp_seconds:t.Nat64}),ct=t.Record({freezing_threshold:t.Opt(t.Nat64),wasm_memory_threshold:t.Opt(t.Nat64),canister_ids:t.Vec(t.Principal),reserved_cycles_limit:t.Opt(t.Nat64),log_visibility:t.Opt(t.Int32),wasm_memory_limit:t.Opt(t.Nat64),memory_allocation:t.Opt(t.Nat64),compute_allocation:t.Opt(t.Nat64)}),ft=t.Record({canister_ids:t.Vec(t.Principal)}),yt=t.Record({from_treasury:t.Int32,to_principal:t.Opt(t.Principal),to_subaccount:t.Opt(ut),memo:t.Opt(t.Nat64),amount_e8s:t.Nat64}),it=t.Record({wasm_module_hash:t.Vec(t.Nat8),chunk_hashes_list:t.Vec(t.Vec(t.Nat8)),store_canister_id:t.Opt(t.Principal)}),st=t.Record({new_canister_wasm:t.Vec(t.Nat8),mode:t.Opt(t.Int32),canister_id:t.Opt(t.Principal),chunked_canister_wasm:t.Opt(it),canister_upgrade_arg:t.Opt(t.Vec(t.Nat8))}),g=t.Record({canister_ids:t.Vec(t.Principal),new_controllers:t.Vec(t.Principal)}),s=t.Record({to_principal:t.Opt(t.Principal),to_subaccount:t.Opt(ut),memo:t.Opt(t.Nat64),amount_e8s:t.Opt(t.Nat64)}),h=t.Record({new_target:t.Opt(et)}),x=t.Record({url:t.Opt(t.Text),logo:t.Opt(t.Text),name:t.Opt(t.Text),description:t.Opt(t.Text)}),T=t.Record({function_id:t.Nat64,payload:t.Vec(t.Nat8)}),U=t.Record({token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(t.Nat64),token_logo:t.Opt(t.Text),token_name:t.Opt(t.Text)}),p=t.Record({motion_text:t.Text}),c=t.Variant({ManageNervousSystemParameters:J,AddGenericNervousSystemFunction:o,ManageDappCanisterSettings:ct,RemoveGenericNervousSystemFunction:t.Nat64,UpgradeSnsToNextVersion:t.Record({}),RegisterDappCanisters:ft,TransferSnsTreasuryFunds:yt,UpgradeSnsControlledCanister:st,DeregisterDappCanisters:g,MintSnsTokens:s,AdvanceSnsTargetVersion:h,Unspecified:t.Record({}),ManageSnsMetadata:x,ExecuteGenericNervousSystemFunction:T,ManageLedgerParameters:U,Motion:p}),u=t.Record({url:t.Text,title:t.Text,action:t.Opt(c),summary:t.Text}),m=t.Record({current_deadline_timestamp_seconds:t.Nat64}),v=t.Record({id:t.Opt(S),payload_text_rendering:t.Opt(t.Text),action:t.Nat64,failure_reason:t.Opt(dt),action_auxiliary:t.Opt(at),ballots:t.Vec(t.Tuple(t.Text,X)),minimum_yes_proportion_of_total:t.Opt(lt),reward_event_round:t.Nat64,failed_timestamp_seconds:t.Nat64,reward_event_end_timestamp_seconds:t.Opt(t.Nat64),proposal_creation_timestamp_seconds:t.Nat64,initial_voting_period_seconds:t.Nat64,reject_cost_e8s:t.Nat64,latest_tally:t.Opt(E),wait_for_quiet_deadline_increase_seconds:t.Nat64,decided_timestamp_seconds:t.Nat64,proposal:t.Opt(u),proposer:t.Opt(V),wait_for_quiet_state:t.Opt(m),minimum_yes_proportion_of_exercised:t.Opt(lt),is_eligible_for_rewards:t.Bool,executed_timestamp_seconds:t.Nat64}),B=t.Record({memo:t.Nat64,amount_e8s:t.Nat64}),L=t.Record({function_id:t.Nat64,followees:t.Vec(V)}),Z=t.Record({to_account:t.Opt(I),percentage_to_disburse:t.Nat32}),ot=t.Record({requested_setting_for_auto_stake_maturity:t.Bool}),pt=t.Record({additional_dissolve_delay_seconds:t.Nat32}),gt=t.Record({dissolve_timestamp_seconds:t.Nat64}),_=t.Variant({ChangeAutoStakeMaturity:ot,StopDissolving:t.Record({}),StartDissolving:t.Record({}),IncreaseDissolveDelay:pt,SetDissolveTimestamp:gt}),l=t.Record({operation:t.Opt(_)}),d=t.Record({vote:t.Int32,proposal:t.Opt(S)}),O=t.Record({amount_to_be_disbursed_e8s:t.Nat64,to_account:t.Opt(I)}),C=t.Record({controller:t.Opt(t.Principal),memo:t.Nat64}),K=t.Variant({MemoAndController:C,NeuronId:t.Record({})}),H=t.Record({by:t.Opt(K)}),wt=t.Record({permissions_to_remove:t.Opt(W),principal_id:t.Opt(t.Principal)}),vt=t.Record({permissions_to_add:t.Opt(W),principal_id:t.Opt(t.Principal)}),xt=t.Record({percentage_to_merge:t.Nat32}),Et=t.Record({e8s:t.Nat64}),At=t.Record({to_account:t.Opt(I),amount:t.Opt(Et)}),Ut=t.Variant({Split:B,Follow:L,DisburseMaturity:Z,Configure:l,RegisterVote:d,SyncCommand:t.Record({}),MakeProposal:u,FinalizeDisburseMaturity:O,ClaimOrRefreshNeuron:H,RemoveNeuronPermissions:wt,AddNeuronPermissions:vt,MergeMaturity:xt,Disburse:At}),br=t.Record({command:t.Opt(Ut),timestamp:t.Nat64}),Er=t.Record({principal:t.Opt(t.Principal),permission_type:t.Vec(t.Int32)}),xr=t.Variant({DissolveDelaySeconds:t.Nat64,WhenDissolvedTimestampSeconds:t.Nat64}),vr=t.Record({timestamp_of_disbursement_seconds:t.Nat64,amount_e8s:t.Nat64,account_to_disburse_to:t.Opt(I),finalize_disbursement_timestamp_seconds:t.Opt(t.Nat64)}),be=t.Record({id:t.Opt(V),staked_maturity_e8s_equivalent:t.Opt(t.Nat64),permissions:t.Vec(Er),maturity_e8s_equivalent:t.Nat64,cached_neuron_stake_e8s:t.Nat64,created_timestamp_seconds:t.Nat64,source_nns_neuron_id:t.Opt(t.Nat64),auto_stake_maturity:t.Opt(t.Bool),aging_since_timestamp_seconds:t.Nat64,dissolve_state:t.Opt(xr),voting_power_percentage_multiplier:t.Nat64,vesting_period_seconds:t.Opt(t.Nat64),disburse_maturity_in_progress:t.Vec(vr),followees:t.Vec(t.Tuple(t.Nat64,rt)),neuron_fees_e8s:t.Nat64});t.Record({root_canister_id:t.Opt(t.Principal),timers:t.Opt(e),cached_upgrade_steps:t.Opt(i),id_to_nervous_system_functions:t.Vec(t.Tuple(t.Nat64,o)),metrics:t.Opt(y),maturity_modulation:t.Opt(w),upgrade_journal:t.Opt(j),mode:t.Int32,parameters:t.Opt(J),is_finalizing_disburse_maturity:t.Opt(t.Bool),deployed_version:t.Opt(r),sns_initialization_parameters:t.Text,latest_reward_event:t.Opt(nt),pending_version:t.Opt(tt),swap_canister_id:t.Opt(t.Principal),ledger_canister_id:t.Opt(t.Principal),proposals:t.Vec(t.Tuple(t.Nat64,v)),in_flight_commands:t.Vec(t.Tuple(t.Text,br)),sns_metadata:t.Opt(x),neurons:t.Vec(t.Tuple(t.Text,be)),target_version:t.Opt(r),genesis_timestamp_seconds:t.Nat64});let pe=t.Record({principals:t.Vec(t.Principal)}),ti=t.Record({nns_neuron_hotkeys:t.Opt(pe),nns_neuron_controller:t.Opt(t.Principal),nns_neuron_id:t.Opt(t.Nat64)}),ei=t.Variant({NeuronsFund:ti,Direct:t.Record({})}),ri=t.Record({neuron_ids:t.Vec(V)}),ni=t.Record({controller:t.Opt(t.Principal),dissolve_delay_seconds:t.Opt(t.Nat64),participant:t.Opt(ei),stake_e8s:t.Opt(t.Nat64),followees:t.Opt(ri),neuron_id:t.Opt(V)}),qt=t.Record({neuron_recipes:t.Vec(ni)}),ii=t.Record({neuron_recipes:t.Opt(qt)}),si=t.Record({id:t.Opt(V),status:t.Int32}),ai=t.Record({swap_neurons:t.Vec(si)}),ln=t.Variant({Ok:ai,Err:t.Int32}),fn=t.Record({claim_swap_neurons_result:t.Opt(ln)}),dn=t.Record({maturity_modulation:t.Opt(w)}),hn=t.Record({url:t.Opt(t.Text),logo:t.Opt(t.Text),name:t.Opt(t.Text),description:t.Opt(t.Text)}),Ct=t.Record({mode:t.Opt(t.Int32)}),pn=t.Record({neuron_id:t.Opt(V)}),_n=t.Variant({Error:dt,Neuron:be}),yn=t.Record({result:t.Opt(_n)}),Nr=t.Record({proposal_id:t.Opt(S)}),mn=t.Variant({Error:dt,Proposal:v}),gn=t.Record({result:t.Opt(mn)}),wn=t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),bn=t.Record({freezing_threshold:t.Nat,wasm_memory_threshold:t.Opt(t.Nat),controllers:t.Vec(t.Principal),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Nat,compute_allocation:t.Nat}),Bt=t.Record({response_payload_bytes_total:t.Opt(t.Nat),num_instructions_total:t.Opt(t.Nat),num_calls_total:t.Opt(t.Nat),request_payload_bytes_total:t.Opt(t.Nat)}),En=t.Record({status:wn,memory_size:t.Nat,cycles:t.Nat,settings:bn,query_stats:t.Opt(Bt),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8))}),xn=t.Record({deployed_version:t.Opt(r),pending_version:t.Opt(t.Record({mark_failed_at_seconds:t.Nat64,checking_upgrade_lock:t.Nat64,proposal_id:t.Nat64,target_version:t.Opt(r)}))}),P=t.Record({sns_initialization_parameters:t.Text}),St=t.Record({timers:t.Opt(e)}),Rt=t.Record({offset:t.Opt(t.Nat64),limit:t.Opt(t.Nat64)}),Tt=t.Record({upgrade_journal:t.Opt(j),upgrade_steps:t.Opt(n),response_timestamp_seconds:t.Opt(t.Nat64),deployed_version:t.Opt(r),target_version:t.Opt(r),upgrade_journal_entry_count:t.Opt(t.Nat64)}),Xe=t.Record({reserved_ids:t.Vec(t.Nat64),functions:t.Vec(o)}),qe=t.Record({of_principal:t.Opt(t.Principal),limit:t.Nat32,start_page_at:t.Opt(V)}),oi=t.Record({neurons:t.Vec(be)}),gs=t.Record({include_reward_status:t.Vec(t.Int32),before_proposal:t.Opt(S),limit:t.Nat32,exclude_type:t.Vec(t.Nat64),include_status:t.Vec(t.Int32)}),ws=t.Record({include_ballots_by_caller:t.Opt(t.Bool),proposals:t.Vec(v)}),bs=t.Record({percentage_to_stake:t.Opt(t.Nat32)}),Es=t.Variant({Split:B,Follow:L,DisburseMaturity:Z,ClaimOrRefresh:H,Configure:l,RegisterVote:d,MakeProposal:u,StakeMaturity:bs,RemoveNeuronPermissions:wt,AddNeuronPermissions:vt,MergeMaturity:xt,Disburse:At}),xs=t.Record({subaccount:t.Vec(t.Nat8),command:t.Opt(Es)}),vs=t.Record({created_neuron_id:t.Opt(V)}),Ns=t.Record({amount_disbursed_e8s:t.Nat64,amount_deducted_e8s:t.Opt(t.Nat64)}),Ts=t.Record({refreshed_neuron_id:t.Opt(V)}),Os=t.Record({maturity_e8s:t.Nat64,staked_maturity_e8s:t.Nat64}),Ss=t.Record({merged_maturity_e8s:t.Nat64,new_stake_e8s:t.Nat64}),Rs=t.Record({transfer_block_height:t.Nat64}),As=t.Variant({Error:dt,Split:vs,Follow:t.Record({}),DisburseMaturity:Ns,ClaimOrRefresh:Ts,Configure:t.Record({}),RegisterVote:t.Record({}),MakeProposal:Nr,RemoveNeuronPermission:t.Record({}),StakeMaturity:Os,MergeMaturity:Ss,Disburse:Rs,AddNeuronPermission:t.Record({})}),Is=t.Record({command:t.Opt(As)}),Bs=t.Record({mode:t.Int32});return t.Service({claim_swap_neurons:t.Func([ii],[fn],[]),fail_stuck_upgrade_in_progress:t.Func([t.Record({})],[t.Record({})],[]),get_build_metadata:t.Func([],[t.Text],["query"]),get_latest_reward_event:t.Func([],[nt],["query"]),get_maturity_modulation:t.Func([t.Record({})],[dn],[]),get_metadata:t.Func([t.Record({})],[hn],["query"]),get_mode:t.Func([t.Record({})],[Ct],["query"]),get_nervous_system_parameters:t.Func([t.Null],[J],["query"]),get_neuron:t.Func([pn],[yn],["query"]),get_proposal:t.Func([Nr],[gn],["query"]),get_root_canister_status:t.Func([t.Null],[En],[]),get_running_sns_version:t.Func([t.Record({})],[xn],["query"]),get_sns_initialization_parameters:t.Func([t.Record({})],[P],["query"]),get_timers:t.Func([t.Record({})],[St],["query"]),get_upgrade_journal:t.Func([Rt],[Tt],["query"]),list_nervous_system_functions:t.Func([],[Xe],["query"]),list_neurons:t.Func([qe],[oi],["query"]),list_proposals:t.Func([gs],[ws],["query"]),manage_neuron:t.Func([xs],[Is],[]),reset_timers:t.Func([t.Record({})],[t.Record({})],[]),set_mode:t.Func([Bs],[t.Record({})],[])})},Mr=({neuronId:{id:t},command:e})=>({subaccount:t,command:[e]}),Qn=({neuronId:t,operation:e})=>Mr({neuronId:t,command:{Configure:{operation:[e]}}}),sl=({owner:t,subaccount:e})=>({owner:Pt(t),subaccount:e===void 0?[]:Pt({subaccount:e})}),hp=({neuronId:t,permissions:e,principal:r})=>Mr({neuronId:t,command:{AddNeuronPermissions:{permissions_to_add:[{permissions:Int32Array.from(e)}],principal_id:[r]}}}),pp=({neuronId:t,permissions:e,principal:r})=>Mr({neuronId:t,command:{RemoveNeuronPermissions:{permissions_to_remove:[{permissions:Int32Array.from(e)}],principal_id:[r]}}}),_p=({neuronId:t,memo:e,amount:r})=>Mr({neuronId:t,command:{Split:{memo:e,amount_e8s:r}}}),yp=({neuronId:t,amount:e,toAccount:r})=>Mr({neuronId:t,command:{Disburse:{to_account:r===void 0?[]:Pt(sl(r)),amount:e===void 0?[]:[{e8s:e}]}}}),mp=t=>Qn({neuronId:t,operation:{StartDissolving:{}}}),gp=t=>Qn({neuronId:t,operation:{StopDissolving:{}}}),wp=({neuronId:t,percentageToStake:e})=>Mr({neuronId:t,command:{StakeMaturity:{percentage_to_stake:Pt(e)}}}),bp=({neuronId:t,percentageToDisburse:e,toAccount:r})=>Mr({neuronId:t,command:{DisburseMaturity:{to_account:r===void 0?[]:Pt(sl(r)),percentage_to_disburse:e}}}),Ep=({neuronId:t,autoStake:e})=>Qn({neuronId:t,operation:{ChangeAutoStakeMaturity:{requested_setting_for_auto_stake_maturity:e}}}),xp=({neuronId:t,dissolveTimestampSeconds:e})=>Qn({neuronId:t,operation:{SetDissolveTimestamp:{dissolve_timestamp_seconds:e}}}),vp=({neuronId:t,additionalDissolveDelaySeconds:e})=>Qn({neuronId:t,operation:{IncreaseDissolveDelay:{additional_dissolve_delay_seconds:e}}}),Np=({neuronId:t,functionId:e,followees:r})=>({subaccount:t.id,command:[{Follow:{function_id:e,followees:r}}]}),Tp=({neuronId:t,proposalId:e,vote:r})=>({subaccount:t.id,command:[{RegisterVote:{vote:r,proposal:[e]}}]}),jo=({subaccount:t,memo:e,controller:r})=>({subaccount:t,command:[{ClaimOrRefresh:{by:[e===void 0?{NeuronId:{}}:{MemoAndController:{memo:e,controller:Pt(r)}}]}}]}),Op=({excludeType:t,beforeProposal:e,includeRewardStatus:r,includeStatus:n,limit:i})=>({exclude_type:BigUint64Array.from(t??[]),before_proposal:Pt(e),include_reward_status:Int32Array.from(r??[]),include_status:Int32Array.from(n??[]),limit:i??10}),r_=class al extends Zu{constructor(){super(...arguments),this.listNeurons=async e=>{let{principal:r,limit:n,beforeNeuronId:i}=e,{neurons:a}=await this.caller(e).list_neurons({of_principal:Pt(r),limit:n??100,start_page_at:Pt(i)});return a},this.listProposals=async e=>{let{certified:r}=e;return await this.caller({certified:r}).list_proposals(Op(e))},this.getProposal=async e=>{let{proposalId:r}=e,{result:n}=await this.caller(e).get_proposal({proposal_id:Pt(r)}),i=jr(n);if(i===void 0||"Error"in i)throw new Le(i?.Error.error_message??"Response type not supported");return i.Proposal},this.listNervousSystemFunctions=async e=>this.caller(e).list_nervous_system_functions(),this.metadata=e=>this.caller(e).get_metadata({}),this.nervousSystemParameters=e=>this.caller(e).get_nervous_system_parameters(null),this.getNeuron=async e=>{let{neuronId:r}=e,{result:n}=await this.caller(e).get_neuron({neuron_id:Pt(r)}),i=jr(n);if(i===void 0||"Error"in i)throw new Le(i?.Error.error_message??"Response type not supported");return i.Neuron},this.queryNeuron=async e=>{try{return await this.getNeuron(e)}catch(r){if(r instanceof Error&&r.message.includes("No neuron for given NeuronId"))return;throw r}},this.manageNeuron=async e=>{let r=await this.caller({certified:!0}).manage_neuron(e);return this.assertManageNeuronError(r),r},this.addNeuronPermissions=async e=>{let r=hp(e);await this.manageNeuron(r)},this.removeNeuronPermissions=async e=>{let r=pp(e);await this.manageNeuron(r)},this.splitNeuron=async e=>{let r=_p(e),{command:n}=await this.manageNeuron(r),i=jr(n),a=f=>`Split neuron failed (${f})`;if(i===void 0)throw new Le(a("no response"));if("Split"in i){let f=i.Split,o=jr(f.created_neuron_id);if(o!==void 0)return o;throw new Le(a("no id"))}throw new Le(a("unknown"))},this.disburse=async e=>{let r=yp(e);await this.manageNeuron(r)},this.startDissolving=async e=>{let r=mp(e);await this.manageNeuron(r)},this.stopDissolving=async e=>{let r=gp(e);await this.manageNeuron(r)},this.stakeMaturity=async({neuronId:e,percentageToStake:r})=>{Lo(r??100);let n=wp({neuronId:e,percentageToStake:r});await this.manageNeuron(n)},this.disburseMaturity=async e=>{Lo(e.percentageToDisburse);let r=bp(e);await this.manageNeuron(r)},this.autoStakeMaturity=async e=>{let r=Ep(e);await this.manageNeuron(r)},this.setDissolveTimestamp=async e=>{let r=xp(e);await this.manageNeuron(r)},this.increaseDissolveDelay=async e=>{let r=vp(e);await this.manageNeuron(r)},this.setTopicFollowees=async e=>{let r=Np(e);await this.manageNeuron(r)},this.registerVote=async e=>{let r=Tp(e);await this.manageNeuron(r)},this.refreshNeuron=async e=>{let r=jo({subaccount:e.id});await this.manageNeuron(r)},this.claimNeuron=async({memo:e,controller:r,subaccount:n})=>{let i=jo({subaccount:n,memo:e,controller:r}),{command:a}=await this.manageNeuron(i),f=jr(a);if(f===void 0)throw new Le("Claim neuron failed");if("ClaimOrRefresh"in f){let o=jr(f.ClaimOrRefresh.refreshed_neuron_id);if(o===void 0)throw new Le("Claim neuron failed");return o}throw new Le("Claim neuron failed")},this.assertManageNeuronError=({command:e})=>{let r=e[0];if(r!==void 0&&"Error"in r)throw new Le(r.Error.error_message)}}static create(e){let{service:r,certifiedService:n,canisterId:i}=Ju({options:e,idlFactory:dp,certifiedIdlFactory:fp});return new al(i,r,n)}};function Sp(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function ol(t,...e){if(!Sp(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Ho(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Rp(t,e){ol(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var ea=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Fe=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Ap(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function cl(t){return typeof t=="string"&&(t=Ap(t)),ol(t),t}var Ip=class{clone(){return this._cloneInto()}};function Bp(t){let e=n=>t().update(cl(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Up(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),a=BigInt(4294967295),f=Number(r>>i&a),o=Number(r&a),y=n?4:0,w=n?0:4;t.setUint32(e+y,f,n),t.setUint32(e+w,o,n)}var Fp=(t,e,r)=>t&e^~t&r,Pp=(t,e,r)=>t&e^t&r^e&r,Vp=class extends Ip{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ea(this.buffer)}update(t){Ho(this);let{view:e,buffer:r,blockLen:n}=this;t=cl(t);let i=t.length;for(let a=0;a<i;){let f=Math.min(n-this.pos,i-a);if(f===n){let o=ea(t);for(;n<=i-a;a+=n)this.process(o,a);continue}r.set(t.subarray(a,a+f),this.pos),this.pos+=f,a+=f,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ho(this),Rp(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:n,isLE:i}=this,{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(r,0),a=0);for(let N=a;N<n;N++)e[N]=0;Up(r,n-8,BigInt(this.length*8),i),this.process(r,0);let f=ea(t),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let y=o/4,w=this.get();if(y>w.length)throw new Error("_sha2: outputLen bigger than state");for(let N=0;N<y;N++)f.setUint32(4*N,w[N],i)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:a,pos:f}=this;return t.length=n,t.pos=f,t.finished=i,t.destroyed=a,n%e&&t.buffer.set(r),t}},kp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ir=new Uint32Array(64),Cp=class extends Vp{constructor(){super(64,32,8,!1),this.A=nr[0]|0,this.B=nr[1]|0,this.C=nr[2]|0,this.D=nr[3]|0,this.E=nr[4]|0,this.F=nr[5]|0,this.G=nr[6]|0,this.H=nr[7]|0}get(){let{A:t,B:e,C:r,D:n,E:i,F:a,G:f,H:o}=this;return[t,e,r,n,i,a,f,o]}set(t,e,r,n,i,a,f,o){this.A=t|0,this.B=e|0,this.C=r|0,this.D=n|0,this.E=i|0,this.F=a|0,this.G=f|0,this.H=o|0}process(t,e){for(let N=0;N<16;N++,e+=4)ir[N]=t.getUint32(e,!1);for(let N=16;N<64;N++){let A=ir[N-15],R=ir[N-2],S=Fe(A,7)^Fe(A,18)^A>>>3,b=Fe(R,17)^Fe(R,19)^R>>>10;ir[N]=b+ir[N-7]+S+ir[N-16]|0}let{A:r,B:n,C:i,D:a,E:f,F:o,G:y,H:w}=this;for(let N=0;N<64;N++){let A=Fe(f,6)^Fe(f,11)^Fe(f,25),R=w+A+Fp(f,o,y)+kp[N]+ir[N]|0,S=(Fe(r,2)^Fe(r,13)^Fe(r,22))+Pp(r,n,i)|0;w=y,y=o,o=f,f=a+R|0,a=i,i=n,n=r,r=R+S|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,a=a+this.D|0,f=f+this.E|0,o=o+this.F|0,y=y+this.G|0,w=w+this.H|0,this.set(r,n,i,a,f,o,y,w)}roundClean(){ir.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};Bp(()=>new Cp);/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/var Mp=(t=>(t[t.NEURON_PERMISSION_TYPE_UNSPECIFIED=0]="NEURON_PERMISSION_TYPE_UNSPECIFIED",t[t.NEURON_PERMISSION_TYPE_CONFIGURE_DISSOLVE_STATE=1]="NEURON_PERMISSION_TYPE_CONFIGURE_DISSOLVE_STATE",t[t.NEURON_PERMISSION_TYPE_MANAGE_PRINCIPALS=2]="NEURON_PERMISSION_TYPE_MANAGE_PRINCIPALS",t[t.NEURON_PERMISSION_TYPE_SUBMIT_PROPOSAL=3]="NEURON_PERMISSION_TYPE_SUBMIT_PROPOSAL",t[t.NEURON_PERMISSION_TYPE_VOTE=4]="NEURON_PERMISSION_TYPE_VOTE",t[t.NEURON_PERMISSION_TYPE_DISBURSE=5]="NEURON_PERMISSION_TYPE_DISBURSE",t[t.NEURON_PERMISSION_TYPE_SPLIT=6]="NEURON_PERMISSION_TYPE_SPLIT",t[t.NEURON_PERMISSION_TYPE_MERGE_MATURITY=7]="NEURON_PERMISSION_TYPE_MERGE_MATURITY",t[t.NEURON_PERMISSION_TYPE_DISBURSE_MATURITY=8]="NEURON_PERMISSION_TYPE_DISBURSE_MATURITY",t[t.NEURON_PERMISSION_TYPE_STAKE_MATURITY=9]="NEURON_PERMISSION_TYPE_STAKE_MATURITY",t[t.NEURON_PERMISSION_TYPE_MANAGE_VOTING_PERMISSION=10]="NEURON_PERMISSION_TYPE_MANAGE_VOTING_PERMISSION",t))(Mp||{}),$p=(t=>(t[t.PROPOSAL_REWARD_STATUS_UNSPECIFIED=0]="PROPOSAL_REWARD_STATUS_UNSPECIFIED",t[t.PROPOSAL_REWARD_STATUS_ACCEPT_VOTES=1]="PROPOSAL_REWARD_STATUS_ACCEPT_VOTES",t[t.PROPOSAL_REWARD_STATUS_READY_TO_SETTLE=2]="PROPOSAL_REWARD_STATUS_READY_TO_SETTLE",t[t.PROPOSAL_REWARD_STATUS_SETTLED=3]="PROPOSAL_REWARD_STATUS_SETTLED",t))($p||{}),qp=(t=>(t[t.PROPOSAL_DECISION_STATUS_UNSPECIFIED=0]="PROPOSAL_DECISION_STATUS_UNSPECIFIED",t[t.PROPOSAL_DECISION_STATUS_OPEN=1]="PROPOSAL_DECISION_STATUS_OPEN",t[t.PROPOSAL_DECISION_STATUS_REJECTED=2]="PROPOSAL_DECISION_STATUS_REJECTED",t[t.PROPOSAL_DECISION_STATUS_ADOPTED=3]="PROPOSAL_DECISION_STATUS_ADOPTED",t[t.PROPOSAL_DECISION_STATUS_EXECUTED=4]="PROPOSAL_DECISION_STATUS_EXECUTED",t[t.PROPOSAL_DECISION_STATUS_FAILED=5]="PROPOSAL_DECISION_STATUS_FAILED",t))(qp||{}),Dp=(t=>(t[t.Unspecified=0]="Unspecified",t[t.Yes=1]="Yes",t[t.No=2]="No",t))(Dp||{}),Lp=(t=>(t[t.Unspecified=0]="Unspecified",t[t.Pending=1]="Pending",t[t.Open=2]="Open",t[t.Committed=3]="Committed",t[t.Aborted=4]="Aborted",t[t.Adopted=5]="Adopted",t))(Lp||{}),Gp=(t=>(t[t.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",t[t.TYPE_SALE_NOT_OPEN=1]="TYPE_SALE_NOT_OPEN",t[t.TYPE_SALE_CLOSED=2]="TYPE_SALE_CLOSED",t))(Gp||{}),jp=(t=>(t[t.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",t[t.TYPE_SALE_NOT_OPEN=1]="TYPE_SALE_NOT_OPEN",t[t.TYPE_SALE_CLOSED=2]="TYPE_SALE_CLOSED",t[t.TYPE_TICKET_EXISTS=3]="TYPE_TICKET_EXISTS",t[t.TYPE_INVALID_USER_AMOUNT=4]="TYPE_INVALID_USER_AMOUNT",t[t.TYPE_INVALID_SUBACCOUNT=5]="TYPE_INVALID_SUBACCOUNT",t[t.TYPE_INVALID_PRINCIPAL=6]="TYPE_INVALID_PRINCIPAL",t))(jp||{});export{r_ as $,Gn as A,Kp as D,Dp as G,Ur as H,gc as I,Rc as N,Fc as O,Nt as P,Pc as R,mc as T,Vc as V,Jp as Y,Xp as a,Xu as b,Sc as c,Uc as d,Oc as e,e_ as f,yc as g,ia as h,Zh as i,Yp as u};
